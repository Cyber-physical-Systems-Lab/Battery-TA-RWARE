{"timers": {"training_iteration": 4.341818165965378, "restore_env_runners": 1.849501859396696e-05, "training_step": 4.34163769101724, "env_runner_sampling_timer": 1.3308128869975917, "learner_update_timer": 3.0084109159652144, "synch_weights": 0.0020536600495688617}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -2.4075000000000095, "agent_0": -1.552500000000005, "agent_2": -3.9300000000000126}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.2877963868274635e-05, "add_time_dim_to_batch_and_zero_pad": 8.5731084653171e-06, "numpy_to_tensor": 3.743878586367141e-05, "add_states_from_episodes_to_batch": 5.004714789515615e-06, "add_observations_from_episodes_to_batch": 2.1369247563872896e-05, "agent_to_module_mapping": 4.429992677784373e-06}}, "connector_pipeline_timer": 0.0001411425364787841}, "env_to_module_sum_episodes_length_in": 399.2306012071058, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6416087971374509, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -4.340000000000007, "env_step_timer": 0.00034528648520301436, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0552231736650119e-06, "listify_data_for_vector_env": 8.913259655113697e-06, "module_to_agent_unmapping": 3.4708408767501505e-06, "un_batch_to_individual_items": 2.50007619455202e-05, "normalize_and_clip_actions": 3.1866042238734465e-05, "tensor_to_numpy": 5.597681135373324e-05, "get_actions": 0.0002076553944571391}}, "connector_pipeline_timer": 0.000389187515699185}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 4000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2306012071058, "num_episodes_lifetime": 8.0, "agent_episode_returns_mean": {"agent_0": -1.552500000000005, "agent_2": -3.9300000000000126, "agent_1": -2.4075000000000095}, "num_agent_steps_sampled_lifetime": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "sample": 1.3006437654839829, "rlmodule_inference_timer": 0.00015267930110014988, "weights_seq_no": 0.0, "episode_len_mean": 500.0, "episode_return_mean": -7.890000000000027, "episode_return_min": -13.98000000000006, "env_reset_timer": 0.0009426562610315159, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04040493397042155, "batch_individual_items": 0.18925344600575045, "add_one_ts_to_episodes_and_truncate": 0.006763927987776697, "add_time_dim_to_batch_and_zero_pad": 2.23120441660285e-05, "add_columns_from_episodes_to_train_batch": 0.09427810600027442, "numpy_to_tensor": 0.00024723901879042387, "add_states_from_episodes_to_batch": 6.609014235436916e-06, "add_observations_from_episodes_to_batch": 0.00016054301522672176, "agent_to_module_mapping": 0.0053119370131753385}}, "connector_pipeline_timer": 0.33688850700855255}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 120576, "learner_connector_sum_episodes_length_in": 4000, "num_env_steps_trained_lifetime": 628000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_0": {"vf_explained_var": 0.7916783094406128, "entropy": 4.0267415046691895, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 1.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.00892396830022335, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.00112317712046206, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.06305785477161407, "vf_loss_unclipped": 0.00112317712046206, "num_module_steps_trained_lifetime": 40192, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.06596583127975464, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_1": {"vf_loss": 0.0015826612943783402, "mean_kl_loss": 0.009452609345316887, "total_loss": 0.033838268369436264, "vf_loss_unclipped": 0.0015826612943783402, "num_module_steps_trained_lifetime": 40192, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.03036508522927761, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.9009544253349304, "entropy": 4.024501800537109, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 1.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.004247477278113365, "mean_kl_loss": 0.010861785151064396, "total_loss": -0.024532103911042213, "vf_loss_unclipped": 0.004247477278113365, "num_module_steps_trained_lifetime": 40192, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.030951935797929764, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.39588916301727295, "entropy": 4.016512393951416, "num_module_steps_trained": 40192, "weights_seq_no": 1.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 4000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "db5f9_00000", "date": "2025-10-20_16-48-47", "timestamp": 1760971727, "time_this_iter_s": 4.3454718589782715, "time_total_s": 4.3454718589782715, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f7056a68c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.3454718589782715, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 7.7285714285714295, "ram_util_percent": 21.9}}
{"timers": {"training_iteration": 4.339213658905355, "restore_env_runners": 1.8426867900416255e-05, "training_step": 4.339032376906835, "env_runner_sampling_timer": 1.3304203962977044, "learner_update_timer": 3.006195365295862, "synch_weights": 0.0020563403790583835, "synch_env_connectors": 0.0013547850539907813}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.453750000000005, "agent_0": -1.3362500000000042, "agent_2": -3.866875000000012}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.1717151459869327e-05, "add_time_dim_to_batch_and_zero_pad": 8.365233551742784e-06, "numpy_to_tensor": 3.5970047355462714e-05, "add_states_from_episodes_to_batch": 4.844886638391902e-06, "add_observations_from_episodes_to_batch": 2.0037398700472954e-05, "agent_to_module_mapping": 4.127690660096873e-06}}, "connector_pipeline_timer": 0.00013576813328504886}, "env_to_module_sum_episodes_length_in": 399.24749350803154, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6329678798174427, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -4.3200000000000065, "env_step_timer": 0.0003300774326516845, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0079083944369452e-06, "listify_data_for_vector_env": 8.407532091643716e-06, "module_to_agent_unmapping": 3.283025383346126e-06, "un_batch_to_individual_items": 2.3422973990575435e-05, "normalize_and_clip_actions": 3.0519461718902746e-05, "tensor_to_numpy": 5.49371428164812e-05, "get_actions": 0.00020459842676712523}}, "connector_pipeline_timer": 0.0003805036661370361}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 8000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 8000.0, "agent_1": 8000.0, "agent_0": 8000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.24749350803154, "num_episodes_lifetime": 16.0, "agent_episode_returns_mean": {"agent_0": -1.3362500000000042, "agent_2": -3.866875000000012, "agent_1": -1.453750000000005}, "num_agent_steps_sampled_lifetime": {"agent_2": 8000.0, "agent_1": 8000.0, "agent_0": 8000.0}, "sample": 1.300283454801829, "rlmodule_inference_timer": 0.00014410398489998443, "weights_seq_no": 1.0, "episode_len_mean": 500.0, "episode_return_mean": -6.656875000000022, "episode_return_min": -13.98000000000006, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.0665601602377137, "num_env_steps_sampled_lifetime_throughput": 923.875434227498}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04038901698077098, "batch_individual_items": 0.187986868005828, "add_one_ts_to_episodes_and_truncate": 0.006753121077781543, "add_time_dim_to_batch_and_zero_pad": 2.2285943850874903e-05, "add_columns_from_episodes_to_train_batch": 0.09424621061014478, "numpy_to_tensor": 0.0002466990984976292, "add_states_from_episodes_to_batch": 6.607233663089574e-06, "add_observations_from_episodes_to_batch": 0.00016032698506023734, "agent_to_module_mapping": 0.005309437313117087}}, "connector_pipeline_timer": 0.33555717261857354}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 241152, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 1256000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_0": {"vf_explained_var": 0.7589157223701477, "entropy": 4.01243782043457, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 2.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.008521385490894318, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0037338307593017817, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.06949135661125183, "vf_loss_unclipped": 0.0037338307593017817, "num_module_steps_trained_lifetime": 80384, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.07492947578430176, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_1": {"vf_loss": 0.00039392895996570587, "mean_kl_loss": 0.011066027916967869, "total_loss": -0.0018689935095608234, "vf_loss_unclipped": 0.00039392895996570587, "num_module_steps_trained_lifetime": 80384, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.004476137459278107, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.8342519998550415, "entropy": 4.016814708709717, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 2.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.005358476657420397, "mean_kl_loss": 0.008902562782168388, "total_loss": 0.06800854951143265, "vf_loss_unclipped": 0.005358476657420397, "num_module_steps_trained_lifetime": 80384, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.060869570821523666, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.3375247120857239, "entropy": 4.015647888183594, "num_module_steps_trained": 40192, "weights_seq_no": 2.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "db5f9_00000", "date": "2025-10-20_16-48-51", "timestamp": 1760971731, "time_this_iter_s": 4.085534572601318, "time_total_s": 8.43100643157959, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f7055291b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.43100643157959, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 7.719999999999999, "ram_util_percent": 22.0}}
{"timers": {"training_iteration": 4.33856404037656, "restore_env_runners": 1.83942889678292e-05, "training_step": 4.338381059557783, "env_runner_sampling_timer": 1.3308539434347066, "learner_update_timer": 3.0051107506027153, "synch_weights": 0.0020553832351521122, "synch_env_connectors": 0.0013597939134342596}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.1358333333333368, "agent_0": -1.424583333333337, "agent_2": -3.7800000000000114}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.2202364864678274e-05, "add_time_dim_to_batch_and_zero_pad": 8.630101985507743e-06, "numpy_to_tensor": 3.679028213975494e-05, "add_states_from_episodes_to_batch": 5.056055632835571e-06, "add_observations_from_episodes_to_batch": 2.057373310402266e-05, "agent_to_module_mapping": 4.237237293521862e-06}}, "connector_pipeline_timer": 0.00013928125279977764}, "env_to_module_sum_episodes_length_in": 399.2474942227809, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6303955270462515, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.9600000000000035, "env_step_timer": 0.0003332390048089383, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.032648931067785e-06, "listify_data_for_vector_env": 8.596694565630891e-06, "module_to_agent_unmapping": 3.4031995622071353e-06, "un_batch_to_individual_items": 2.407676601241482e-05, "normalize_and_clip_actions": 3.105211544595923e-05, "tensor_to_numpy": 5.545823671048602e-05, "get_actions": 0.0002068312890412593}}, "connector_pipeline_timer": 0.0003857769928644487}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 12000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 12000.0, "agent_1": 12000.0, "agent_0": 12000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942227809, "num_episodes_lifetime": 24.0, "agent_episode_returns_mean": {"agent_0": -1.424583333333337, "agent_2": -3.7800000000000114, "agent_1": -1.1358333333333368}, "num_agent_steps_sampled_lifetime": {"agent_2": 12000.0, "agent_1": 12000.0, "agent_0": 12000.0}, "sample": 1.3002106622486522, "rlmodule_inference_timer": 0.00014576588812771944, "weights_seq_no": 2.0, "episode_len_mean": 500.0, "episode_return_mean": -6.340416666666685, "episode_return_min": -13.98000000000006, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.0642437054353637, "num_env_steps_sampled_lifetime_throughput": 925.5092011370676}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.040373655800824054, "batch_individual_items": 0.18796456890550325, "add_one_ts_to_episodes_and_truncate": 0.006742976507113781, "add_time_dim_to_batch_and_zero_pad": 2.2264374652877453e-05, "add_columns_from_episodes_to_train_batch": 0.09424000633393298, "numpy_to_tensor": 0.0002461798877688125, "add_states_from_episodes_to_batch": 6.601271213730797e-06, "add_observations_from_episodes_to_batch": 0.00016006340527092107, "agent_to_module_mapping": 0.005307115910411812}}, "connector_pipeline_timer": 0.3354972878224566}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 361728, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 1884000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 146298.54100861773, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 28089.299516521554}, "agent_0": {"vf_explained_var": 0.8324548006057739, "entropy": 4.001687526702881, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 3.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.009541145525872707, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0021004797890782356, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.03220128268003464, "vf_loss_unclipped": 0.0021004797890782356, "num_module_steps_trained_lifetime": 120576, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.028192564845085144, "num_module_steps_trained_lifetime_throughput": 9363.072652165596}, "agent_1": {"vf_loss": 0.00023600230633746833, "mean_kl_loss": 0.009809494018554688, "total_loss": -0.06537595391273499, "vf_loss_unclipped": 0.00023600230633746833, "num_module_steps_trained_lifetime": 120576, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.06757386028766632, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.6636824607849121, "entropy": 4.009552001953125, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 3.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9363.104733423697}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.006307399366050959, "mean_kl_loss": 0.010810021311044693, "total_loss": -0.012475891038775444, "vf_loss_unclipped": 0.006307399366050959, "num_module_steps_trained_lifetime": 120576, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.020945310592651367, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.34965479373931885, "entropy": 4.008317947387695, "num_module_steps_trained": 40192, "weights_seq_no": 3.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9363.089497652192}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 12000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "db5f9_00000", "date": "2025-10-20_16-48-55", "timestamp": 1760971735, "time_this_iter_s": 4.278047323226929, "time_total_s": 12.709053754806519, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f705563d00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.709053754806519, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 7.114285714285714, "ram_util_percent": 22.0}}
{"timers": {"training_iteration": 4.3365716310430455, "restore_env_runners": 1.831320599990431e-05, "training_step": 4.336387730251914, "env_runner_sampling_timer": 1.3315558566803, "learner_update_timer": 3.002414754096467, "synch_weights": 0.0020552844328265056, "synch_env_connectors": 0.001360523114242824}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -0.7905000000000014, "agent_0": -1.3602000000000034, "agent_2": -3.6273000000000097}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.23338392268665e-05, "add_time_dim_to_batch_and_zero_pad": 8.424817593425163e-06, "numpy_to_tensor": 3.7056563868197135e-05, "add_states_from_episodes_to_batch": 4.8878150984271676e-06, "add_observations_from_episodes_to_batch": 2.0510117724225406e-05, "agent_to_module_mapping": 4.23015585822062e-06}}, "connector_pipeline_timer": 0.00013912010795522845}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6314017122099176, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -2.8399999999999936, "env_step_timer": 0.0003310194300104914, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0256621318452884e-06, "listify_data_for_vector_env": 8.667328131662782e-06, "module_to_agent_unmapping": 3.331472095620849e-06, "un_batch_to_individual_items": 2.3994480738584365e-05, "normalize_and_clip_actions": 3.108802306084685e-05, "tensor_to_numpy": 5.538380579833108e-05, "get_actions": 0.00020723908784128802}}, "connector_pipeline_timer": 0.0003861204493273197}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 16000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 16000.0, "agent_1": 16000.0, "agent_0": 16000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 32.0, "agent_episode_returns_mean": {"agent_0": -1.3602000000000034, "agent_2": -3.6273000000000097, "agent_1": -0.7905000000000014}, "num_agent_steps_sampled_lifetime": {"agent_2": 16000.0, "agent_1": 16000.0, "agent_0": 16000.0}, "sample": 1.3007681317412416, "rlmodule_inference_timer": 0.00014452384583472, "weights_seq_no": 3.0, "episode_len_mean": 500.0, "episode_return_mean": -5.778000000000015, "episode_return_min": -13.98000000000006, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.0635444815535298, "num_env_steps_sampled_lifetime_throughput": 925.5832546973719}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.040355388152914826, "batch_individual_items": 0.1867081497465997, "add_one_ts_to_episodes_and_truncate": 0.006731571542330203, "add_time_dim_to_batch_and_zero_pad": 2.223923066398129e-05, "add_columns_from_episodes_to_train_batch": 0.0942287967103264, "numpy_to_tensor": 0.00024552931863139387, "add_states_from_episodes_to_batch": 6.5958584973705e-06, "add_observations_from_episodes_to_batch": 0.0001599427417422994, "agent_to_module_mapping": 0.005304917011197423}}, "connector_pipeline_timer": 0.33419426169379346}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 482304, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 2512000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 146544.6702213931, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 28136.558208052207}, "agent_0": {"vf_explained_var": 0.8738758563995361, "entropy": 3.9957451820373535, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 4.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.009461795911192894, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.000726369849871844, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.0032101410906761885, "vf_loss_unclipped": 0.000726369849871844, "num_module_steps_trained_lifetime": 160768, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.0058288536965847015, "num_module_steps_trained_lifetime_throughput": 9378.827316866746}, "agent_1": {"vf_loss": 0.0008414391777478158, "mean_kl_loss": 0.009255061857402325, "total_loss": -0.02097097598016262, "vf_loss_unclipped": 0.0008414391777478158, "num_module_steps_trained_lifetime": 160768, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.023663431406021118, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.8187572956085205, "entropy": 3.995666027069092, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 4.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9378.857285312679}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0059664202854037285, "mean_kl_loss": 0.00915706716477871, "total_loss": -0.015965374186635017, "vf_loss_unclipped": 0.0059664202854037285, "num_module_steps_trained_lifetime": 160768, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.023763207718729973, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.1832948923110962, "entropy": 4.000694274902344, "num_module_steps_trained": 40192, "weights_seq_no": 4.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9378.84283463474}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 16000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "db5f9_00000", "date": "2025-10-20_16-48-59", "timestamp": 1760971739, "time_this_iter_s": 4.142923831939697, "time_total_s": 16.851977586746216, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f705529a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.851977586746216, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 8.16, "ram_util_percent": 21.88}}
{"timers": {"training_iteration": 4.334712632052332, "restore_env_runners": 1.8230283666857287e-05, "training_step": 4.334527989059702, "env_runner_sampling_timer": 1.330999849573537, "learner_update_timer": 3.0011076484855694, "synch_weights": 0.002056905738715565, "synch_env_connectors": 0.0013603155031599455}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.3040000000000034, "agent_0": -1.1928000000000025, "agent_2": -3.723900000000011}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.1939941472301528e-05, "add_time_dim_to_batch_and_zero_pad": 8.359597622263023e-06, "numpy_to_tensor": 3.628946811744305e-05, "add_states_from_episodes_to_batch": 4.855607296280881e-06, "add_observations_from_episodes_to_batch": 2.03387653967248e-05, "agent_to_module_mapping": 4.179261038090767e-06}}, "connector_pipeline_timer": 0.00013679687986512838}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6278860793530475, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -2.8399999999999936, "env_step_timer": 0.0003261743982480124, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0144971906191717e-06, "listify_data_for_vector_env": 8.440244939001887e-06, "module_to_agent_unmapping": 3.333066790717373e-06, "un_batch_to_individual_items": 2.3492492106068045e-05, "normalize_and_clip_actions": 3.067574769880588e-05, "tensor_to_numpy": 5.448186884680272e-05, "get_actions": 0.00020317377593781697}}, "connector_pipeline_timer": 0.0003789342976937085}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 20000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 20000.0, "agent_1": 20000.0, "agent_0": 20000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 40.0, "agent_episode_returns_mean": {"agent_0": -1.1928000000000025, "agent_2": -3.723900000000011, "agent_1": -1.3040000000000034}, "num_agent_steps_sampled_lifetime": {"agent_2": 20000.0, "agent_1": 20000.0, "agent_0": 20000.0}, "sample": 1.3002353754460811, "rlmodule_inference_timer": 0.00014374040693395756, "weights_seq_no": 4.0, "episode_len_mean": 500.0, "episode_return_mean": -6.220700000000017, "episode_return_min": -13.220000000000052, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.0608688259931047, "num_env_steps_sampled_lifetime_throughput": 928.970669203542}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04034766246117965, "batch_individual_items": 0.1866584127693747, "add_one_ts_to_episodes_and_truncate": 0.00672014407667857, "add_time_dim_to_batch_and_zero_pad": 2.2209708277625034e-05, "add_columns_from_episodes_to_train_batch": 0.09420845263292116, "numpy_to_tensor": 0.0002449238253277005, "add_states_from_episodes_to_batch": 6.589619808340794e-06, "add_observations_from_episodes_to_batch": 0.00015968975472859865, "agent_to_module_mapping": 0.005302831010864146}}, "connector_pipeline_timer": 0.33409937138689016}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 602880, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 3140000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 146760.02789415594, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 28177.913269611116}, "agent_0": {"vf_explained_var": 0.7984588146209717, "entropy": 3.9897706508636475, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 5.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.00986588466912508, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.000930417503695935, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.09920897334814072, "vf_loss_unclipped": 0.000930417503695935, "num_module_steps_trained_lifetime": 200960, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.10211259126663208, "num_module_steps_trained_lifetime_throughput": 9392.608864029837}, "agent_1": {"vf_loss": 0.004842949099838734, "mean_kl_loss": 0.008612538687884808, "total_loss": -0.037252090871334076, "vf_loss_unclipped": 0.004842949099838734, "num_module_steps_trained_lifetime": 200960, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.04381754249334335, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.6255680322647095, "entropy": 3.9961745738983154, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 5.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9392.64267728296}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.005971233826130629, "mean_kl_loss": 0.008435448631644249, "total_loss": -0.09185303747653961, "vf_loss_unclipped": 0.005971233826130629, "num_module_steps_trained_lifetime": 200960, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.09951135516166687, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.27396321296691895, "entropy": 3.989978313446045, "num_module_steps_trained": 40192, "weights_seq_no": 5.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9392.62666166722}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 20000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "db5f9_00000", "date": "2025-10-20_16-49-03", "timestamp": 1760971743, "time_this_iter_s": 4.154384613037109, "time_total_s": 21.006362199783325, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f7056a68c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.006362199783325, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 6.516666666666667, "ram_util_percent": 21.8}}
{"timers": {"training_iteration": 4.332423357021906, "restore_env_runners": 1.815495079487922e-05, "training_step": 4.332237286448825, "env_runner_sampling_timer": 1.331207140037503, "learner_update_timer": 2.9985999295908896, "synch_weights": 0.0020615724712728274, "synch_env_connectors": 0.001361613318401066}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.8904000000000059, "agent_0": -1.005000000000002, "agent_2": -3.921700000000013}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.497888120590314e-05, "add_time_dim_to_batch_and_zero_pad": 9.565016318100433e-06, "numpy_to_tensor": 4.137415577340481e-05, "add_states_from_episodes_to_batch": 5.525098264853491e-06, "add_observations_from_episodes_to_batch": 2.3214727771164335e-05, "agent_to_module_mapping": 4.790318430664167e-06}}, "connector_pipeline_timer": 0.000156281089622788}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.632355339640053, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -2.8399999999999936, "env_step_timer": 0.0003841448821634392, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1748079643352328e-06, "listify_data_for_vector_env": 9.714549321203246e-06, "module_to_agent_unmapping": 3.7942236448261458e-06, "un_batch_to_individual_items": 2.6876000081610616e-05, "normalize_and_clip_actions": 3.527043491042099e-05, "tensor_to_numpy": 6.205440374481685e-05, "get_actions": 0.00023085942422868135}}, "connector_pipeline_timer": 0.00043209762932661}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 24000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 24000.0, "agent_1": 24000.0, "agent_0": 24000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 48.0, "agent_episode_returns_mean": {"agent_0": -1.005000000000002, "agent_2": -3.921700000000013, "agent_1": -1.8904000000000059}, "num_agent_steps_sampled_lifetime": {"agent_2": 24000.0, "agent_1": 24000.0, "agent_0": 24000.0}, "sample": 1.300211103709128, "rlmodule_inference_timer": 0.0001606251009230152, "weights_seq_no": 5.0, "episode_len_mean": 500.0, "episode_return_mean": -6.817100000000021, "episode_return_min": -13.220000000000052, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.05944193062566, "num_env_steps_sampled_lifetime_throughput": 929.6751936823542}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04031809352650431, "batch_individual_items": 0.18542667153211212, "add_one_ts_to_episodes_and_truncate": 0.006709950205615057, "add_time_dim_to_batch_and_zero_pad": 2.2178581217080124e-05, "add_columns_from_episodes_to_train_batch": 0.09419159098633328, "numpy_to_tensor": 0.0002443672673766858, "add_states_from_episodes_to_batch": 6.585133856674313e-06, "add_observations_from_episodes_to_batch": 0.00015946621688197755, "agent_to_module_mapping": 0.005300946781108475}}, "connector_pipeline_timer": 0.3328056297029003}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 723456, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 3768000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 147043.093049764, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 28232.253572389247}, "agent_0": {"vf_explained_var": 0.8099479675292969, "entropy": 3.9813342094421387, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 6.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.009349093772470951, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0009278367506340146, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.017902374267578125, "vf_loss_unclipped": 0.0009278367506340146, "num_module_steps_trained_lifetime": 241152, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.01510472223162651, "num_module_steps_trained_lifetime_throughput": 9410.727947199373}, "agent_1": {"vf_loss": 0.005386253818869591, "mean_kl_loss": 0.00897529162466526, "total_loss": 0.00712728314101696, "vf_loss_unclipped": 0.005386253818869591, "num_module_steps_trained_lifetime": 241152, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -5.403406612458639e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.6659553050994873, "entropy": 3.986638069152832, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 6.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9410.755297045363}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.008368792943656445, "mean_kl_loss": 0.010874130763113499, "total_loss": -0.12486813962459564, "vf_loss_unclipped": 0.008368792943656445, "num_module_steps_trained_lifetime": 241152, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.13541176915168762, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.32304924726486206, "entropy": 3.9653408527374268, "num_module_steps_trained": 40192, "weights_seq_no": 6.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9410.743228042018}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 24000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "db5f9_00000", "date": "2025-10-20_16-49-07", "timestamp": 1760971747, "time_this_iter_s": 4.111369371414185, "time_total_s": 25.11773157119751, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f705589870>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.11773157119751, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 6.95, "ram_util_percent": 21.766666666666666}}
{"timers": {"training_iteration": 4.332229115772005, "restore_env_runners": 1.8073301349126386e-05, "training_step": 4.332042571663948, "env_runner_sampling_timer": 1.3325818372171232, "learner_update_timer": 2.9970313430651943, "synch_weights": 0.0020605582665945833, "synch_env_connectors": 0.0013621089649636549}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.8425000000000054, "agent_0": -0.9065000000000015, "agent_2": -4.084300000000014}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.4610386266431743e-05, "add_time_dim_to_batch_and_zero_pad": 9.411210212535479e-06, "numpy_to_tensor": 4.064705479843623e-05, "add_states_from_episodes_to_batch": 5.450580438307835e-06, "add_observations_from_episodes_to_batch": 2.2854637666761288e-05, "agent_to_module_mapping": 4.6983363041532824e-06}}, "connector_pipeline_timer": 0.00015401878312981584}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.65566230884986, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -2.8399999999999936, "env_step_timer": 0.0003625653152095528, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1497261619404513e-06, "listify_data_for_vector_env": 9.553036829340193e-06, "module_to_agent_unmapping": 3.7793524095898985e-06, "un_batch_to_individual_items": 2.6473211812045265e-05, "normalize_and_clip_actions": 3.4633463718822874e-05, "tensor_to_numpy": 6.117507098623972e-05, "get_actions": 0.00022841872023155672}}, "connector_pipeline_timer": 0.00042649882784151613}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 28000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 28000.0, "agent_1": 28000.0, "agent_0": 28000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 56.0, "agent_episode_returns_mean": {"agent_0": -0.9065000000000015, "agent_2": -4.084300000000014, "agent_1": -1.8425000000000054}, "num_agent_steps_sampled_lifetime": {"agent_2": 28000.0, "agent_1": 28000.0, "agent_0": 28000.0}, "sample": 1.3016787370919485, "rlmodule_inference_timer": 0.0001581815774821221, "weights_seq_no": 6.0, "episode_len_mean": 500.0, "episode_return_mean": -6.833300000000022, "episode_return_min": -13.220000000000052, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.0570753007318894, "num_env_steps_sampled_lifetime_throughput": 930.3882449226253}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04029726880126895, "batch_individual_items": 0.1854376408367395, "add_one_ts_to_episodes_and_truncate": 0.006697910653659165, "add_time_dim_to_batch_and_zero_pad": 2.2161845278239022e-05, "add_columns_from_episodes_to_train_batch": 0.09417261120655218, "numpy_to_tensor": 0.00024377569495229878, "add_states_from_episodes_to_batch": 6.583672996763266e-06, "add_observations_from_episodes_to_batch": 0.00015925223460925913, "agent_to_module_mapping": 0.005299040573199837}}, "connector_pipeline_timer": 0.3327595006159173}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 844032, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 4396000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 146944.3776434746, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 28213.302168755912}, "agent_0": {"vf_explained_var": 0.9043141603469849, "entropy": 3.974456787109375, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 7.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.008777780458331108, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0009456977131776512, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0800372064113617, "vf_loss_unclipped": 0.0009456977131776512, "num_module_steps_trained_lifetime": 281344, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.07733594626188278, "num_module_steps_trained_lifetime_throughput": 9404.412300401684}, "agent_1": {"vf_loss": 0.0011133347870782018, "mean_kl_loss": 0.00849947240203619, "total_loss": 0.046902626752853394, "vf_loss_unclipped": 0.0011133347870782018, "num_module_steps_trained_lifetime": 281344, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.04408939555287361, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.886681318283081, "entropy": 3.974504232406616, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 7.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9404.43813316732}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.009761087596416473, "mean_kl_loss": 0.009150641970336437, "total_loss": -0.008558138273656368, "vf_loss_unclipped": 0.009761087596416473, "num_module_steps_trained_lifetime": 281344, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.020149363204836845, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.2883939743041992, "entropy": 3.9612371921539307, "num_module_steps_trained": 40192, "weights_seq_no": 7.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9404.426178727466}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 28000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "db5f9_00000", "date": "2025-10-20_16-49-12", "timestamp": 1760971752, "time_this_iter_s": 4.31690788269043, "time_total_s": 29.43463945388794, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f705529a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.43463945388794, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 7.283333333333335, "ram_util_percent": 21.599999999999998}}
{"timers": {"training_iteration": 4.329387645664291, "restore_env_runners": 1.7978768642758484e-05, "training_step": 4.329200649087348, "env_runner_sampling_timer": 1.3324412570748778, "learner_update_timer": 2.9943325990645553, "synch_weights": 0.002057982253693259, "synch_env_connectors": 0.0013651811654042066}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.697400000000005, "agent_0": -1.0281000000000013, "agent_2": -4.021700000000013}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.1918492819205904e-05, "add_time_dim_to_batch_and_zero_pad": 8.283019870961803e-06, "numpy_to_tensor": 3.610279184066369e-05, "add_states_from_episodes_to_batch": 4.76696640347169e-06, "add_observations_from_episodes_to_batch": 2.01776016082285e-05, "agent_to_module_mapping": 4.1534595267166585e-06}}, "connector_pipeline_timer": 0.0001363735354191422}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6605628246016567, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.6399999999999997, "env_step_timer": 0.00033735236665992054, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0069110933519421e-06, "listify_data_for_vector_env": 8.479186105707987e-06, "module_to_agent_unmapping": 3.336943293618417e-06, "un_batch_to_individual_items": 2.3636252867742223e-05, "normalize_and_clip_actions": 3.0466638508158438e-05, "tensor_to_numpy": 5.3842463929014864e-05, "get_actions": 0.00020187359858513733}}, "connector_pipeline_timer": 0.00037675478576195385}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 32000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 32000.0, "agent_1": 32000.0, "agent_0": 32000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 64.0, "agent_episode_returns_mean": {"agent_0": -1.0281000000000013, "agent_2": -4.021700000000013, "agent_1": -1.697400000000005}, "num_agent_steps_sampled_lifetime": {"agent_2": 32000.0, "agent_1": 32000.0, "agent_0": 32000.0}, "sample": 1.3014716393709045, "rlmodule_inference_timer": 0.00014133055031004501, "weights_seq_no": 7.0, "episode_len_mean": 500.0, "episode_return_mean": -6.747200000000021, "episode_return_min": -10.980000000000054, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.055292011127266, "num_env_steps_sampled_lifetime_throughput": 931.7661781392171}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.040284522852947834, "batch_individual_items": 0.18420806246816143, "add_one_ts_to_episodes_and_truncate": 0.006686529237056648, "add_time_dim_to_batch_and_zero_pad": 2.212593720344783e-05, "add_columns_from_episodes_to_train_batch": 0.0941387139739129, "numpy_to_tensor": 0.00024320619844505508, "add_states_from_episodes_to_batch": 6.580796583222685e-06, "add_observations_from_episodes_to_batch": 0.00015895869188640974, "agent_to_module_mapping": 0.005296930887259005}}, "connector_pipeline_timer": 0.331466206709824}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 964608, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 5024000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 147329.24450592825, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 28287.20098957329}, "agent_0": {"vf_explained_var": 0.8594812154769897, "entropy": 3.9682562351226807, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 8.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.009320913814008236, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0014179004356265068, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.00884545873850584, "vf_loss_unclipped": 0.0014179004356265068, "num_module_steps_trained_lifetime": 321536, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.005563370883464813, "num_module_steps_trained_lifetime_throughput": 9429.045086639158}, "agent_1": {"vf_loss": 0.005524714011698961, "mean_kl_loss": 0.008156875148415565, "total_loss": -0.14413976669311523, "vf_loss_unclipped": 0.005524714011698961, "num_module_steps_trained_lifetime": 321536, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.15129587054252625, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.6946779489517212, "entropy": 3.974146842956543, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 8.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9429.070865324067}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.006984788458794355, "mean_kl_loss": 0.008759016171097755, "total_loss": 0.060887232422828674, "vf_loss_unclipped": 0.006984788458794355, "num_module_steps_trained_lifetime": 321536, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.05215064808726311, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.2425883412361145, "entropy": 3.9442360401153564, "num_module_steps_trained": 40192, "weights_seq_no": 8.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9429.058405210832}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 32000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "db5f9_00000", "date": "2025-10-20_16-49-16", "timestamp": 1760971756, "time_this_iter_s": 4.051728010177612, "time_total_s": 33.48636746406555, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f70558a7a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.48636746406555, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 6.983333333333334, "ram_util_percent": 21.5}}
{"timers": {"training_iteration": 4.327780532737663, "restore_env_runners": 1.7879770861372357e-05, "training_step": 4.327593318826544, "env_runner_sampling_timer": 1.3320617839939546, "learner_update_timer": 2.9931044468541295, "synch_weights": 0.002058140261356559, "synch_env_connectors": 0.0013658060736351115}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.1897000000000022, "agent_0": -1.1542000000000017, "agent_2": -3.9046000000000123}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.3314892605421408e-05, "add_time_dim_to_batch_and_zero_pad": 8.970771801569023e-06, "numpy_to_tensor": 3.8566159304371143e-05, "add_states_from_episodes_to_batch": 5.107733086919086e-06, "add_observations_from_episodes_to_batch": 2.2045841444901783e-05, "agent_to_module_mapping": 4.413680062786226e-06}}, "connector_pipeline_timer": 0.00014561531769320067}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6592738091328647, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.6399999999999997, "env_step_timer": 0.0003375166147304579, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1125648764886379e-06, "listify_data_for_vector_env": 8.868290146199934e-06, "module_to_agent_unmapping": 3.571253609669957e-06, "un_batch_to_individual_items": 2.5150001704279335e-05, "normalize_and_clip_actions": 3.2281930581588246e-05, "tensor_to_numpy": 5.733809490050531e-05, "get_actions": 0.00021587606448880253}}, "connector_pipeline_timer": 0.0004015526680179743}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 36000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 36000.0, "agent_1": 36000.0, "agent_0": 36000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 72.0, "agent_episode_returns_mean": {"agent_0": -1.1542000000000017, "agent_2": -3.9046000000000123, "agent_1": -1.1897000000000022}, "num_agent_steps_sampled_lifetime": {"agent_2": 36000.0, "agent_1": 36000.0, "agent_0": 36000.0}, "sample": 1.3012188526221073, "rlmodule_inference_timer": 0.00015707206033088467, "weights_seq_no": 8.0, "episode_len_mean": 500.0, "episode_return_mean": -6.248500000000016, "episode_return_min": -9.580000000000037, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.052528280008604, "num_env_steps_sampled_lifetime_throughput": 934.7322130198609}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.040269297074757474, "batch_individual_items": 0.18424251944366274, "add_one_ts_to_episodes_and_truncate": 0.006676944214370352, "add_time_dim_to_batch_and_zero_pad": 2.2136677851745986e-05, "add_columns_from_episodes_to_train_batch": 0.09415755036401087, "numpy_to_tensor": 0.0002426941260511376, "add_states_from_episodes_to_batch": 6.5809786425680554e-06, "add_observations_from_episodes_to_batch": 0.0001587607249935157, "agent_to_module_mapping": 0.005295829448301856}}, "connector_pipeline_timer": 0.3314905433525311}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 1085184, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 5652000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 147474.04244422517, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 28315.0019945636}, "agent_0": {"vf_explained_var": 0.8200633525848389, "entropy": 3.972592830657959, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 9.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.006876635365188122, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0014454550109803677, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.07451178878545761, "vf_loss_unclipped": 0.0014454550109803677, "num_module_steps_trained_lifetime": 361728, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.07733258605003357, "num_module_steps_trained_lifetime_throughput": 9438.31468091104}, "agent_1": {"vf_loss": 0.0014339408371597528, "mean_kl_loss": 0.009280300699174404, "total_loss": -0.037022665143013, "vf_loss_unclipped": 0.0014339408371597528, "num_module_steps_trained_lifetime": 361728, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.040312666445970535, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.6234400272369385, "entropy": 3.969088315963745, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 9.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9438.337762210103}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.008616332896053791, "mean_kl_loss": 0.008668816648423672, "total_loss": -0.015391377732157707, "vf_loss_unclipped": 0.008616332896053791, "num_module_steps_trained_lifetime": 361728, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.025741469115018845, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.33037692308425903, "entropy": 3.9499478340148926, "num_module_steps_trained": 40192, "weights_seq_no": 9.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9438.326672791914}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 36000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "db5f9_00000", "date": "2025-10-20_16-49-20", "timestamp": 1760971760, "time_this_iter_s": 4.172502279281616, "time_total_s": 37.65886974334717, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f70558af80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37.65886974334717, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 7.516666666666667, "ram_util_percent": 21.400000000000002}}
{"timers": {"training_iteration": 4.325160725220335, "restore_env_runners": 1.778765367308453e-05, "training_step": 4.324972997448204, "env_runner_sampling_timer": 1.3323461755738586, "learner_update_timer": 2.9902006515355666, "synch_weights": 0.0020562476983704233, "synch_env_connectors": 0.0013684525933935216}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.0435000000000016, "agent_0": -1.0412000000000008, "agent_2": -3.8573000000000115}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.4257372141372597e-05, "add_time_dim_to_batch_and_zero_pad": 9.199775897323412e-06, "numpy_to_tensor": 3.993846489140082e-05, "add_states_from_episodes_to_batch": 5.357111137078463e-06, "add_observations_from_episodes_to_batch": 2.233319635121223e-05, "agent_to_module_mapping": 4.58561887721166e-06}}, "connector_pipeline_timer": 0.00015075197400782992}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.638291758383275, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.8400000000000016, "env_step_timer": 0.0003525215075680045, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1146274606847137e-06, "listify_data_for_vector_env": 9.33991015220653e-06, "module_to_agent_unmapping": 3.688067099735673e-06, "un_batch_to_individual_items": 2.596940129055126e-05, "normalize_and_clip_actions": 3.374903705699142e-05, "tensor_to_numpy": 6.0077560414927274e-05, "get_actions": 0.0002244933693223417}}, "connector_pipeline_timer": 0.0004183087468698837}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 40000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 40000.0, "agent_1": 40000.0, "agent_0": 40000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 80.0, "agent_episode_returns_mean": {"agent_0": -1.0412000000000008, "agent_2": -3.8573000000000115, "agent_1": -1.0435000000000016}, "num_agent_steps_sampled_lifetime": {"agent_2": 40000.0, "agent_1": 40000.0, "agent_0": 40000.0}, "sample": 1.3012377003307838, "rlmodule_inference_timer": 0.00015863473715592416, "weights_seq_no": 9.0, "episode_len_mean": 500.0, "episode_return_mean": -5.942000000000013, "episode_return_min": -9.580000000000037, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.051064280073522, "num_env_steps_sampled_lifetime_throughput": 935.0743357935801}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04027181134426545, "batch_individual_items": 0.18302858374960343, "add_one_ts_to_episodes_and_truncate": 0.006664971301811212, "add_time_dim_to_batch_and_zero_pad": 2.2098311302527593e-05, "add_columns_from_episodes_to_train_batch": 0.09412750962016884, "numpy_to_tensor": 0.00024216691520477838, "add_states_from_episodes_to_batch": 6.578408569341811e-06, "add_observations_from_episodes_to_batch": 0.00015852223744593463, "agent_to_module_mapping": 0.005293100633494019}}, "connector_pipeline_timer": 0.33023080910871905}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 1205760, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 6280000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 147797.60300551573, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 28377.12404878731}, "agent_0": {"vf_explained_var": 0.689325213432312, "entropy": 3.9517483711242676, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 10.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.007488826289772987, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0011360483476892114, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.019005173817276955, "vf_loss_unclipped": 0.0011360483476892114, "num_module_steps_trained_lifetime": 401920, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.016371360048651695, "num_module_steps_trained_lifetime_throughput": 9459.023494264331}, "agent_1": {"vf_loss": 0.0006811472121626139, "mean_kl_loss": 0.007233432028442621, "total_loss": -0.055891044437885284, "vf_loss_unclipped": 0.0006811472121626139, "num_module_steps_trained_lifetime": 401920, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.05801888555288315, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.6833276152610779, "entropy": 3.955625295639038, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 10.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9459.04482374051}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.009125834330916405, "mean_kl_loss": 0.009151024743914604, "total_loss": -0.0017098932294175029, "vf_loss_unclipped": 0.009125834330916405, "num_module_steps_trained_lifetime": 401920, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.012665918096899986, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.19286036491394043, "entropy": 3.9526824951171875, "num_module_steps_trained": 40192, "weights_seq_no": 10.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9459.03443382531}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 40000.0, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "num_module_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.1284498186847622e-05, "add_time_dim_to_batch_and_zero_pad": 8.225470312111421e-06, "numpy_to_tensor": 3.4430557214362597e-05, "add_states_from_episodes_to_batch": 4.807580928724727e-06, "add_observations_from_episodes_to_batch": 2.034041741855017e-05, "agent_to_module_mapping": 4.059113350706193e-06}}, "connector_pipeline_timer": 0.0001353819419893159}, "module_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "num_agent_steps_sampled": {"agent_2": 2500, "agent_0": 2500, "agent_1": 2500}, "num_module_steps_sampled": {"agent_2": 2500, "agent_0": 2500, "agent_1": 2500}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.24749421816176, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8629012629389763e-05, "numpy_to_tensor": 7.805495988577604e-05, "add_states_from_episodes_to_batch": 1.0804971680045128e-05, "add_observations_from_episodes_to_batch": 4.7362991608679295e-05, "agent_to_module_mapping": 8.076953236013651e-06, "batch_individual_items": 5.527696339413524e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.99810732490642e-05, "remove_single_ts_time_rank_from_batch": 1.1480679088848078e-06, "normalize_and_clip_actions": 2.9882479095518916e-05, "module_to_agent_unmapping": 3.2034370820722284e-06, "un_batch_to_individual_items": 2.251953548330358e-05, "listify_data_for_vector_env": 8.453251518877286e-06, "tensor_to_numpy": 5.133163954100435e-05}}, "connector_pipeline_timer": 0.0002579602099546548}, "num_episodes_lifetime": 5, "rlmodule_inference_timer": 0.00012766114988074746, "agent_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "env_reset_timer": 0.0013283130247145891, "episode_duration_sec_mean": 0.5524188554147258, "episode_len_min": 500, "num_env_steps_sampled": 2500, "num_episodes": 5, "weights_seq_no": 10.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 2500, "connector_pipeline_timer": 0.00038411503192037344, "env_to_module_sum_episodes_length_out": 404.24749421816176, "sample": 2.8012697939993814, "episode_return_mean": -3.3980000000000112, "env_step_timer": 0.0002669810995560014}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "db5f9_00000", "date": "2025-10-20_16-49-27", "timestamp": 1760971767, "time_this_iter_s": 6.880844354629517, "time_total_s": 44.539714097976685, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f7055893f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44.539714097976685, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 5.910000000000001, "ram_util_percent": 21.4}}
{"timers": {"training_iteration": 4.325816613878083, "restore_env_runners": 1.7734317083490923e-05, "training_step": 4.325628118113241, "env_runner_sampling_timer": 1.3340590371482524, "learner_update_timer": 2.989138039330118, "synch_weights": 0.0020600040712874562, "synch_env_connectors": 0.0013758308669561627, "restore_eval_env_runners": 7.652968633919954e-06, "evaluation_iteration": 2.810658568982035, "synch_eval_env_connectors": 1.1585012543946505e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -0.6612000000000003, "agent_0": -1.1595000000000015, "agent_2": -3.7469000000000103}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.6131178513326237e-05, "add_time_dim_to_batch_and_zero_pad": 9.98175652637102e-06, "numpy_to_tensor": 4.348205753884047e-05, "add_states_from_episodes_to_batch": 5.734674883252463e-06, "add_observations_from_episodes_to_batch": 2.416195711303177e-05, "agent_to_module_mapping": 4.934110926029365e-06}}, "connector_pipeline_timer": 0.00016323462782819468}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6626780740037793, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.359999999999996, "env_step_timer": 0.0003980809490677609, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3181443598510453e-06, "listify_data_for_vector_env": 1.0050834020730335e-05, "module_to_agent_unmapping": 3.9867577758289525e-06, "un_batch_to_individual_items": 2.8158210854398297e-05, "normalize_and_clip_actions": 3.673075928619888e-05, "tensor_to_numpy": 6.511669332324124e-05, "get_actions": 0.00024313215864739678}}, "connector_pipeline_timer": 0.0004533007478152996}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 44000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 44000.0, "agent_1": 44000.0, "agent_0": 44000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 88.0, "agent_episode_returns_mean": {"agent_0": -1.1595000000000015, "agent_2": -3.7469000000000103, "agent_1": -0.6612000000000003}, "num_agent_steps_sampled_lifetime": {"agent_2": 44000.0, "agent_1": 44000.0, "agent_0": 44000.0}, "sample": 1.302808860042548, "rlmodule_inference_timer": 0.0001714116078886997, "weights_seq_no": 10.0, "episode_len_mean": 500.0, "episode_return_mean": -5.567600000000012, "episode_return_min": -9.580000000000037, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.076709943160349, "num_env_steps_sampled_lifetime_throughput": 916.6421967486282}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04027251426131904, "batch_individual_items": 0.18305277036173884, "add_one_ts_to_episodes_and_truncate": 0.006656171818579809, "add_time_dim_to_batch_and_zero_pad": 2.2098268172184784e-05, "add_columns_from_episodes_to_train_batch": 0.09415300187371323, "numpy_to_tensor": 0.00024165496606564873, "add_states_from_episodes_to_batch": 6.573603993374559e-06, "add_observations_from_episodes_to_batch": 0.00015829446487218267, "agent_to_module_mapping": 0.005292064746990976}}, "connector_pipeline_timer": 0.3302681692371917}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 1326336, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 6908000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 144742.9587867549, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27790.641885560475}, "agent_0": {"vf_explained_var": 0.7088371515274048, "entropy": 3.952240228652954, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 11.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.009956210851669312, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.003046699333935976, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0020439717918634415, "vf_loss_unclipped": 0.003046699333935976, "num_module_steps_trained_lifetime": 442112, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.002993971109390259, "num_module_steps_trained_lifetime_throughput": 9263.52516935189}, "agent_1": {"vf_loss": 0.00039753151941113174, "mean_kl_loss": 0.008383950218558311, "total_loss": 0.008143901824951172, "vf_loss_unclipped": 0.00039753151941113174, "num_module_steps_trained_lifetime": 442112, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.0060695745050907135, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.8867025375366211, "entropy": 3.9454941749572754, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 11.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9263.55083979609}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.010547797195613384, "mean_kl_loss": 0.008310175500810146, "total_loss": -0.07185514271259308, "vf_loss_unclipped": 0.010547797195613384, "num_module_steps_trained_lifetime": 442112, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.08406498283147812, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.23622941970825195, "entropy": 3.9296019077301025, "num_module_steps_trained": 40192, "weights_seq_no": 11.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9263.53820094752}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "num_module_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.1284498186847622e-05, "add_time_dim_to_batch_and_zero_pad": 8.225470312111421e-06, "numpy_to_tensor": 3.4430557214362597e-05, "add_states_from_episodes_to_batch": 4.807580928724727e-06, "add_observations_from_episodes_to_batch": 2.034041741855017e-05, "agent_to_module_mapping": 4.059113350706193e-06}}, "connector_pipeline_timer": 0.0001353819419893159}, "module_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "num_agent_steps_sampled": {"agent_2": 2500, "agent_0": 2500, "agent_1": 2500}, "num_module_steps_sampled": {"agent_2": 2500, "agent_0": 2500, "agent_1": 2500}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.24749421816176, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8629012629389763e-05, "numpy_to_tensor": 7.805495988577604e-05, "add_states_from_episodes_to_batch": 1.0804971680045128e-05, "add_observations_from_episodes_to_batch": 4.7362991608679295e-05, "agent_to_module_mapping": 8.076953236013651e-06, "batch_individual_items": 5.527696339413524e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.99810732490642e-05, "remove_single_ts_time_rank_from_batch": 1.1480679088848078e-06, "normalize_and_clip_actions": 2.9882479095518916e-05, "module_to_agent_unmapping": 3.2034370820722284e-06, "un_batch_to_individual_items": 2.251953548330358e-05, "listify_data_for_vector_env": 8.453251518877286e-06, "tensor_to_numpy": 5.133163954100435e-05}}, "connector_pipeline_timer": 0.0002579602099546548}, "num_episodes_lifetime": 5, "rlmodule_inference_timer": 0.00012766114988074746, "agent_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "env_reset_timer": 0.0013283130247145891, "episode_duration_sec_mean": 0.5524188554147258, "episode_len_min": 500, "num_env_steps_sampled": 2500, "num_episodes": 5, "weights_seq_no": 10.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 2500, "connector_pipeline_timer": 0.00038411503192037344, "env_to_module_sum_episodes_length_out": 404.24749421816176, "sample": 2.8012697939993814, "episode_return_mean": -3.3980000000000112, "env_step_timer": 0.0002669810995560014, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 44000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "db5f9_00000", "date": "2025-10-20_16-49-31", "timestamp": 1760971771, "time_this_iter_s": 4.396160364151001, "time_total_s": 48.935874462127686, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f7056a68c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.935874462127686, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 7.783333333333335, "ram_util_percent": 21.46666666666667}}
{"timers": {"training_iteration": 4.323705627889449, "restore_env_runners": 1.7658993897862438e-05, "training_step": 4.323516115092173, "env_runner_sampling_timer": 1.3338868186064399, "learner_update_timer": 2.9871973249469637, "synch_weights": 0.0020595399301146186, "synch_env_connectors": 0.0013839753787312668, "restore_eval_env_runners": 7.652968633919954e-06, "evaluation_iteration": 2.810658568982035, "synch_eval_env_connectors": 1.1585012543946505e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.0820000000000027, "agent_0": -0.874800000000001, "agent_2": -3.798500000000011}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.2950849255451064e-05, "add_time_dim_to_batch_and_zero_pad": 8.725765733524615e-06, "numpy_to_tensor": 3.8097241373233654e-05, "add_states_from_episodes_to_batch": 5.002387728234228e-06, "add_observations_from_episodes_to_batch": 2.1198524063887185e-05, "agent_to_module_mapping": 4.349214325842374e-06}}, "connector_pipeline_timer": 0.0001428174078640996}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.665604729942861, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.359999999999996, "env_step_timer": 0.0003446614287149835, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.055080790137825e-06, "listify_data_for_vector_env": 8.80947909833274e-06, "module_to_agent_unmapping": 3.5653130328001436e-06, "un_batch_to_individual_items": 2.462527936627212e-05, "normalize_and_clip_actions": 3.179812156457382e-05, "tensor_to_numpy": 5.620400921433495e-05, "get_actions": 0.00021006751312355743}}, "connector_pipeline_timer": 0.0003924836302449392}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 48000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 48000.0, "agent_1": 48000.0, "agent_0": 48000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 96.0, "agent_episode_returns_mean": {"agent_0": -0.874800000000001, "agent_2": -3.798500000000011, "agent_1": -1.0820000000000027}, "num_agent_steps_sampled_lifetime": {"agent_2": 48000.0, "agent_1": 48000.0, "agent_0": 48000.0}, "sample": 1.3027191206821163, "rlmodule_inference_timer": 0.00015239846981925497, "weights_seq_no": 11.0, "episode_len_mean": 500.0, "episode_return_mean": -5.755300000000016, "episode_return_min": -10.68000000000005, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.0754356034913974, "num_env_steps_sampled_lifetime_throughput": 918.1915975137483}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04029162886861206, "batch_individual_items": 0.18185446094824181, "add_one_ts_to_episodes_and_truncate": 0.006646989910417132, "add_time_dim_to_batch_and_zero_pad": 2.2081615335027135e-05, "add_columns_from_episodes_to_train_batch": 0.09415779395532953, "numpy_to_tensor": 0.00024120091679652025, "add_states_from_episodes_to_batch": 6.570108241102366e-06, "add_observations_from_episodes_to_batch": 0.00015811311005759214, "agent_to_module_mapping": 0.005291022239596198}}, "connector_pipeline_timer": 0.3290806164250701}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 1446912, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 7536000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 145104.75020251225, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27860.091357282556}, "agent_0": {"vf_explained_var": 0.6046715974807739, "entropy": 3.9552853107452393, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 12.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.009557888843119144, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0009283883264288306, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.13675189018249512, "vf_loss_unclipped": 0.0009283883264288306, "num_module_steps_trained_lifetime": 482304, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.13959184288978577, "num_module_steps_trained_lifetime_throughput": 9286.681617964916}, "agent_1": {"vf_loss": 0.0017983864527195692, "mean_kl_loss": 0.008851058781147003, "total_loss": 0.03518271446228027, "vf_loss_unclipped": 0.0017983864527195692, "num_module_steps_trained_lifetime": 482304, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.031614113599061966, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.9088793992996216, "entropy": 3.943455219268799, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 12.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9286.699838107135}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.010314266197383404, "mean_kl_loss": 0.008405003696680069, "total_loss": -0.12765774130821228, "vf_loss_unclipped": 0.010314266197383404, "num_module_steps_trained_lifetime": 482304, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.1396530121564865, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.3233041763305664, "entropy": 3.941133499145508, "num_module_steps_trained": 40192, "weights_seq_no": 12.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9286.69246171404}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "num_module_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.1284498186847622e-05, "add_time_dim_to_batch_and_zero_pad": 8.225470312111421e-06, "numpy_to_tensor": 3.4430557214362597e-05, "add_states_from_episodes_to_batch": 4.807580928724727e-06, "add_observations_from_episodes_to_batch": 2.034041741855017e-05, "agent_to_module_mapping": 4.059113350706193e-06}}, "connector_pipeline_timer": 0.0001353819419893159}, "module_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "num_agent_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "num_module_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.24749421816176, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8629012629389763e-05, "numpy_to_tensor": 7.805495988577604e-05, "add_states_from_episodes_to_batch": 1.0804971680045128e-05, "add_observations_from_episodes_to_batch": 4.7362991608679295e-05, "agent_to_module_mapping": 8.076953236013651e-06, "batch_individual_items": 5.527696339413524e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.99810732490642e-05, "remove_single_ts_time_rank_from_batch": 1.1480679088848078e-06, "normalize_and_clip_actions": 2.9882479095518916e-05, "module_to_agent_unmapping": 3.2034370820722284e-06, "un_batch_to_individual_items": 2.251953548330358e-05, "listify_data_for_vector_env": 8.453251518877286e-06, "tensor_to_numpy": 5.133163954100435e-05}}, "connector_pipeline_timer": 0.0002579602099546548}, "num_episodes_lifetime": 5, "rlmodule_inference_timer": 0.00012766114988074746, "agent_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "env_reset_timer": 0.0013283130247145891, "episode_duration_sec_mean": 0.5524188554147258, "episode_len_min": 500, "num_env_steps_sampled": 0, "num_episodes": 0, "weights_seq_no": 10.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 2500, "connector_pipeline_timer": 0.00038411503192037344, "env_to_module_sum_episodes_length_out": 404.24749421816176, "sample": 2.8012697939993814, "episode_return_mean": -3.3980000000000112, "env_step_timer": 0.0002669810995560014, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 48000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "db5f9_00000", "date": "2025-10-20_16-49-35", "timestamp": 1760971775, "time_this_iter_s": 4.119751930236816, "time_total_s": 53.0556263923645, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f705563760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 53.0556263923645, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 8.283333333333333, "ram_util_percent": 21.433333333333337}}
{"timers": {"training_iteration": 4.322678820040465, "restore_env_runners": 1.760766451686316e-05, "training_step": 4.322488533311256, "env_runner_sampling_timer": 1.3339492998208948, "learner_update_timer": 2.9861061675974483, "synch_weights": 0.0020593318106145427, "synch_env_connectors": 0.0013890865946232353, "restore_eval_env_runners": 7.652968633919954e-06, "evaluation_iteration": 2.810658568982035, "synch_eval_env_connectors": 1.1585012543946505e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.1200000000000025, "agent_0": -0.9616000000000008, "agent_2": -3.8383000000000123}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.3582658524878276e-05, "add_time_dim_to_batch_and_zero_pad": 9.035680066291091e-06, "numpy_to_tensor": 3.8964451145573605e-05, "add_states_from_episodes_to_batch": 5.244103468848157e-06, "add_observations_from_episodes_to_batch": 2.17293083589282e-05, "agent_to_module_mapping": 4.4678887497056434e-06}}, "connector_pipeline_timer": 0.00014707159046837287}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.667481789785088, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.359999999999996, "env_step_timer": 0.0003604548572975978, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0887762001647472e-06, "listify_data_for_vector_env": 9.074365651026748e-06, "module_to_agent_unmapping": 3.5965007305121645e-06, "un_batch_to_individual_items": 2.5472168266411837e-05, "normalize_and_clip_actions": 3.300223449037615e-05, "tensor_to_numpy": 5.848372643899229e-05, "get_actions": 0.00021832307967896994}}, "connector_pipeline_timer": 0.0004073288604107107}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 52000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 52000.0, "agent_1": 52000.0, "agent_0": 52000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 104.0, "agent_episode_returns_mean": {"agent_0": -0.9616000000000008, "agent_2": -3.8383000000000123, "agent_1": -1.1200000000000025}, "num_agent_steps_sampled_lifetime": {"agent_2": 52000.0, "agent_1": 52000.0, "agent_0": 52000.0}, "sample": 1.3027472188304012, "rlmodule_inference_timer": 0.00015341727134289112, "weights_seq_no": 12.0, "episode_len_mean": 500.0, "episode_return_mean": -5.919900000000015, "episode_return_min": -10.68000000000005, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.0730866853139203, "num_env_steps_sampled_lifetime_throughput": 920.3967569223587}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04029409527960832, "batch_individual_items": 0.18192418718893633, "add_one_ts_to_episodes_and_truncate": 0.006645776051274202, "add_time_dim_to_batch_and_zero_pad": 2.2058959014184235e-05, "add_columns_from_episodes_to_train_batch": 0.094145105506091, "numpy_to_tensor": 0.00024071147756469643, "add_states_from_episodes_to_batch": 6.561146822396572e-06, "add_observations_from_episodes_to_batch": 0.00015787994905806725, "agent_to_module_mapping": 0.005289099887399842}}, "connector_pipeline_timer": 0.32913380194054087}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 1567488, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 8164000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 145254.1657400972, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27888.78238459887}, "agent_0": {"vf_explained_var": 0.767679750919342, "entropy": 3.934809923171997, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 13.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.009667918086051941, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0012487005442380905, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.008400497026741505, "vf_loss_unclipped": 0.0012487005442380905, "num_module_steps_trained_lifetime": 522496, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.011582775041460991, "num_module_steps_trained_lifetime_throughput": 9296.244729098173}, "agent_1": {"vf_loss": 0.005775284953415394, "mean_kl_loss": 0.009072035551071167, "total_loss": -0.04077713564038277, "vf_loss_unclipped": 0.005775284953415394, "num_module_steps_trained_lifetime": 522496, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.048366837203502655, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.4309777617454529, "entropy": 3.9296016693115234, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 13.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9296.26322683911}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.008086754940450191, "mean_kl_loss": 0.008491032756865025, "total_loss": -0.05182552710175514, "vf_loss_unclipped": 0.008086754940450191, "num_module_steps_trained_lifetime": 522496, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.061610493808984756, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.40394359827041626, "entropy": 3.910456657409668, "num_module_steps_trained": 40192, "weights_seq_no": 13.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9296.255819747736}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "num_module_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.1284498186847622e-05, "add_time_dim_to_batch_and_zero_pad": 8.225470312111421e-06, "numpy_to_tensor": 3.4430557214362597e-05, "add_states_from_episodes_to_batch": 4.807580928724727e-06, "add_observations_from_episodes_to_batch": 2.034041741855017e-05, "agent_to_module_mapping": 4.059113350706193e-06}}, "connector_pipeline_timer": 0.0001353819419893159}, "module_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "num_agent_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "num_module_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.24749421816176, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8629012629389763e-05, "numpy_to_tensor": 7.805495988577604e-05, "add_states_from_episodes_to_batch": 1.0804971680045128e-05, "add_observations_from_episodes_to_batch": 4.7362991608679295e-05, "agent_to_module_mapping": 8.076953236013651e-06, "batch_individual_items": 5.527696339413524e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.99810732490642e-05, "remove_single_ts_time_rank_from_batch": 1.1480679088848078e-06, "normalize_and_clip_actions": 2.9882479095518916e-05, "module_to_agent_unmapping": 3.2034370820722284e-06, "un_batch_to_individual_items": 2.251953548330358e-05, "listify_data_for_vector_env": 8.453251518877286e-06, "tensor_to_numpy": 5.133163954100435e-05}}, "connector_pipeline_timer": 0.0002579602099546548}, "num_episodes_lifetime": 5, "rlmodule_inference_timer": 0.00012766114988074746, "agent_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "env_reset_timer": 0.0013283130247145891, "episode_duration_sec_mean": 0.5524188554147258, "episode_len_min": 500, "num_env_steps_sampled": 0, "num_episodes": 0, "weights_seq_no": 10.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 2500, "connector_pipeline_timer": 0.00038411503192037344, "env_to_module_sum_episodes_length_out": 404.24749421816176, "sample": 2.8012697939993814, "episode_return_mean": -3.3980000000000112, "env_step_timer": 0.0002669810995560014, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 52000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "db5f9_00000", "date": "2025-10-20_16-49-40", "timestamp": 1760971780, "time_this_iter_s": 4.225474119186401, "time_total_s": 57.2811005115509, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f70558b6d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.2811005115509, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 7.916666666666667, "ram_util_percent": 21.400000000000002}}
{"timers": {"training_iteration": 4.320131655939927, "restore_env_runners": 1.7536127666541895e-05, "training_step": 4.3199406157877025, "env_runner_sampling_timer": 1.3336520641227982, "learner_update_timer": 2.983856864861512, "synch_weights": 0.0020570830122846897, "synch_env_connectors": 0.001389181308393976, "restore_eval_env_runners": 7.652968633919954e-06, "evaluation_iteration": 2.810658568982035, "synch_eval_env_connectors": 1.1585012543946505e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.4348000000000027, "agent_0": -0.7893000000000001, "agent_2": -4.070700000000014}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.2845634463782838e-05, "add_time_dim_to_batch_and_zero_pad": 8.72326469408829e-06, "numpy_to_tensor": 3.7827749795538925e-05, "add_states_from_episodes_to_batch": 5.064019980880543e-06, "add_observations_from_episodes_to_batch": 2.1004512393592112e-05, "agent_to_module_mapping": 4.364171713010712e-06}}, "connector_pipeline_timer": 0.0001425477357304657}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6415670359204523, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -4.050000000000003, "env_step_timer": 0.0003551513942926544, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0762619472545807e-06, "listify_data_for_vector_env": 8.913344662872772e-06, "module_to_agent_unmapping": 3.4885478962387157e-06, "un_batch_to_individual_items": 2.4567186515799493e-05, "normalize_and_clip_actions": 3.207459093236621e-05, "tensor_to_numpy": 5.69997083772174e-05, "get_actions": 0.0002133087819541696}}, "connector_pipeline_timer": 0.00039694562469199215}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 56000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 56000.0, "agent_1": 56000.0, "agent_0": 56000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 112.0, "agent_episode_returns_mean": {"agent_0": -0.7893000000000001, "agent_2": -4.070700000000014, "agent_1": -1.4348000000000027}, "num_agent_steps_sampled_lifetime": {"agent_2": 56000.0, "agent_1": 56000.0, "agent_0": 56000.0}, "sample": 1.3024691167345948, "rlmodule_inference_timer": 0.00015105510434101257, "weights_seq_no": 13.0, "episode_len_mean": 500.0, "episode_return_mean": -6.294800000000017, "episode_return_min": -10.68000000000005, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.0716650085156982, "num_env_steps_sampled_lifetime_throughput": 921.9779695994323}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.040292806226841046, "batch_individual_items": 0.18073557696761217, "add_one_ts_to_episodes_and_truncate": 0.006635570000809405, "add_time_dim_to_batch_and_zero_pad": 2.2059419419203984e-05, "add_columns_from_episodes_to_train_batch": 0.09412694117109269, "numpy_to_tensor": 0.00024010678279983967, "add_states_from_episodes_to_batch": 6.555715672714431e-06, "add_observations_from_episodes_to_batch": 0.00015759029966303136, "agent_to_module_mapping": 0.00528786255832366}}, "connector_pipeline_timer": 0.3279109300811162}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 1688064, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 8792000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 145680.28568314452, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27970.596897089665}, "agent_0": {"vf_explained_var": 0.6994194388389587, "entropy": 3.911623239517212, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 14.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.008594529703259468, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0014031071914359927, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.054044656455516815, "vf_loss_unclipped": 0.0014031071914359927, "num_module_steps_trained_lifetime": 562688, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.05716666951775551, "num_module_steps_trained_lifetime_throughput": 9323.518117510936}, "agent_1": {"vf_loss": 0.001543722115457058, "mean_kl_loss": 0.008200215175747871, "total_loss": -0.04473373293876648, "vf_loss_unclipped": 0.001543722115457058, "num_module_steps_trained_lifetime": 562688, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.04791749268770218, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.8528134226799011, "entropy": 3.9285054206848145, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 14.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9323.534718930734}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.00579465227201581, "mean_kl_loss": 0.009481050074100494, "total_loss": 0.0171490628272295, "vf_loss_unclipped": 0.00579465227201581, "num_module_steps_trained_lifetime": 562688, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.009458199143409729, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.3615710735321045, "entropy": 3.8942439556121826, "num_module_steps_trained": 40192, "weights_seq_no": 14.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9323.528315276692}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "num_module_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.1284498186847622e-05, "add_time_dim_to_batch_and_zero_pad": 8.225470312111421e-06, "numpy_to_tensor": 3.4430557214362597e-05, "add_states_from_episodes_to_batch": 4.807580928724727e-06, "add_observations_from_episodes_to_batch": 2.034041741855017e-05, "agent_to_module_mapping": 4.059113350706193e-06}}, "connector_pipeline_timer": 0.0001353819419893159}, "module_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "num_agent_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "num_module_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.24749421816176, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8629012629389763e-05, "numpy_to_tensor": 7.805495988577604e-05, "add_states_from_episodes_to_batch": 1.0804971680045128e-05, "add_observations_from_episodes_to_batch": 4.7362991608679295e-05, "agent_to_module_mapping": 8.076953236013651e-06, "batch_individual_items": 5.527696339413524e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.99810732490642e-05, "remove_single_ts_time_rank_from_batch": 1.1480679088848078e-06, "normalize_and_clip_actions": 2.9882479095518916e-05, "module_to_agent_unmapping": 3.2034370820722284e-06, "un_batch_to_individual_items": 2.251953548330358e-05, "listify_data_for_vector_env": 8.453251518877286e-06, "tensor_to_numpy": 5.133163954100435e-05}}, "connector_pipeline_timer": 0.0002579602099546548}, "num_episodes_lifetime": 5, "rlmodule_inference_timer": 0.00012766114988074746, "agent_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "env_reset_timer": 0.0013283130247145891, "episode_duration_sec_mean": 0.5524188554147258, "episode_len_min": 500, "num_env_steps_sampled": 0, "num_episodes": 0, "weights_seq_no": 10.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 2500, "connector_pipeline_timer": 0.00038411503192037344, "env_to_module_sum_episodes_length_out": 404.24749421816176, "sample": 2.8012697939993814, "episode_return_mean": -3.3980000000000112, "env_step_timer": 0.0002669810995560014, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 56000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "db5f9_00000", "date": "2025-10-20_16-49-44", "timestamp": 1760971784, "time_this_iter_s": 4.073204040527344, "time_total_s": 61.35430455207825, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f705529240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 61.35430455207825, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 7.3500000000000005, "ram_util_percent": 21.36666666666667}}
{"timers": {"training_iteration": 4.3213577439402115, "restore_env_runners": 1.745239630760985e-05, "training_step": 4.321165967849801, "env_runner_sampling_timer": 1.3346458449211926, "learner_update_timer": 2.984084345292657, "synch_weights": 0.00205939574173901, "synch_env_connectors": 0.0013974978052752442, "restore_eval_env_runners": 7.652968633919954e-06, "evaluation_iteration": 2.810658568982035, "synch_eval_env_connectors": 1.1585012543946505e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.0139000000000002, "agent_0": -1.2892000000000017, "agent_2": -3.943400000000013}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.5781830578550672e-05, "add_time_dim_to_batch_and_zero_pad": 9.857065463001477e-06, "numpy_to_tensor": 4.297104259458298e-05, "add_states_from_episodes_to_batch": 5.7289083142345364e-06, "add_observations_from_episodes_to_batch": 2.407663475472765e-05, "agent_to_module_mapping": 4.911311000818383e-06}}, "connector_pipeline_timer": 0.00016181860909076414}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6530180167924846, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.509999999999998, "env_step_timer": 0.00039697738977657464, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2109488266333683e-06, "listify_data_for_vector_env": 9.987255582499122e-06, "module_to_agent_unmapping": 4.02553556043724e-06, "un_batch_to_individual_items": 2.7905049061807817e-05, "normalize_and_clip_actions": 3.6311489914434526e-05, "tensor_to_numpy": 6.453069311391256e-05, "get_actions": 0.00024035283929004853}}, "connector_pipeline_timer": 0.0004483005399740286}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 60000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 60000.0, "agent_1": 60000.0, "agent_0": 60000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 120.0, "agent_episode_returns_mean": {"agent_0": -1.2892000000000017, "agent_2": -3.943400000000013, "agent_1": -1.0139000000000002}, "num_agent_steps_sampled_lifetime": {"agent_2": 60000.0, "agent_1": 60000.0, "agent_0": 60000.0}, "sample": 1.3033542840497603, "rlmodule_inference_timer": 0.00017058534396616564, "weights_seq_no": 14.0, "episode_len_mean": 500.0, "episode_return_mean": -6.246500000000014, "episode_return_min": -11.95000000000004, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.069069375608015, "num_env_steps_sampled_lifetime_throughput": 923.3201634403345}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04034324936470109, "batch_individual_items": 0.18093555242791523, "add_one_ts_to_episodes_and_truncate": 0.006628478870810275, "add_time_dim_to_batch_and_zero_pad": 2.2075095359349192e-05, "add_columns_from_episodes_to_train_batch": 0.09420970513947202, "numpy_to_tensor": 0.00023978798519269466, "add_states_from_episodes_to_batch": 6.554048408759126e-06, "add_observations_from_episodes_to_batch": 0.0001574896663397932, "agent_to_module_mapping": 0.005290751612909507}}, "connector_pipeline_timer": 0.3282375909800975}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 1808640, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 9420000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 145434.74243960634, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27923.45691534916}, "agent_0": {"vf_explained_var": 0.617477297782898, "entropy": 3.9055776596069336, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 15.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.008610956370830536, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.004619428887963295, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.03255660459399223, "vf_loss_unclipped": 0.004619428887963295, "num_module_steps_trained_lifetime": 602880, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.03889823704957962, "num_module_steps_trained_lifetime_throughput": 9307.802964202165}, "agent_1": {"vf_loss": 0.0008008958538994193, "mean_kl_loss": 0.00913814827799797, "total_loss": -0.0005460063694044948, "vf_loss_unclipped": 0.0008008958538994193, "num_module_steps_trained_lifetime": 602880, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.0031745415180921555, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.8129664063453674, "entropy": 3.9300341606140137, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 15.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9307.821263724074}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.01128414086997509, "mean_kl_loss": 0.008899245411157608, "total_loss": -0.06175582483410835, "vf_loss_unclipped": 0.01128414086997509, "num_module_steps_trained_lifetime": 602880, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.07481981813907623, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.18396979570388794, "entropy": 3.875391721725464, "num_module_steps_trained": 40192, "weights_seq_no": 15.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9307.814157689547}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "num_module_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.1284498186847622e-05, "add_time_dim_to_batch_and_zero_pad": 8.225470312111421e-06, "numpy_to_tensor": 3.4430557214362597e-05, "add_states_from_episodes_to_batch": 4.807580928724727e-06, "add_observations_from_episodes_to_batch": 2.034041741855017e-05, "agent_to_module_mapping": 4.059113350706193e-06}}, "connector_pipeline_timer": 0.0001353819419893159}, "module_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "num_agent_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "num_module_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.24749421816176, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8629012629389763e-05, "numpy_to_tensor": 7.805495988577604e-05, "add_states_from_episodes_to_batch": 1.0804971680045128e-05, "add_observations_from_episodes_to_batch": 4.7362991608679295e-05, "agent_to_module_mapping": 8.076953236013651e-06, "batch_individual_items": 5.527696339413524e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.99810732490642e-05, "remove_single_ts_time_rank_from_batch": 1.1480679088848078e-06, "normalize_and_clip_actions": 2.9882479095518916e-05, "module_to_agent_unmapping": 3.2034370820722284e-06, "un_batch_to_individual_items": 2.251953548330358e-05, "listify_data_for_vector_env": 8.453251518877286e-06, "tensor_to_numpy": 5.133163954100435e-05}}, "connector_pipeline_timer": 0.0002579602099546548}, "num_episodes_lifetime": 5, "rlmodule_inference_timer": 0.00012766114988074746, "agent_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "env_reset_timer": 0.0013283130247145891, "episode_duration_sec_mean": 0.5524188554147258, "episode_len_min": 500, "num_env_steps_sampled": 0, "num_episodes": 0, "weights_seq_no": 10.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 2500, "connector_pipeline_timer": 0.00038411503192037344, "env_to_module_sum_episodes_length_out": 404.24749421816176, "sample": 2.8012697939993814, "episode_return_mean": -3.3980000000000112, "env_step_timer": 0.0002669810995560014, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 60000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "db5f9_00000", "date": "2025-10-20_16-49-48", "timestamp": 1760971788, "time_this_iter_s": 4.4476354122161865, "time_total_s": 65.80193996429443, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f70558b2e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.80193996429443, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 8.95, "ram_util_percent": 21.45}}
{"timers": {"training_iteration": 4.3196388714810965, "restore_env_runners": 1.7366272319163034e-05, "training_step": 4.319446122911305, "env_runner_sampling_timer": 1.3351023697718096, "learner_update_timer": 2.98190230906933, "synch_weights": 0.0020623635347438514, "synch_env_connectors": 0.00140211438729662, "restore_eval_env_runners": 7.652968633919954e-06, "evaluation_iteration": 2.810658568982035, "synch_eval_env_connectors": 1.1585012543946505e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.0276000000000003, "agent_0": -1.333500000000003, "agent_2": -4.059900000000014}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.400471223660003e-05, "add_time_dim_to_batch_and_zero_pad": 9.17492903602038e-06, "numpy_to_tensor": 3.98653362468852e-05, "add_states_from_episodes_to_batch": 5.310037624140408e-06, "add_observations_from_episodes_to_batch": 2.2314436995087198e-05, "agent_to_module_mapping": 4.570652705181075e-06}}, "connector_pipeline_timer": 0.00015030012124364877}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6592251347377897, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.1700000000000097, "env_step_timer": 0.000364921836023172, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.110505202487487e-06, "listify_data_for_vector_env": 9.273655352094555e-06, "module_to_agent_unmapping": 3.701725468651625e-06, "un_batch_to_individual_items": 2.5976459449368714e-05, "normalize_and_clip_actions": 3.3659199617425383e-05, "tensor_to_numpy": 5.95021531924299e-05, "get_actions": 0.00022234083976719699}}, "connector_pipeline_timer": 0.00041528450571376733}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 64000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 64000.0, "agent_1": 64000.0, "agent_0": 64000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 128.0, "agent_episode_returns_mean": {"agent_0": -1.333500000000003, "agent_2": -4.059900000000014, "agent_1": -1.0276000000000003}, "num_agent_steps_sampled_lifetime": {"agent_2": 64000.0, "agent_1": 64000.0, "agent_0": 64000.0}, "sample": 1.3037457739516425, "rlmodule_inference_timer": 0.00015630865752589871, "weights_seq_no": 15.0, "episode_len_mean": 500.0, "episode_return_mean": -6.421000000000017, "episode_return_min": -11.95000000000004, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.069055769269215, "num_env_steps_sampled_lifetime_throughput": 922.5443213432727}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04033928543082586, "batch_individual_items": 0.17975657676357623, "add_one_ts_to_episodes_and_truncate": 0.006618606692094721, "add_time_dim_to_batch_and_zero_pad": 2.2043344098665118e-05, "add_columns_from_episodes_to_train_batch": 0.0942012922580906, "numpy_to_tensor": 0.00023923699542241923, "add_states_from_episodes_to_batch": 6.549047966557805e-06, "add_observations_from_episodes_to_batch": 0.00015727755944791485, "agent_to_module_mapping": 0.005289943696632639}}, "connector_pipeline_timer": 0.3270322983407113}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 1929216, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 10048000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 145701.16698322227, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27974.606476371708}, "agent_0": {"vf_explained_var": 0.7136832475662231, "entropy": 3.8696069717407227, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 16.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.009355447255074978, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0013946143444627523, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.06704183667898178, "vf_loss_unclipped": 0.0013946143444627523, "num_module_steps_trained_lifetime": 643072, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.07030753046274185, "num_module_steps_trained_lifetime_throughput": 9324.85586375548}, "agent_1": {"vf_loss": 0.0016269412590190768, "mean_kl_loss": 0.00877203419804573, "total_loss": 0.04366099461913109, "vf_loss_unclipped": 0.0016269412590190768, "num_module_steps_trained_lifetime": 643072, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.040279652923345566, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.8303759098052979, "entropy": 3.914767026901245, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 16.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9324.870964003694}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.008389484137296677, "mean_kl_loss": 0.009518800303339958, "total_loss": -0.020449429750442505, "vf_loss_unclipped": 0.008389484137296677, "num_module_steps_trained_lifetime": 643072, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.03074268065392971, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.3465544581413269, "entropy": 3.8537251949310303, "num_module_steps_trained": 40192, "weights_seq_no": 16.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9324.865694942546}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "num_module_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.1284498186847622e-05, "add_time_dim_to_batch_and_zero_pad": 8.225470312111421e-06, "numpy_to_tensor": 3.4430557214362597e-05, "add_states_from_episodes_to_batch": 4.807580928724727e-06, "add_observations_from_episodes_to_batch": 2.034041741855017e-05, "agent_to_module_mapping": 4.059113350706193e-06}}, "connector_pipeline_timer": 0.0001353819419893159}, "module_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "num_agent_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "num_module_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.24749421816176, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8629012629389763e-05, "numpy_to_tensor": 7.805495988577604e-05, "add_states_from_episodes_to_batch": 1.0804971680045128e-05, "add_observations_from_episodes_to_batch": 4.7362991608679295e-05, "agent_to_module_mapping": 8.076953236013651e-06, "batch_individual_items": 5.527696339413524e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.99810732490642e-05, "remove_single_ts_time_rank_from_batch": 1.1480679088848078e-06, "normalize_and_clip_actions": 2.9882479095518916e-05, "module_to_agent_unmapping": 3.2034370820722284e-06, "un_batch_to_individual_items": 2.251953548330358e-05, "listify_data_for_vector_env": 8.453251518877286e-06, "tensor_to_numpy": 5.133163954100435e-05}}, "connector_pipeline_timer": 0.0002579602099546548}, "num_episodes_lifetime": 5, "rlmodule_inference_timer": 0.00012766114988074746, "agent_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "env_reset_timer": 0.0013283130247145891, "episode_duration_sec_mean": 0.5524188554147258, "episode_len_min": 500, "num_env_steps_sampled": 0, "num_episodes": 0, "weights_seq_no": 10.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 2500, "connector_pipeline_timer": 0.00038411503192037344, "env_to_module_sum_episodes_length_out": 404.24749421816176, "sample": 2.8012697939993814, "episode_return_mean": -3.3980000000000112, "env_step_timer": 0.0002669810995560014, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 64000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "db5f9_00000", "date": "2025-10-20_16-49-52", "timestamp": 1760971792, "time_this_iter_s": 4.15457010269165, "time_total_s": 69.95651006698608, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f70558a8c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.95651006698608, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 7.733333333333333, "ram_util_percent": 21.666666666666668}}
{"timers": {"training_iteration": 4.318893503836296, "restore_env_runners": 1.7284119605923292e-05, "training_step": 4.318700251082348, "env_runner_sampling_timer": 1.336259392414289, "learner_update_timer": 2.979996952098785, "synch_weights": 0.0020638157991566515, "synch_env_connectors": 0.0014080280238537026, "restore_eval_env_runners": 7.652968633919954e-06, "evaluation_iteration": 2.810658568982035, "synch_eval_env_connectors": 1.1585012543946505e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -0.9169000000000012, "agent_0": -1.5463000000000042, "agent_2": -3.915700000000013}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.2146842918576055e-05, "add_time_dim_to_batch_and_zero_pad": 8.598098872568225e-06, "numpy_to_tensor": 3.687537668932893e-05, "add_states_from_episodes_to_batch": 4.931194159713949e-06, "add_observations_from_episodes_to_batch": 2.041221169502721e-05, "agent_to_module_mapping": 4.176140182613516e-06}}, "connector_pipeline_timer": 0.00013857002890335868}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6601007668132661, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.1700000000000097, "env_step_timer": 0.00033635988406667045, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0332244572787221e-06, "listify_data_for_vector_env": 8.567210857796538e-06, "module_to_agent_unmapping": 3.400325491322426e-06, "un_batch_to_individual_items": 2.412955508747217e-05, "normalize_and_clip_actions": 3.134750288308902e-05, "tensor_to_numpy": 5.530068448679455e-05, "get_actions": 0.00020653477810158292}}, "connector_pipeline_timer": 0.0003853931855124884}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 68000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 68000.0, "agent_1": 68000.0, "agent_0": 68000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 136.0, "agent_episode_returns_mean": {"agent_0": -1.5463000000000042, "agent_2": -3.915700000000013, "agent_1": -0.9169000000000012}, "num_agent_steps_sampled_lifetime": {"agent_2": 68000.0, "agent_1": 68000.0, "agent_0": 68000.0}, "sample": 1.303580053487253, "rlmodule_inference_timer": 0.0001460436534904412, "weights_seq_no": 16.0, "episode_len_mean": 500.0, "episode_return_mean": -6.378900000000017, "episode_return_min": -11.95000000000004, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.0666123584891403, "num_env_steps_sampled_lifetime_throughput": 923.6134483328167}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.0403320218367065, "batch_individual_items": 0.17858910894570143, "add_one_ts_to_episodes_and_truncate": 0.006608268844954956, "add_time_dim_to_batch_and_zero_pad": 2.203337093309007e-05, "add_columns_from_episodes_to_train_batch": 0.09420262912510492, "numpy_to_tensor": 0.00023872801582777554, "add_states_from_episodes_to_batch": 6.542787274331334e-06, "add_observations_from_episodes_to_batch": 0.00015702639345108885, "agent_to_module_mapping": 0.0052884130093667995}}, "connector_pipeline_timer": 0.32584392175729837}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 2049792, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 10676000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 145781.67244029712, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27990.06476725124}, "agent_0": {"vf_explained_var": 0.8347064256668091, "entropy": 3.8798739910125732, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 17.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.00978940725326538, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.002054567914456129, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.09099975973367691, "vf_loss_unclipped": 0.002054567914456129, "num_module_steps_trained_lifetime": 683264, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.08698730915784836, "num_module_steps_trained_lifetime_throughput": 9330.007350561593}, "agent_1": {"vf_loss": 0.0003563081263564527, "mean_kl_loss": 0.009519870392978191, "total_loss": 0.006401131860911846, "vf_loss_unclipped": 0.0003563081263564527, "num_module_steps_trained_lifetime": 683264, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.004140849225223064, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.7817273736000061, "entropy": 3.921107769012451, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 17.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9330.023564532468}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.008489491418004036, "mean_kl_loss": 0.011720304377377033, "total_loss": -0.05280931666493416, "vf_loss_unclipped": 0.008489491418004036, "num_module_steps_trained_lifetime": 683264, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.06364286690950394, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.44180601835250854, "entropy": 3.85278582572937, "num_module_steps_trained": 40192, "weights_seq_no": 17.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9330.018239473513}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "num_module_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.1284498186847622e-05, "add_time_dim_to_batch_and_zero_pad": 8.225470312111421e-06, "numpy_to_tensor": 3.4430557214362597e-05, "add_states_from_episodes_to_batch": 4.807580928724727e-06, "add_observations_from_episodes_to_batch": 2.034041741855017e-05, "agent_to_module_mapping": 4.059113350706193e-06}}, "connector_pipeline_timer": 0.0001353819419893159}, "module_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "num_agent_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "num_module_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.24749421816176, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8629012629389763e-05, "numpy_to_tensor": 7.805495988577604e-05, "add_states_from_episodes_to_batch": 1.0804971680045128e-05, "add_observations_from_episodes_to_batch": 4.7362991608679295e-05, "agent_to_module_mapping": 8.076953236013651e-06, "batch_individual_items": 5.527696339413524e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.99810732490642e-05, "remove_single_ts_time_rank_from_batch": 1.1480679088848078e-06, "normalize_and_clip_actions": 2.9882479095518916e-05, "module_to_agent_unmapping": 3.2034370820722284e-06, "un_batch_to_individual_items": 2.251953548330358e-05, "listify_data_for_vector_env": 8.453251518877286e-06, "tensor_to_numpy": 5.133163954100435e-05}}, "connector_pipeline_timer": 0.0002579602099546548}, "num_episodes_lifetime": 5, "rlmodule_inference_timer": 0.00012766114988074746, "agent_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "env_reset_timer": 0.0013283130247145891, "episode_duration_sec_mean": 0.5524188554147258, "episode_len_min": 500, "num_env_steps_sampled": 0, "num_episodes": 0, "weights_seq_no": 10.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 2500, "connector_pipeline_timer": 0.00038411503192037344, "env_to_module_sum_episodes_length_out": 404.24749421816176, "sample": 2.8012697939993814, "episode_return_mean": -3.3980000000000112, "env_step_timer": 0.0002669810995560014, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 68000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "db5f9_00000", "date": "2025-10-20_16-49-57", "timestamp": 1760971797, "time_this_iter_s": 4.249587774276733, "time_total_s": 74.20609784126282, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f70558b1c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 74.20609784126282, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 7.900000000000001, "ram_util_percent": 21.616666666666664}}
{"timers": {"training_iteration": 4.319541650687439, "restore_env_runners": 1.723313847629284e-05, "training_step": 4.319347667631674, "env_runner_sampling_timer": 1.3373542042305413, "learner_update_timer": 2.97954971758754, "synch_weights": 0.002063144811248049, "synch_env_connectors": 0.0014095832037646623, "restore_eval_env_runners": 7.652968633919954e-06, "evaluation_iteration": 2.810658568982035, "synch_eval_env_connectors": 1.1585012543946505e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.0187000000000013, "agent_0": -1.7250000000000048, "agent_2": -4.075300000000015}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.4352409434946647e-05, "add_time_dim_to_batch_and_zero_pad": 9.296842427374514e-06, "numpy_to_tensor": 4.0192439182759506e-05, "add_states_from_episodes_to_batch": 5.347643699899405e-06, "add_observations_from_episodes_to_batch": 2.2393053833773154e-05, "agent_to_module_mapping": 4.611421150626717e-06}}, "connector_pipeline_timer": 0.00015142776581067864}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6647187342908001, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.1700000000000097, "env_step_timer": 0.00037081187157143695, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2607338678195071e-06, "listify_data_for_vector_env": 9.302392303886943e-06, "module_to_agent_unmapping": 3.7351610942007616e-06, "un_batch_to_individual_items": 2.660249080395035e-05, "normalize_and_clip_actions": 3.405124135576367e-05, "tensor_to_numpy": 5.9975046742289456e-05, "get_actions": 0.0002236176983173555}}, "connector_pipeline_timer": 0.0004189033409904206}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 72000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 72000.0, "agent_1": 72000.0, "agent_0": 72000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 144.0, "agent_episode_returns_mean": {"agent_0": -1.7250000000000048, "agent_2": -4.075300000000015, "agent_1": -1.0187000000000013}, "num_agent_steps_sampled_lifetime": {"agent_2": 72000.0, "agent_1": 72000.0, "agent_0": 72000.0}, "sample": 1.3044650321446478, "rlmodule_inference_timer": 0.0001602263021132699, "weights_seq_no": 17.0, "episode_len_mean": 500.0, "episode_return_mean": -6.819000000000021, "episode_return_min": -11.95000000000004, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.0656926418290724, "num_env_steps_sampled_lifetime_throughput": 924.4169841228364}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.040324404158166176, "batch_individual_items": 0.17867186533581303, "add_one_ts_to_episodes_and_truncate": 0.006609302886420549, "add_time_dim_to_batch_and_zero_pad": 2.2014347254875177e-05, "add_columns_from_episodes_to_train_batch": 0.09421989970354999, "numpy_to_tensor": 0.00023825492544869744, "add_states_from_episodes_to_batch": 6.537209100615858e-06, "add_observations_from_episodes_to_batch": 0.00015710540982811773, "agent_to_module_mapping": 0.005286875738818578}}, "connector_pipeline_timer": 0.3259333338995929}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 2170368, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 11304000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 145627.74811753829, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27960.513780757043}, "agent_0": {"vf_explained_var": 0.8340885043144226, "entropy": 3.885291337966919, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 18.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.00790613517165184, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0038201394490897655, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.024108195677399635, "vf_loss_unclipped": 0.0038201394490897655, "num_module_steps_trained_lifetime": 723456, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.018706833943724632, "num_module_steps_trained_lifetime_throughput": 9320.159802151424}, "agent_1": {"vf_loss": 0.0018374905921518803, "mean_kl_loss": 0.009360223077237606, "total_loss": 0.019902748987078667, "vf_loss_unclipped": 0.0018374905921518803, "num_module_steps_trained_lifetime": 723456, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.016193222254514694, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.8955665826797485, "entropy": 3.909569263458252, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 18.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9320.173304817283}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.014076579362154007, "mean_kl_loss": 0.009382582269608974, "total_loss": -0.16431432962417603, "vf_loss_unclipped": 0.014076579362154007, "num_module_steps_trained_lifetime": 723456, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.18026740849018097, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.29362237453460693, "entropy": 3.8623392581939697, "num_module_steps_trained": 40192, "weights_seq_no": 18.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9320.167570694484}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "num_module_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.1284498186847622e-05, "add_time_dim_to_batch_and_zero_pad": 8.225470312111421e-06, "numpy_to_tensor": 3.4430557214362597e-05, "add_states_from_episodes_to_batch": 4.807580928724727e-06, "add_observations_from_episodes_to_batch": 2.034041741855017e-05, "agent_to_module_mapping": 4.059113350706193e-06}}, "connector_pipeline_timer": 0.0001353819419893159}, "module_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "num_agent_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "num_module_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.24749421816176, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8629012629389763e-05, "numpy_to_tensor": 7.805495988577604e-05, "add_states_from_episodes_to_batch": 1.0804971680045128e-05, "add_observations_from_episodes_to_batch": 4.7362991608679295e-05, "agent_to_module_mapping": 8.076953236013651e-06, "batch_individual_items": 5.527696339413524e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.99810732490642e-05, "remove_single_ts_time_rank_from_batch": 1.1480679088848078e-06, "normalize_and_clip_actions": 2.9882479095518916e-05, "module_to_agent_unmapping": 3.2034370820722284e-06, "un_batch_to_individual_items": 2.251953548330358e-05, "listify_data_for_vector_env": 8.453251518877286e-06, "tensor_to_numpy": 5.133163954100435e-05}}, "connector_pipeline_timer": 0.0002579602099546548}, "num_episodes_lifetime": 5, "rlmodule_inference_timer": 0.00012766114988074746, "agent_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "env_reset_timer": 0.0013283130247145891, "episode_duration_sec_mean": 0.5524188554147258, "episode_len_min": 500, "num_env_steps_sampled": 0, "num_episodes": 0, "weights_seq_no": 10.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 2500, "connector_pipeline_timer": 0.00038411503192037344, "env_to_module_sum_episodes_length_out": 404.24749421816176, "sample": 2.8012697939993814, "episode_return_mean": -3.3980000000000112, "env_step_timer": 0.0002669810995560014, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 72000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "db5f9_00000", "date": "2025-10-20_16-50-01", "timestamp": 1760971801, "time_this_iter_s": 4.3887245655059814, "time_total_s": 78.5948224067688, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f705529240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 78.5948224067688, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 9.3, "ram_util_percent": 21.8}}
{"timers": {"training_iteration": 4.318077936740193, "restore_env_runners": 1.71473275407883e-05, "training_step": 4.317883630635706, "env_runner_sampling_timer": 1.3380261057178484, "learner_update_timer": 2.9774163504418856, "synch_weights": 0.002058772552714273, "synch_env_connectors": 0.0014152738617380445, "restore_eval_env_runners": 7.652968633919954e-06, "evaluation_iteration": 2.810658568982035, "synch_eval_env_connectors": 1.1585012543946505e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.2208000000000032, "agent_0": -1.6879000000000042, "agent_2": -3.835600000000012}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.5577403124675093e-05, "add_time_dim_to_batch_and_zero_pad": 9.776837021015901e-06, "numpy_to_tensor": 4.205807471338451e-05, "add_states_from_episodes_to_batch": 5.5821062729408175e-06, "add_observations_from_episodes_to_batch": 2.3631577682983776e-05, "agent_to_module_mapping": 4.831080389635649e-06}}, "connector_pipeline_timer": 0.0001585433173300508}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6665330834611086, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.1700000000000097, "env_step_timer": 0.00037697798967817916, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1934636635019734e-06, "listify_data_for_vector_env": 9.705960883653408e-06, "module_to_agent_unmapping": 3.9328294499031475e-06, "un_batch_to_individual_items": 2.728091369282829e-05, "normalize_and_clip_actions": 3.512303031003918e-05, "tensor_to_numpy": 6.239555378731135e-05, "get_actions": 0.00023510763490114075}}, "connector_pipeline_timer": 0.0004371166037179466}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 76000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 76000.0, "agent_1": 76000.0, "agent_0": 76000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 152.0, "agent_episode_returns_mean": {"agent_0": -1.6879000000000042, "agent_2": -3.835600000000012, "agent_1": -1.2208000000000032}, "num_agent_steps_sampled_lifetime": {"agent_2": 76000.0, "agent_1": 76000.0, "agent_0": 76000.0}, "sample": 1.3050794291783783, "rlmodule_inference_timer": 0.00017360033623799946, "weights_seq_no": 18.0, "episode_len_mean": 500.0, "episode_return_mean": -6.74430000000002, "episode_return_min": -11.480000000000034, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.0651129668332624, "num_env_steps_sampled_lifetime_throughput": 924.0800161296393}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04033918038688368, "batch_individual_items": 0.1775255844722983, "add_one_ts_to_episodes_and_truncate": 0.006598682987752676, "add_time_dim_to_batch_and_zero_pad": 2.2108014087996326e-05, "add_columns_from_episodes_to_train_batch": 0.09423377935671151, "numpy_to_tensor": 0.00023775667575745446, "add_states_from_episodes_to_batch": 6.549546565235614e-06, "add_observations_from_episodes_to_batch": 0.00015685615566654089, "agent_to_module_mapping": 0.005286597071629766}}, "connector_pipeline_timer": 0.3248023266909294}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 2290944, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 11932000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 145840.90178408238, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 28001.440525066973}, "agent_0": {"vf_explained_var": 0.6713396310806274, "entropy": 3.8802099227905273, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 19.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.009788165800273418, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0019148711580783129, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.037953320890665054, "vf_loss_unclipped": 0.0019148711580783129, "num_module_steps_trained_lifetime": 763648, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.041825827211141586, "num_module_steps_trained_lifetime_throughput": 9333.801784004296}, "agent_1": {"vf_loss": 0.0007764379843138158, "mean_kl_loss": 0.010837309993803501, "total_loss": 0.01859409175813198, "vf_loss_unclipped": 0.0007764379843138158, "num_module_steps_trained_lifetime": 763648, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.01565018855035305, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.9065437316894531, "entropy": 3.910897970199585, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 19.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9333.81523695158}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0095750717446208, "mean_kl_loss": 0.009218134917318821, "total_loss": -0.03793717175722122, "vf_loss_unclipped": 0.0095750717446208, "num_module_steps_trained_lifetime": 763648, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.049355875700712204, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.1727389693260193, "entropy": 3.8546221256256104, "num_module_steps_trained": 40192, "weights_seq_no": 19.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9333.809674025026}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "num_module_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.1284498186847622e-05, "add_time_dim_to_batch_and_zero_pad": 8.225470312111421e-06, "numpy_to_tensor": 3.4430557214362597e-05, "add_states_from_episodes_to_batch": 4.807580928724727e-06, "add_observations_from_episodes_to_batch": 2.034041741855017e-05, "agent_to_module_mapping": 4.059113350706193e-06}}, "connector_pipeline_timer": 0.0001353819419893159}, "module_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "num_agent_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "num_module_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.24749421816176, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8629012629389763e-05, "numpy_to_tensor": 7.805495988577604e-05, "add_states_from_episodes_to_batch": 1.0804971680045128e-05, "add_observations_from_episodes_to_batch": 4.7362991608679295e-05, "agent_to_module_mapping": 8.076953236013651e-06, "batch_individual_items": 5.527696339413524e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.99810732490642e-05, "remove_single_ts_time_rank_from_batch": 1.1480679088848078e-06, "normalize_and_clip_actions": 2.9882479095518916e-05, "module_to_agent_unmapping": 3.2034370820722284e-06, "un_batch_to_individual_items": 2.251953548330358e-05, "listify_data_for_vector_env": 8.453251518877286e-06, "tensor_to_numpy": 5.133163954100435e-05}}, "connector_pipeline_timer": 0.0002579602099546548}, "num_episodes_lifetime": 5, "rlmodule_inference_timer": 0.00012766114988074746, "agent_episode_returns_mean": {"agent_1": -1.4320000000000053, "agent_2": -0.5000000000000003, "agent_0": -1.4660000000000057}, "env_reset_timer": 0.0013283130247145891, "episode_duration_sec_mean": 0.5524188554147258, "episode_len_min": 500, "num_env_steps_sampled": 0, "num_episodes": 0, "weights_seq_no": 10.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 2500, "connector_pipeline_timer": 0.00038411503192037344, "env_to_module_sum_episodes_length_out": 404.24749421816176, "sample": 2.8012697939993814, "episode_return_mean": -3.3980000000000112, "env_step_timer": 0.0002669810995560014, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 76000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "db5f9_00000", "date": "2025-10-20_16-50-05", "timestamp": 1760971805, "time_this_iter_s": 4.177896738052368, "time_total_s": 82.77271914482117, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f7055637f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 82.77271914482117, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 8.783333333333333, "ram_util_percent": 21.78333333333333}}
{"timers": {"training_iteration": 4.318090263922815, "restore_env_runners": 1.7078084380242737e-05, "training_step": 4.317895472819558, "env_runner_sampling_timer": 1.3395812118408208, "learner_update_timer": 2.975872989257643, "synch_weights": 0.002058455656741778, "synch_env_connectors": 0.001416900033140099, "restore_eval_env_runners": 7.652968633919954e-06, "evaluation_iteration": 2.810658568982035, "synch_eval_env_connectors": 1.1585012543946505e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.197200000000002, "agent_0": -1.8904000000000045, "agent_2": -3.8216000000000117}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.596673100348587e-05, "add_time_dim_to_batch_and_zero_pad": 9.904924605002918e-06, "numpy_to_tensor": 4.299973714441328e-05, "add_states_from_episodes_to_batch": 5.741326349654704e-06, "add_observations_from_episodes_to_batch": 2.402825345454671e-05, "agent_to_module_mapping": 4.88891438641596e-06}}, "connector_pipeline_timer": 0.00016201189502423787}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6912332660635002, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.4199999999999973, "env_step_timer": 0.00040154309489846856, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2146565555139396e-06, "listify_data_for_vector_env": 9.953037330788008e-06, "module_to_agent_unmapping": 3.973714146199978e-06, "un_batch_to_individual_items": 2.8009448965836712e-05, "normalize_and_clip_actions": 3.615538252634652e-05, "tensor_to_numpy": 6.41416517806206e-05, "get_actions": 0.00024010732753089432}}, "connector_pipeline_timer": 0.0004478439168797611}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 80000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 80000.0, "agent_1": 80000.0, "agent_0": 80000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 160.0, "agent_episode_returns_mean": {"agent_0": -1.8904000000000045, "agent_2": -3.8216000000000117, "agent_1": -1.197200000000002}, "num_agent_steps_sampled_lifetime": {"agent_2": 80000.0, "agent_1": 80000.0, "agent_0": 80000.0}, "sample": 1.3065819823691733, "rlmodule_inference_timer": 0.00016892104460423756, "weights_seq_no": 19.0, "episode_len_mean": 500.0, "episode_return_mean": -6.909200000000018, "episode_return_min": -11.480000000000034, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.0627028668650778, "num_env_steps_sampled_lifetime_throughput": 924.6157546688364}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.040322028673025534, "batch_individual_items": 0.17759231788727653, "add_one_ts_to_episodes_and_truncate": 0.00658996738790968, "add_time_dim_to_batch_and_zero_pad": 2.2077163567900885e-05, "add_columns_from_episodes_to_train_batch": 0.09424256758308044, "numpy_to_tensor": 0.00023726272927972105, "add_states_from_episodes_to_batch": 6.543751204922546e-06, "add_observations_from_episodes_to_batch": 0.00015669650413944325, "agent_to_module_mapping": 0.005284922820744436}}, "connector_pipeline_timer": 0.32484729761414394}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 2411520, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 12560000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 145790.70341477593, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27991.80305718109}, "agent_0": {"vf_explained_var": 0.823708176612854, "entropy": 3.848543405532837, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 20.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.008106697350740433, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.003560891142114997, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.016624487936496735, "vf_loss_unclipped": 0.003560891142114997, "num_module_steps_trained_lifetime": 803840, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.011442254297435284, "num_module_steps_trained_lifetime_throughput": 9330.590078144985}, "agent_1": {"vf_loss": 0.003929253667593002, "mean_kl_loss": 0.007538679055869579, "total_loss": 0.0016984122339636087, "vf_loss_unclipped": 0.003929253667593002, "num_module_steps_trained_lifetime": 803840, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.003738576779142022, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.6995652914047241, "entropy": 3.883896827697754, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 20.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9330.602862290096}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.009220986627042294, "mean_kl_loss": 0.007597446441650391, "total_loss": 0.053804975003004074, "vf_loss_unclipped": 0.009220986627042294, "num_module_steps_trained_lifetime": 803840, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.04306451231241226, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.27406013011932373, "entropy": 3.8626019954681396, "num_module_steps_trained": 40192, "weights_seq_no": 20.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9330.597558483018}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "num_module_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.192683436256663e-05, "add_time_dim_to_batch_and_zero_pad": 8.576404824444705e-06, "numpy_to_tensor": 3.5909622116088447e-05, "add_states_from_episodes_to_batch": 4.9172866531385315e-06, "add_observations_from_episodes_to_batch": 2.10062597716786e-05, "agent_to_module_mapping": 4.176461825394511e-06}}, "connector_pipeline_timer": 0.00013895353547876144}, "module_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "num_agent_steps_sampled": {"agent_2": 2500, "agent_0": 2500, "agent_1": 2500}, "num_module_steps_sampled": {"agent_2": 2500, "agent_0": 2500, "agent_1": 2500}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.2474942228695, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.856622227933258e-05, "numpy_to_tensor": 7.76499102357775e-05, "add_states_from_episodes_to_batch": 1.0750112123787402e-05, "add_observations_from_episodes_to_batch": 4.718294192571193e-05, "agent_to_module_mapping": 8.046613656915724e-06, "batch_individual_items": 5.4977964027784764e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 9.498780508010061e-05, "remove_single_ts_time_rank_from_batch": 1.1597280347239427e-06, "normalize_and_clip_actions": 3.0012026371648267e-05, "module_to_agent_unmapping": 3.356680177575688e-06, "un_batch_to_individual_items": 2.299795057347504e-05, "listify_data_for_vector_env": 8.447076206904692e-06, "tensor_to_numpy": 5.245771292316555e-05}}, "connector_pipeline_timer": 0.00026571240913557463}, "num_episodes_lifetime": 10, "rlmodule_inference_timer": 0.00013354389908662442, "agent_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "env_reset_timer": 0.001320616334560327, "episode_duration_sec_mean": 0.5497617469052785, "episode_len_min": 500, "num_env_steps_sampled": 2500, "num_episodes": 5, "weights_seq_no": 20.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 5000, "connector_pipeline_timer": 0.00038193490181583913, "env_to_module_sum_episodes_length_out": 404.2474942228695, "sample": 2.800987857359578, "episode_return_mean": -3.3140000000000085, "env_step_timer": 0.0004139794357858142, "time_between_sampling": 42.713733303011395}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 80000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 20, "trial_id": "db5f9_00000", "date": "2025-10-20_16-50-12", "timestamp": 1760971812, "time_this_iter_s": 7.105443239212036, "time_total_s": 89.8781623840332, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f7055d7010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 89.8781623840332, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 6.389999999999999, "ram_util_percent": 21.279999999999998}}
{"timers": {"training_iteration": 4.316903934093951, "restore_env_runners": 1.703872362909752e-05, "training_step": 4.3167083824812185, "env_runner_sampling_timer": 1.3399598985626247, "learner_update_timer": 2.9743085607152255, "synch_weights": 0.0020565130401431625, "synch_env_connectors": 0.0014262100125191875, "restore_eval_env_runners": 7.657699170522391e-06, "evaluation_iteration": 2.8103607055020983, "synch_eval_env_connectors": 1.1546482564881444e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.026300000000002, "agent_0": -1.3697000000000024, "agent_2": -3.8009000000000115}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.531176300369442e-05, "add_time_dim_to_batch_and_zero_pad": 9.618444939814656e-06, "numpy_to_tensor": 4.194316756428336e-05, "add_states_from_episodes_to_batch": 5.559786648993542e-06, "add_observations_from_episodes_to_batch": 2.3409900604414204e-05, "agent_to_module_mapping": 4.814705705174046e-06}}, "connector_pipeline_timer": 0.00015792870108971352}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6851792256132466, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.4199999999999973, "env_step_timer": 0.0003765865998745005, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1712162403498677e-06, "listify_data_for_vector_env": 9.820831964754864e-06, "module_to_agent_unmapping": 3.903592401366564e-06, "un_batch_to_individual_items": 2.7242823331894755e-05, "normalize_and_clip_actions": 3.525588620517026e-05, "tensor_to_numpy": 6.246524052233823e-05, "get_actions": 0.0002320317917752709}}, "connector_pipeline_timer": 0.00043447308881847905}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 84000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 84000.0, "agent_1": 84000.0, "agent_0": 84000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 168.0, "agent_episode_returns_mean": {"agent_0": -1.3697000000000024, "agent_2": -3.8009000000000115, "agent_1": -1.026300000000002}, "num_agent_steps_sampled_lifetime": {"agent_2": 84000.0, "agent_1": 84000.0, "agent_0": 84000.0}, "sample": 1.3069498978129444, "rlmodule_inference_timer": 0.00016278900332663835, "weights_seq_no": 20.0, "episode_len_mean": 500.0, "episode_return_mean": -6.196900000000015, "episode_return_min": -10.410000000000021, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.0889707171041962, "num_env_steps_sampled_lifetime_throughput": 906.8404481406391}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.0402995385862721, "batch_individual_items": 0.1764554220585203, "add_one_ts_to_episodes_and_truncate": 0.006581065354088981, "add_time_dim_to_batch_and_zero_pad": 2.2050582002254947e-05, "add_columns_from_episodes_to_train_batch": 0.09421252878762229, "numpy_to_tensor": 0.00023674486174433084, "add_states_from_episodes_to_batch": 6.53577396742066e-06, "add_observations_from_episodes_to_batch": 0.00015646545963121414, "agent_to_module_mapping": 0.005283093262745908}}, "connector_pipeline_timer": 0.32364390263793985}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 2532096, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 13188000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 142971.00164652275, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27450.421332110323}, "agent_0": {"vf_explained_var": 0.7741649150848389, "entropy": 3.824556350708008, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 21.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.009499123319983482, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0031488158274441957, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.021102698519825935, "vf_loss_unclipped": 0.0031488158274441957, "num_module_steps_trained_lifetime": 844032, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.02615133486688137, "num_module_steps_trained_lifetime_throughput": 9150.129862070064}, "agent_1": {"vf_loss": 0.0012831115163862705, "mean_kl_loss": 0.01014039758592844, "total_loss": -0.1121177226305008, "vf_loss_unclipped": 0.0012831115163862705, "num_module_steps_trained_lifetime": 844032, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.11542892456054688, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.795333981513977, "entropy": 3.8842813968658447, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 21.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9150.142146320733}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.005438283551484346, "mean_kl_loss": 0.009273839183151722, "total_loss": 0.11302905529737473, "vf_loss_unclipped": 0.005438283551484346, "num_module_steps_trained_lifetime": 844032, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.10573600977659225, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.5319036841392517, "entropy": 3.834418773651123, "num_module_steps_trained": 40192, "weights_seq_no": 21.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9150.137124561976}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "num_module_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.192683436256663e-05, "add_time_dim_to_batch_and_zero_pad": 8.576404824444705e-06, "numpy_to_tensor": 3.5909622116088447e-05, "add_states_from_episodes_to_batch": 4.9172866531385315e-06, "add_observations_from_episodes_to_batch": 2.10062597716786e-05, "agent_to_module_mapping": 4.176461825394511e-06}}, "connector_pipeline_timer": 0.00013895353547876144}, "module_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "num_agent_steps_sampled": {"agent_2": 2500, "agent_0": 2500, "agent_1": 2500}, "num_module_steps_sampled": {"agent_2": 2500, "agent_0": 2500, "agent_1": 2500}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.2474942228695, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.856622227933258e-05, "numpy_to_tensor": 7.76499102357775e-05, "add_states_from_episodes_to_batch": 1.0750112123787402e-05, "add_observations_from_episodes_to_batch": 4.718294192571193e-05, "agent_to_module_mapping": 8.046613656915724e-06, "batch_individual_items": 5.4977964027784764e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 9.498780508010061e-05, "remove_single_ts_time_rank_from_batch": 1.1597280347239427e-06, "normalize_and_clip_actions": 3.0012026371648267e-05, "module_to_agent_unmapping": 3.356680177575688e-06, "un_batch_to_individual_items": 2.299795057347504e-05, "listify_data_for_vector_env": 8.447076206904692e-06, "tensor_to_numpy": 5.245771292316555e-05}}, "connector_pipeline_timer": 0.00026571240913557463}, "num_episodes_lifetime": 10, "rlmodule_inference_timer": 0.00013354389908662442, "agent_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "env_reset_timer": 0.001320616334560327, "episode_duration_sec_mean": 0.5497617469052785, "episode_len_min": 500, "num_env_steps_sampled": 2500, "num_episodes": 5, "weights_seq_no": 20.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 5000, "connector_pipeline_timer": 0.00038193490181583913, "env_to_module_sum_episodes_length_out": 404.2474942228695, "sample": 2.800987857359578, "episode_return_mean": -3.3140000000000085, "env_step_timer": 0.0004139794357858142, "time_between_sampling": 42.713733303011395, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 84000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 21, "trial_id": "db5f9_00000", "date": "2025-10-20_16-50-17", "timestamp": 1760971817, "time_this_iter_s": 4.203965187072754, "time_total_s": 94.08212757110596, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f7056a60e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 94.08212757110596, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 7.916666666666667, "ram_util_percent": 21.150000000000002}}
{"timers": {"training_iteration": 4.316810522913161, "restore_env_runners": 1.6975396579371467e-05, "training_step": 4.316614238766403, "env_runner_sampling_timer": 1.3412502335670105, "learner_update_timer": 2.9729232537379433, "synch_weights": 0.002055575619731167, "synch_env_connectors": 0.001427637572606952, "restore_eval_env_runners": 7.657699170522391e-06, "evaluation_iteration": 2.8103607055020983, "synch_eval_env_connectors": 1.1546482564881444e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -0.9723000000000015, "agent_0": -1.0831000000000013, "agent_2": -3.964900000000013}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.4593014746858675e-05, "add_time_dim_to_batch_and_zero_pad": 9.359095715831958e-06, "numpy_to_tensor": 4.073557628832146e-05, "add_states_from_episodes_to_batch": 5.439543949892016e-06, "add_observations_from_episodes_to_batch": 2.25407398447101e-05, "agent_to_module_mapping": 4.648394444977553e-06}}, "connector_pipeline_timer": 0.00015306484917914}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6988727553549688, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.359999999999996, "env_step_timer": 0.00036991642742913346, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1444858706460697e-06, "listify_data_for_vector_env": 9.458579194146254e-06, "module_to_agent_unmapping": 3.860317077756843e-06, "un_batch_to_individual_items": 2.6455889370362414e-05, "normalize_and_clip_actions": 3.416241033641041e-05, "tensor_to_numpy": 6.092106262059924e-05, "get_actions": 0.00022664019518868345}}, "connector_pipeline_timer": 0.0004234150828007084}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 88000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 88000.0, "agent_1": 88000.0, "agent_0": 88000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 176.0, "agent_episode_returns_mean": {"agent_0": -1.0831000000000013, "agent_2": -3.964900000000013, "agent_1": -0.9723000000000015}, "num_agent_steps_sampled_lifetime": {"agent_2": 88000.0, "agent_1": 88000.0, "agent_0": 88000.0}, "sample": 1.3083274218922512, "rlmodule_inference_timer": 0.00015987636994258973, "weights_seq_no": 21.0, "episode_len_mean": 500.0, "episode_return_mean": -6.020300000000017, "episode_return_min": -10.890000000000052, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.0867976862706534, "num_env_steps_sampled_lifetime_throughput": 907.9359114751006}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04029041066048888, "batch_individual_items": 0.17655746259814814, "add_one_ts_to_episodes_and_truncate": 0.006573142790343688, "add_time_dim_to_batch_and_zero_pad": 2.2003176452563304e-05, "add_columns_from_episodes_to_train_batch": 0.09419756947984763, "numpy_to_tensor": 0.00023628476350592983, "add_states_from_episodes_to_batch": 6.5307659305815365e-06, "add_observations_from_episodes_to_batch": 0.00015623885480430354, "agent_to_module_mapping": 0.005280852169929886}}, "connector_pipeline_timer": 0.323708658561451}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 2652672, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 13816000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 143085.61981110438, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27472.42878921038}, "agent_0": {"vf_explained_var": 0.8265906572341919, "entropy": 3.8122828006744385, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 22.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.007821587845683098, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.00042910821503028274, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.1302921622991562, "vf_loss_unclipped": 0.00042910821503028274, "num_module_steps_trained_lifetime": 884224, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.12829872965812683, "num_module_steps_trained_lifetime_throughput": 9157.464364680505}, "agent_1": {"vf_loss": 0.001465030713006854, "mean_kl_loss": 0.011112501844763756, "total_loss": -0.08012573421001434, "vf_loss_unclipped": 0.001465030713006854, "num_module_steps_trained_lifetime": 884224, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.08381327986717224, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.8242674469947815, "entropy": 3.8524553775787354, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 22.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9157.478088622764}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.007245644461363554, "mean_kl_loss": 0.009065639227628708, "total_loss": -0.0011220730375498533, "vf_loss_unclipped": 0.007245644461363554, "num_module_steps_trained_lifetime": 884224, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.010180842131376266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.35026824474334717, "entropy": 3.818861961364746, "num_module_steps_trained": 40192, "weights_seq_no": 22.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9157.473323972801}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "num_module_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.192683436256663e-05, "add_time_dim_to_batch_and_zero_pad": 8.576404824444705e-06, "numpy_to_tensor": 3.5909622116088447e-05, "add_states_from_episodes_to_batch": 4.9172866531385315e-06, "add_observations_from_episodes_to_batch": 2.10062597716786e-05, "agent_to_module_mapping": 4.176461825394511e-06}}, "connector_pipeline_timer": 0.00013895353547876144}, "module_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "num_agent_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "num_module_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.2474942228695, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.856622227933258e-05, "numpy_to_tensor": 7.76499102357775e-05, "add_states_from_episodes_to_batch": 1.0750112123787402e-05, "add_observations_from_episodes_to_batch": 4.718294192571193e-05, "agent_to_module_mapping": 8.046613656915724e-06, "batch_individual_items": 5.4977964027784764e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 9.498780508010061e-05, "remove_single_ts_time_rank_from_batch": 1.1597280347239427e-06, "normalize_and_clip_actions": 3.0012026371648267e-05, "module_to_agent_unmapping": 3.356680177575688e-06, "un_batch_to_individual_items": 2.299795057347504e-05, "listify_data_for_vector_env": 8.447076206904692e-06, "tensor_to_numpy": 5.245771292316555e-05}}, "connector_pipeline_timer": 0.00026571240913557463}, "num_episodes_lifetime": 10, "rlmodule_inference_timer": 0.00013354389908662442, "agent_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "env_reset_timer": 0.001320616334560327, "episode_duration_sec_mean": 0.5497617469052785, "episode_len_min": 500, "num_env_steps_sampled": 0, "num_episodes": 0, "weights_seq_no": 20.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 5000, "connector_pipeline_timer": 0.00038193490181583913, "env_to_module_sum_episodes_length_out": 404.2474942228695, "sample": 2.800987857359578, "episode_return_mean": -3.3140000000000085, "env_step_timer": 0.0004139794357858142, "time_between_sampling": 42.713733303011395, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 88000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 22, "trial_id": "db5f9_00000", "date": "2025-10-20_16-50-21", "timestamp": 1760971821, "time_this_iter_s": 4.3119730949401855, "time_total_s": 98.39410066604614, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f70558b760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 98.39410066604614, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 7.8999999999999995, "ram_util_percent": 21.633333333333336}}
{"timers": {"training_iteration": 4.314547548174457, "restore_env_runners": 1.6917712733517497e-05, "training_step": 4.314350765878949, "env_runner_sampling_timer": 1.341652210441172, "learner_update_timer": 2.9702599682103967, "synch_weights": 0.0020530118433731356, "synch_env_connectors": 0.0014279626666192913, "restore_eval_env_runners": 7.657699170522391e-06, "evaluation_iteration": 2.8103607055020983, "synch_eval_env_connectors": 1.1546482564881444e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.0449000000000022, "agent_0": -0.7697000000000003, "agent_2": -3.811800000000011}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.5130969215799667e-05, "add_time_dim_to_batch_and_zero_pad": 9.58731321636549e-06, "numpy_to_tensor": 4.1457562512944745e-05, "add_states_from_episodes_to_batch": 5.523797785016633e-06, "add_observations_from_episodes_to_batch": 2.3197909731154983e-05, "agent_to_module_mapping": 4.768096483077328e-06}}, "connector_pipeline_timer": 0.0001565146531512487}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6836027145857224, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.2900000000000054, "env_step_timer": 0.0003810222225185066, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1801075961819333e-06, "listify_data_for_vector_env": 9.681226173102813e-06, "module_to_agent_unmapping": 3.900715314697362e-06, "un_batch_to_individual_items": 2.704325279093971e-05, "normalize_and_clip_actions": 3.508889393705668e-05, "tensor_to_numpy": 6.208451118483529e-05, "get_actions": 0.00023054389733538058}}, "connector_pipeline_timer": 0.0004314939441629902}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 92000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 92000.0, "agent_1": 92000.0, "agent_0": 92000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 184.0, "agent_episode_returns_mean": {"agent_0": -0.7697000000000003, "agent_2": -3.811800000000011, "agent_1": -1.0449000000000022}, "num_agent_steps_sampled_lifetime": {"agent_2": 92000.0, "agent_1": 92000.0, "agent_0": 92000.0}, "sample": 1.3087398919334736, "rlmodule_inference_timer": 0.0001626724829115293, "weights_seq_no": 22.0, "episode_len_mean": 500.0, "episode_return_mean": -5.626400000000014, "episode_return_min": -10.890000000000052, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.084721582265784, "num_env_steps_sampled_lifetime_throughput": 909.7503743753193}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04026572278419449, "batch_individual_items": 0.17542278476211978, "add_one_ts_to_episodes_and_truncate": 0.006564403762645014, "add_time_dim_to_batch_and_zero_pad": 2.1958344508697725e-05, "add_columns_from_episodes_to_train_batch": 0.0941663894652964, "numpy_to_tensor": 0.00023567610559590446, "add_states_from_episodes_to_batch": 6.5227078340905526e-06, "add_observations_from_episodes_to_batch": 0.00015601236641674452, "agent_to_module_mapping": 0.005279007547933352}}, "connector_pipeline_timer": 0.3225041818360164}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 2773248, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 14444000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 143576.5837931448, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27566.69217793619}, "agent_0": {"vf_explained_var": 0.8657086491584778, "entropy": 3.7946243286132812, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 23.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.009724254719913006, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0009344868012703955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.036505360156297684, "vf_loss_unclipped": 0.0009344868012703955, "num_module_steps_trained_lifetime": 924416, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.03938470780849457, "num_module_steps_trained_lifetime_throughput": 9188.889746223134}, "agent_1": {"vf_loss": 0.0056006028316915035, "mean_kl_loss": 0.008342991583049297, "total_loss": -0.08455315977334976, "vf_loss_unclipped": 0.0056006028316915035, "num_module_steps_trained_lifetime": 924416, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.09182234108448029, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.7278618812561035, "entropy": 3.8671135902404785, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 23.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9188.89879525285}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.008477956987917423, "mean_kl_loss": 0.008331451565027237, "total_loss": 0.08705325424671173, "vf_loss_unclipped": 0.008477956987917423, "num_module_steps_trained_lifetime": 924416, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.07690901309251785, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.42602890729904175, "entropy": 3.8053784370422363, "num_module_steps_trained": 40192, "weights_seq_no": 23.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9188.894369384785}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "num_module_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.192683436256663e-05, "add_time_dim_to_batch_and_zero_pad": 8.576404824444705e-06, "numpy_to_tensor": 3.5909622116088447e-05, "add_states_from_episodes_to_batch": 4.9172866531385315e-06, "add_observations_from_episodes_to_batch": 2.10062597716786e-05, "agent_to_module_mapping": 4.176461825394511e-06}}, "connector_pipeline_timer": 0.00013895353547876144}, "module_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "num_agent_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "num_module_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.2474942228695, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.856622227933258e-05, "numpy_to_tensor": 7.76499102357775e-05, "add_states_from_episodes_to_batch": 1.0750112123787402e-05, "add_observations_from_episodes_to_batch": 4.718294192571193e-05, "agent_to_module_mapping": 8.046613656915724e-06, "batch_individual_items": 5.4977964027784764e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 9.498780508010061e-05, "remove_single_ts_time_rank_from_batch": 1.1597280347239427e-06, "normalize_and_clip_actions": 3.0012026371648267e-05, "module_to_agent_unmapping": 3.356680177575688e-06, "un_batch_to_individual_items": 2.299795057347504e-05, "listify_data_for_vector_env": 8.447076206904692e-06, "tensor_to_numpy": 5.245771292316555e-05}}, "connector_pipeline_timer": 0.00026571240913557463}, "num_episodes_lifetime": 10, "rlmodule_inference_timer": 0.00013354389908662442, "agent_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "env_reset_timer": 0.001320616334560327, "episode_duration_sec_mean": 0.5497617469052785, "episode_len_min": 500, "num_env_steps_sampled": 0, "num_episodes": 0, "weights_seq_no": 20.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 5000, "connector_pipeline_timer": 0.00038193490181583913, "env_to_module_sum_episodes_length_out": 404.2474942228695, "sample": 2.800987857359578, "episode_return_mean": -3.3140000000000085, "env_step_timer": 0.0004139794357858142, "time_between_sampling": 42.713733303011395, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 92000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 23, "trial_id": "db5f9_00000", "date": "2025-10-20_16-50-25", "timestamp": 1760971825, "time_this_iter_s": 4.095137596130371, "time_total_s": 102.48923826217651, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f7055292d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 102.48923826217651, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 6.95, "ram_util_percent": 21.700000000000003}}
{"timers": {"training_iteration": 4.314976085062794, "restore_env_runners": 1.6846235418795746e-05, "training_step": 4.314778736590155, "env_runner_sampling_timer": 1.3426636428965568, "learner_update_timer": 2.9696749032279097, "synch_weights": 0.002053435155151507, "synch_env_connectors": 0.0014301994800354398, "restore_eval_env_runners": 7.657699170522391e-06, "evaluation_iteration": 2.8103607055020983, "synch_eval_env_connectors": 1.1546482564881444e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.068800000000002, "agent_0": -0.7181000000000006, "agent_2": -3.69060000000001}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.57671412362668e-05, "add_time_dim_to_batch_and_zero_pad": 9.814528051121868e-06, "numpy_to_tensor": 4.260140671564029e-05, "add_states_from_episodes_to_batch": 5.679590143559858e-06, "add_observations_from_episodes_to_batch": 2.3980753558068136e-05, "agent_to_module_mapping": 4.9269479838280224e-06}}, "connector_pipeline_timer": 0.0001609446541726179}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6928925233456539, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.2900000000000054, "env_step_timer": 0.00037960809603621915, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2101963844970545e-06, "listify_data_for_vector_env": 9.983511794421463e-06, "module_to_agent_unmapping": 3.98361749940316e-06, "un_batch_to_individual_items": 2.7840301548525477e-05, "normalize_and_clip_actions": 3.613077530975868e-05, "tensor_to_numpy": 6.383262065757112e-05, "get_actions": 0.00023813042647465287}}, "connector_pipeline_timer": 0.00044496701677399484}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 96000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 96000.0, "agent_1": 96000.0, "agent_0": 96000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 192.0, "agent_episode_returns_mean": {"agent_0": -0.7181000000000006, "agent_2": -3.69060000000001, "agent_1": -1.068800000000002}, "num_agent_steps_sampled_lifetime": {"agent_2": 96000.0, "agent_1": 96000.0, "agent_0": 96000.0}, "sample": 1.3097875399818517, "rlmodule_inference_timer": 0.00016666570652278258, "weights_seq_no": 23.0, "episode_len_mean": 500.0, "episode_return_mean": -5.477500000000013, "episode_return_min": -10.890000000000052, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.081441282345551, "num_env_steps_sampled_lifetime_throughput": 912.2520163415127}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.040259597816117626, "batch_individual_items": 0.1756452379943305, "add_one_ts_to_episodes_and_truncate": 0.006557963594914573, "add_time_dim_to_batch_and_zero_pad": 2.193375148898138e-05, "add_columns_from_episodes_to_train_batch": 0.09417203583102406, "numpy_to_tensor": 0.0002353883544735661, "add_states_from_episodes_to_batch": 6.55336099688292e-06, "add_observations_from_episodes_to_batch": 0.00015591534295030207, "agent_to_module_mapping": 0.0052778169421883745}}, "connector_pipeline_timer": 0.32271602472717376}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 2893824, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 15072000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 143578.5368518043, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27567.069491983144}, "agent_0": {"vf_explained_var": 0.7787667512893677, "entropy": 3.8076493740081787, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 24.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.006984078790992498, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.002656714990735054, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.059446755796670914, "vf_loss_unclipped": 0.002656714990735054, "num_module_steps_trained_lifetime": 964608, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.055393218994140625, "num_module_steps_trained_lifetime_throughput": 9189.014178816218}, "agent_1": {"vf_loss": 0.0018566169310361147, "mean_kl_loss": 0.008953786455094814, "total_loss": -0.08914957195520401, "vf_loss_unclipped": 0.0018566169310361147, "num_module_steps_trained_lifetime": 964608, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.0927969291806221, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.7351353764533997, "entropy": 3.8519206047058105, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 24.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9189.024596315454}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.00774226663634181, "mean_kl_loss": 0.008410452865064144, "total_loss": 0.019679542630910873, "vf_loss_unclipped": 0.00774226663634181, "num_module_steps_trained_lifetime": 964608, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.01025518961250782, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.21035051345825195, "entropy": 3.8013579845428467, "num_module_steps_trained": 40192, "weights_seq_no": 24.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9189.02121339836}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "num_module_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.192683436256663e-05, "add_time_dim_to_batch_and_zero_pad": 8.576404824444705e-06, "numpy_to_tensor": 3.5909622116088447e-05, "add_states_from_episodes_to_batch": 4.9172866531385315e-06, "add_observations_from_episodes_to_batch": 2.10062597716786e-05, "agent_to_module_mapping": 4.176461825394511e-06}}, "connector_pipeline_timer": 0.00013895353547876144}, "module_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "num_agent_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "num_module_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.2474942228695, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.856622227933258e-05, "numpy_to_tensor": 7.76499102357775e-05, "add_states_from_episodes_to_batch": 1.0750112123787402e-05, "add_observations_from_episodes_to_batch": 4.718294192571193e-05, "agent_to_module_mapping": 8.046613656915724e-06, "batch_individual_items": 5.4977964027784764e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 9.498780508010061e-05, "remove_single_ts_time_rank_from_batch": 1.1597280347239427e-06, "normalize_and_clip_actions": 3.0012026371648267e-05, "module_to_agent_unmapping": 3.356680177575688e-06, "un_batch_to_individual_items": 2.299795057347504e-05, "listify_data_for_vector_env": 8.447076206904692e-06, "tensor_to_numpy": 5.245771292316555e-05}}, "connector_pipeline_timer": 0.00026571240913557463}, "num_episodes_lifetime": 10, "rlmodule_inference_timer": 0.00013354389908662442, "agent_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "env_reset_timer": 0.001320616334560327, "episode_duration_sec_mean": 0.5497617469052785, "episode_len_min": 500, "num_env_steps_sampled": 0, "num_episodes": 0, "weights_seq_no": 20.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 5000, "connector_pipeline_timer": 0.00038193490181583913, "env_to_module_sum_episodes_length_out": 404.2474942228695, "sample": 2.800987857359578, "episode_return_mean": -3.3140000000000085, "env_step_timer": 0.0004139794357858142, "time_between_sampling": 42.713733303011395, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 96000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 24, "trial_id": "db5f9_00000", "date": "2025-10-20_16-50-29", "timestamp": 1760971829, "time_this_iter_s": 4.361973285675049, "time_total_s": 106.85121154785156, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f705529a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 106.85121154785156, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 7.466666666666666, "ram_util_percent": 21.599999999999998}}
{"timers": {"training_iteration": 4.313792661831981, "restore_env_runners": 1.6770912889065255e-05, "training_step": 4.313594945084095, "env_runner_sampling_timer": 1.3438835883475244, "learner_update_timer": 2.9672702673554134, "synch_weights": 0.002053493033739292, "synch_env_connectors": 0.0014303307255202286, "restore_eval_env_runners": 7.657699170522391e-06, "evaluation_iteration": 2.8103607055020983, "synch_eval_env_connectors": 1.1546482564881444e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.0339000000000016, "agent_0": -0.862400000000001, "agent_2": -3.61600000000001}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.553457610349674e-05, "add_time_dim_to_batch_and_zero_pad": 9.665022259952277e-06, "numpy_to_tensor": 4.213850943261809e-05, "add_states_from_episodes_to_batch": 5.6905361849266345e-06, "add_observations_from_episodes_to_batch": 2.3383508794561004e-05, "agent_to_module_mapping": 4.811744257561155e-06}}, "connector_pipeline_timer": 0.00015902318707892128}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6929093639052007, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.2900000000000054, "env_step_timer": 0.00039901692837394557, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.187551180688846e-06, "listify_data_for_vector_env": 9.835294808731685e-06, "module_to_agent_unmapping": 3.868894911603106e-06, "un_batch_to_individual_items": 2.7527249152932023e-05, "normalize_and_clip_actions": 3.551934828034202e-05, "tensor_to_numpy": 6.358660019207707e-05, "get_actions": 0.00023670961716979133}}, "connector_pipeline_timer": 0.00044126563518361386}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 100000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 100000.0, "agent_1": 100000.0, "agent_0": 100000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 200.0, "agent_episode_returns_mean": {"agent_0": -0.862400000000001, "agent_2": -3.61600000000001, "agent_1": -1.0339000000000016}, "num_agent_steps_sampled_lifetime": {"agent_2": 100000.0, "agent_1": 100000.0, "agent_0": 100000.0}, "sample": 1.3111061093044798, "rlmodule_inference_timer": 0.00016574228448149478, "weights_seq_no": 24.0, "episode_len_mean": 500.0, "episode_return_mean": -5.512300000000011, "episode_return_min": -10.890000000000052, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.0802512091846452, "num_env_steps_sampled_lifetime_throughput": 912.1168909804516}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04021638243764985, "batch_individual_items": 0.17453043834421508, "add_one_ts_to_episodes_and_truncate": 0.006554062848871462, "add_time_dim_to_batch_and_zero_pad": 2.1906414271921072e-05, "add_columns_from_episodes_to_train_batch": 0.09422197977280446, "numpy_to_tensor": 0.0002348737311502894, "add_states_from_episodes_to_batch": 6.549367436414854e-06, "add_observations_from_episodes_to_batch": 0.00015585023931390834, "agent_to_module_mapping": 0.005278205722422351}}, "connector_pipeline_timer": 0.3216016771702224}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 3014400, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 15700000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 143848.67469858783, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27618.935868406545}, "agent_0": {"vf_explained_var": 0.6575245261192322, "entropy": 3.78220272064209, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 25.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.008710188791155815, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.00305419834330678, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.082359179854393, "vf_loss_unclipped": 0.00305419834330678, "num_module_steps_trained_lifetime": 1004800, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.08715541660785675, "num_module_steps_trained_lifetime_throughput": 9206.304625159219}, "agent_1": {"vf_loss": 0.00418480159714818, "mean_kl_loss": 0.008745186030864716, "total_loss": -0.03188437595963478, "vf_loss_unclipped": 0.00418480159714818, "num_module_steps_trained_lifetime": 1004800, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.03781821206212044, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.7895485162734985, "entropy": 3.830692768096924, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 25.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9206.313303042256}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.009721550159156322, "mean_kl_loss": 0.008397559635341167, "total_loss": 0.006671512499451637, "vf_loss_unclipped": 0.009721550159156322, "num_module_steps_trained_lifetime": 1004800, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.004729550331830978, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.3157351016998291, "entropy": 3.7754600048065186, "num_module_steps_trained": 40192, "weights_seq_no": 25.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9206.308978433277}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "num_module_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.192683436256663e-05, "add_time_dim_to_batch_and_zero_pad": 8.576404824444705e-06, "numpy_to_tensor": 3.5909622116088447e-05, "add_states_from_episodes_to_batch": 4.9172866531385315e-06, "add_observations_from_episodes_to_batch": 2.10062597716786e-05, "agent_to_module_mapping": 4.176461825394511e-06}}, "connector_pipeline_timer": 0.00013895353547876144}, "module_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "num_agent_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "num_module_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.2474942228695, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.856622227933258e-05, "numpy_to_tensor": 7.76499102357775e-05, "add_states_from_episodes_to_batch": 1.0750112123787402e-05, "add_observations_from_episodes_to_batch": 4.718294192571193e-05, "agent_to_module_mapping": 8.046613656915724e-06, "batch_individual_items": 5.4977964027784764e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 9.498780508010061e-05, "remove_single_ts_time_rank_from_batch": 1.1597280347239427e-06, "normalize_and_clip_actions": 3.0012026371648267e-05, "module_to_agent_unmapping": 3.356680177575688e-06, "un_batch_to_individual_items": 2.299795057347504e-05, "listify_data_for_vector_env": 8.447076206904692e-06, "tensor_to_numpy": 5.245771292316555e-05}}, "connector_pipeline_timer": 0.00026571240913557463}, "num_episodes_lifetime": 10, "rlmodule_inference_timer": 0.00013354389908662442, "agent_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "env_reset_timer": 0.001320616334560327, "episode_duration_sec_mean": 0.5497617469052785, "episode_len_min": 500, "num_env_steps_sampled": 0, "num_episodes": 0, "weights_seq_no": 20.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 5000, "connector_pipeline_timer": 0.00038193490181583913, "env_to_module_sum_episodes_length_out": 404.2474942228695, "sample": 2.800987857359578, "episode_return_mean": -3.3140000000000085, "env_step_timer": 0.0004139794357858142, "time_between_sampling": 42.713733303011395, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 100000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 25, "trial_id": "db5f9_00000", "date": "2025-10-20_16-50-34", "timestamp": 1760971834, "time_this_iter_s": 4.201527118682861, "time_total_s": 111.05273866653442, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f7055d7eb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 111.05273866653442, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 7.199999999999999, "ram_util_percent": 21.5}}
{"timers": {"training_iteration": 4.312906839383699, "restore_env_runners": 1.6699593900417476e-05, "training_step": 4.312708503963386, "env_runner_sampling_timer": 1.344223254904013, "learner_update_timer": 2.966044253811783, "synch_weights": 0.002052874633401945, "synch_env_connectors": 0.0014344568682572807, "restore_eval_env_runners": 7.657699170522391e-06, "evaluation_iteration": 2.8103607055020983, "synch_eval_env_connectors": 1.1546482564881444e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -0.7766000000000005, "agent_0": -1.0181000000000018, "agent_2": -3.8008000000000113}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.397273072390117e-05, "add_time_dim_to_batch_and_zero_pad": 9.092486564775238e-06, "numpy_to_tensor": 3.9515735204608e-05, "add_states_from_episodes_to_batch": 5.2884911819708196e-06, "add_observations_from_episodes_to_batch": 2.2161791430828432e-05, "agent_to_module_mapping": 4.5519120379577875e-06}}, "connector_pipeline_timer": 0.0001493318064381024}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6934092481137486, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.5699999999999985, "env_step_timer": 0.00035467495429918934, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1067007879236038e-06, "listify_data_for_vector_env": 9.269513970225284e-06, "module_to_agent_unmapping": 3.665576630974e-06, "un_batch_to_individual_items": 2.585712807584553e-05, "normalize_and_clip_actions": 3.34300992742551e-05, "tensor_to_numpy": 5.941680048282594e-05, "get_actions": 0.00021999809594991008}}, "connector_pipeline_timer": 0.0004126414706183296}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 104000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 104000.0, "agent_1": 104000.0, "agent_0": 104000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 208.0, "agent_episode_returns_mean": {"agent_0": -1.0181000000000018, "agent_2": -3.8008000000000113, "agent_1": -0.7766000000000005}, "num_agent_steps_sampled_lifetime": {"agent_2": 104000.0, "agent_1": 104000.0, "agent_0": 104000.0}, "sample": 1.3115553419838966, "rlmodule_inference_timer": 0.0001537901227404958, "weights_seq_no": 25.0, "episode_len_mean": 500.0, "episode_return_mean": -5.595500000000013, "episode_return_min": -9.480000000000038, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.077158664325313, "num_env_steps_sampled_lifetime_throughput": 914.9839756518197}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.040184050053312326, "batch_individual_items": 0.1746468777009283, "add_one_ts_to_episodes_and_truncate": 0.00654669641014496, "add_time_dim_to_batch_and_zero_pad": 2.1875870190985353e-05, "add_columns_from_episodes_to_train_batch": 0.09420500903545947, "numpy_to_tensor": 0.0002344241538178617, "add_states_from_episodes_to_batch": 6.5431437127758435e-06, "add_observations_from_episodes_to_batch": 0.00015564818671386216, "agent_to_module_mapping": 0.0052762007456669605}}, "connector_pipeline_timer": 0.3216565566386577}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 3134976, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 16328000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 144059.49007836255, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27659.41176522015}, "agent_0": {"vf_explained_var": 0.7809357643127441, "entropy": 3.7875587940216064, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 26.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.009961085394024849, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0009700228692963719, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.08176824450492859, "vf_loss_unclipped": 0.0009700228692963719, "num_module_steps_trained_lifetime": 1044992, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.08473048359155655, "num_module_steps_trained_lifetime_throughput": 9219.793382267744}, "agent_1": {"vf_loss": 0.002652594354003668, "mean_kl_loss": 0.007892019115388393, "total_loss": -0.043199218809604645, "vf_loss_unclipped": 0.002652594354003668, "num_module_steps_trained_lifetime": 1044992, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.04743022471666336, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.6112967133522034, "entropy": 3.818687915802002, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 26.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9219.80522118583}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.009714918211102486, "mean_kl_loss": 0.007941700518131256, "total_loss": -0.06234254315495491, "vf_loss_unclipped": 0.009714918211102486, "num_module_steps_trained_lifetime": 1044992, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.07364580035209656, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.3049023151397705, "entropy": 3.7852232456207275, "num_module_steps_trained": 40192, "weights_seq_no": 26.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9219.801701074819}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "num_module_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.192683436256663e-05, "add_time_dim_to_batch_and_zero_pad": 8.576404824444705e-06, "numpy_to_tensor": 3.5909622116088447e-05, "add_states_from_episodes_to_batch": 4.9172866531385315e-06, "add_observations_from_episodes_to_batch": 2.10062597716786e-05, "agent_to_module_mapping": 4.176461825394511e-06}}, "connector_pipeline_timer": 0.00013895353547876144}, "module_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "num_agent_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "num_module_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.2474942228695, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.856622227933258e-05, "numpy_to_tensor": 7.76499102357775e-05, "add_states_from_episodes_to_batch": 1.0750112123787402e-05, "add_observations_from_episodes_to_batch": 4.718294192571193e-05, "agent_to_module_mapping": 8.046613656915724e-06, "batch_individual_items": 5.4977964027784764e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 9.498780508010061e-05, "remove_single_ts_time_rank_from_batch": 1.1597280347239427e-06, "normalize_and_clip_actions": 3.0012026371648267e-05, "module_to_agent_unmapping": 3.356680177575688e-06, "un_batch_to_individual_items": 2.299795057347504e-05, "listify_data_for_vector_env": 8.447076206904692e-06, "tensor_to_numpy": 5.245771292316555e-05}}, "connector_pipeline_timer": 0.00026571240913557463}, "num_episodes_lifetime": 10, "rlmodule_inference_timer": 0.00013354389908662442, "agent_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "env_reset_timer": 0.001320616334560327, "episode_duration_sec_mean": 0.5497617469052785, "episode_len_min": 500, "num_env_steps_sampled": 0, "num_episodes": 0, "weights_seq_no": 20.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 5000, "connector_pipeline_timer": 0.00038193490181583913, "env_to_module_sum_episodes_length_out": 404.2474942228695, "sample": 2.800987857359578, "episode_return_mean": -3.3140000000000085, "env_step_timer": 0.0004139794357858142, "time_between_sampling": 42.713733303011395, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 104000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 26, "trial_id": "db5f9_00000", "date": "2025-10-20_16-50-38", "timestamp": 1760971838, "time_this_iter_s": 4.2300732135772705, "time_total_s": 115.2828118801117, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f7055d7b50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 115.2828118801117, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 7.016666666666666, "ram_util_percent": 21.416666666666668}}
{"timers": {"training_iteration": 4.311127994989915, "restore_env_runners": 1.66271481574947e-05, "training_step": 4.310928975153782, "env_runner_sampling_timer": 1.3441468729950843, "learner_update_timer": 2.9643366056137546, "synch_weights": 0.0020561704468254117, "synch_env_connectors": 0.0014380287095719774, "restore_eval_env_runners": 7.657699170522391e-06, "evaluation_iteration": 2.8103607055020983, "synch_eval_env_connectors": 1.1546482564881444e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.2356000000000034, "agent_0": -1.2760000000000036, "agent_2": -3.803900000000011}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.447308768925677e-05, "add_time_dim_to_batch_and_zero_pad": 9.38672788050326e-06, "numpy_to_tensor": 4.0230741879271014e-05, "add_states_from_episodes_to_batch": 5.430510629454295e-06, "add_observations_from_episodes_to_batch": 2.263327364076424e-05, "agent_to_module_mapping": 4.596920317929169e-06}}, "connector_pipeline_timer": 0.00015219759531526003}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6779394553159364, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.5699999999999985, "env_step_timer": 0.0003622987437711933, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1270457691701269e-06, "listify_data_for_vector_env": 9.456087997244383e-06, "module_to_agent_unmapping": 3.699683478264969e-06, "un_batch_to_individual_items": 2.6197202238918297e-05, "normalize_and_clip_actions": 3.399692011016531e-05, "tensor_to_numpy": 6.046291071262247e-05, "get_actions": 0.00022692455485572128}}, "connector_pipeline_timer": 0.00042204503662824565}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 108000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 108000.0, "agent_1": 108000.0, "agent_0": 108000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 216.0, "agent_episode_returns_mean": {"agent_0": -1.2760000000000036, "agent_2": -3.803900000000011, "agent_1": -1.2356000000000034}, "num_agent_steps_sampled_lifetime": {"agent_2": 108000.0, "agent_1": 108000.0, "agent_0": 108000.0}, "sample": 1.3115485384314454, "rlmodule_inference_timer": 0.00016050961571413235, "weights_seq_no": 26.0, "episode_len_mean": 500.0, "episode_return_mean": -6.315500000000018, "episode_return_min": -10.420000000000034, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.075245292277153, "num_env_steps_sampled_lifetime_throughput": 916.8456557086386}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.040189302483179014, "batch_individual_items": 0.17353569588408774, "add_one_ts_to_episodes_and_truncate": 0.006535931615771044, "add_time_dim_to_batch_and_zero_pad": 2.1848231687071995e-05, "add_columns_from_episodes_to_train_batch": 0.09419209713521788, "numpy_to_tensor": 0.00023399078189390425, "add_states_from_episodes_to_batch": 6.535392575153676e-06, "add_observations_from_episodes_to_batch": 0.0001555364649746479, "agent_to_module_mapping": 0.005275289067829192}}, "connector_pipeline_timer": 0.3205232264721851}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 3255552, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 16956000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 144420.41981624305, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27728.712227106225}, "agent_0": {"vf_explained_var": 0.7672596573829651, "entropy": 3.825161933898926, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 27.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.009117416106164455, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.0008506174199283123, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": -0.05475088953971863, "vf_loss_unclipped": 0.0008506174199283123, "num_module_steps_trained_lifetime": 1085184, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.05742499977350235, "num_module_steps_trained_lifetime_throughput": 9242.89461606312}, "agent_1": {"vf_loss": 0.0038519143126904964, "mean_kl_loss": 0.010774652473628521, "total_loss": -0.06792306154966354, "vf_loss_unclipped": 0.0038519143126904964, "num_module_steps_trained_lifetime": 1085184, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.07392990589141846, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.8426739573478699, "entropy": 3.822768449783325, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 27.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9242.905486262442}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.011117077432572842, "mean_kl_loss": 0.009165352210402489, "total_loss": 0.06566224992275238, "vf_loss_unclipped": 0.011117077432572842, "num_module_steps_trained_lifetime": 1085184, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.05271210893988609, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.2567834258079529, "entropy": 3.801157236099243, "num_module_steps_trained": 40192, "weights_seq_no": 27.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9242.901613788134}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "num_module_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.192683436256663e-05, "add_time_dim_to_batch_and_zero_pad": 8.576404824444705e-06, "numpy_to_tensor": 3.5909622116088447e-05, "add_states_from_episodes_to_batch": 4.9172866531385315e-06, "add_observations_from_episodes_to_batch": 2.10062597716786e-05, "agent_to_module_mapping": 4.176461825394511e-06}}, "connector_pipeline_timer": 0.00013895353547876144}, "module_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "num_agent_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "num_module_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.2474942228695, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.856622227933258e-05, "numpy_to_tensor": 7.76499102357775e-05, "add_states_from_episodes_to_batch": 1.0750112123787402e-05, "add_observations_from_episodes_to_batch": 4.718294192571193e-05, "agent_to_module_mapping": 8.046613656915724e-06, "batch_individual_items": 5.4977964027784764e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 9.498780508010061e-05, "remove_single_ts_time_rank_from_batch": 1.1597280347239427e-06, "normalize_and_clip_actions": 3.0012026371648267e-05, "module_to_agent_unmapping": 3.356680177575688e-06, "un_batch_to_individual_items": 2.299795057347504e-05, "listify_data_for_vector_env": 8.447076206904692e-06, "tensor_to_numpy": 5.245771292316555e-05}}, "connector_pipeline_timer": 0.00026571240913557463}, "num_episodes_lifetime": 10, "rlmodule_inference_timer": 0.00013354389908662442, "agent_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "env_reset_timer": 0.001320616334560327, "episode_duration_sec_mean": 0.5497617469052785, "episode_len_min": 500, "num_env_steps_sampled": 0, "num_episodes": 0, "weights_seq_no": 20.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 5000, "connector_pipeline_timer": 0.00038193490181583913, "env_to_module_sum_episodes_length_out": 404.2474942228695, "sample": 2.800987857359578, "episode_return_mean": -3.3140000000000085, "env_step_timer": 0.0004139794357858142, "time_between_sampling": 42.713733303011395, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 108000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 27, "trial_id": "db5f9_00000", "date": "2025-10-20_16-50-42", "timestamp": 1760971842, "time_this_iter_s": 4.139476776123047, "time_total_s": 119.42228865623474, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f70558bbe0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 119.42228865623474, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 7.633333333333333, "ram_util_percent": 21.400000000000002}}
{"timers": {"training_iteration": 4.311015936189964, "restore_env_runners": 1.6558137020693284e-05, "training_step": 4.310816415782354, "env_runner_sampling_timer": 1.344472033705494, "learner_update_timer": 2.963896583067779, "synch_weights": 0.0020574570425962286, "synch_env_connectors": 0.0014377445624064462, "restore_eval_env_runners": 7.657699170522391e-06, "evaluation_iteration": 2.8103607055020983, "synch_eval_env_connectors": 1.1546482564881444e-05}, "env_runners": {"episode_len_max": 500, "module_episode_returns_mean": {"agent_1": -1.2506000000000033, "agent_0": -1.849900000000006, "agent_2": -3.8589000000000118}, "num_module_steps_sampled": {"agent_2": 4000.0, "agent_1": 4000.0, "agent_0": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.4795123071272607e-05, "add_time_dim_to_batch_and_zero_pad": 9.476833655771357e-06, "numpy_to_tensor": 4.148715483416483e-05, "add_states_from_episodes_to_batch": 5.4961992075648534e-06, "add_observations_from_episodes_to_batch": 2.2930513482443454e-05, "agent_to_module_mapping": 4.698363598200006e-06}}, "connector_pipeline_timer": 0.00015537441128113258}, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_steps": {"agent_2": 500.0, "agent_1": 500.0, "agent_0": 500.0}, "episode_duration_sec_mean": 0.6629189622035483, "num_agent_steps_sampled": {"agent_0": 4000.0, "agent_2": 4000.0, "agent_1": 4000.0}, "episode_return_max": -3.5699999999999985, "env_step_timer": 0.0003929893425974861, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1382670703506074e-06, "listify_data_for_vector_env": 9.483719934787352e-06, "module_to_agent_unmapping": 3.7836834333814573e-06, "un_batch_to_individual_items": 2.6550329292530053e-05, "normalize_and_clip_actions": 3.438559102234606e-05, "tensor_to_numpy": 6.1004882862975856e-05, "get_actions": 0.00022830419643100002}}, "connector_pipeline_timer": 0.0004261107714895708}, "episode_len_min": 500, "num_env_steps_sampled_lifetime": 112000.0, "timers": {"connectors": {"agent_to_module_mapping": 7.320501026697457e-06, "batch_individual_items": 4.204326251056045e-05, "add_time_dim_to_batch_and_zero_pad": 1.8153252312913537e-05, "numpy_to_tensor": 7.775674748700112e-05, "add_states_from_episodes_to_batch": 8.319242624565954e-06, "add_observations_from_episodes_to_batch": 3.8484999095089734e-05}}, "num_env_steps_sampled": 4000.0, "connector_pipeline_timer": 0.00043293948692735285, "num_module_steps_sampled_lifetime": {"agent_2": 112000.0, "agent_1": 112000.0, "agent_0": 112000.0}, "num_episodes": 8.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 224.0, "agent_episode_returns_mean": {"agent_0": -1.849900000000006, "agent_2": -3.8589000000000118, "agent_1": -1.2506000000000033}, "num_agent_steps_sampled_lifetime": {"agent_2": 112000.0, "agent_1": 112000.0, "agent_0": 112000.0}, "sample": 1.3119264826246329, "rlmodule_inference_timer": 0.0001621587333112961, "weights_seq_no": 27.0, "episode_len_mean": 500.0, "episode_return_mean": -6.959400000000021, "episode_return_min": -10.420000000000034, "env_reset_timer": 0.0009426562610315159, "time_between_sampling": 3.072897896536917, "num_env_steps_sampled_lifetime_throughput": 918.7190599635547}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.040175889948420786, "batch_individual_items": 0.17365013399525803, "add_one_ts_to_episodes_and_truncate": 0.006528635329623424, "add_time_dim_to_batch_and_zero_pad": 2.182419904640202e-05, "add_columns_from_episodes_to_train_batch": 0.09417716240336697, "numpy_to_tensor": 0.0002335911339013348, "add_states_from_episodes_to_batch": 6.526448857746599e-06, "add_observations_from_episodes_to_batch": 0.0001553873002057771, "agent_to_module_mapping": 0.005274134886693204}}, "connector_pipeline_timer": 0.3205981818076391}, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 3376128, "learner_connector_sum_episodes_length_in": 4000.0, "num_env_steps_trained_lifetime": 17584000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_trainable_parameters": 626097, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 144473.70915313665, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 27738.943135792033}, "agent_0": {"vf_explained_var": 0.8143658638000488, "entropy": 3.7866179943084717, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 28.0, "num_trainable_parameters": 208699, "mean_kl_loss": 0.008371423929929733, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.004124397411942482, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.02650369331240654, "vf_loss_unclipped": 0.004124397411942482, "num_module_steps_trained_lifetime": 1125376, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.02070501446723938, "num_module_steps_trained_lifetime_throughput": 9246.30516286037}, "agent_1": {"vf_loss": 0.0016378817381337285, "mean_kl_loss": 0.007189310155808926, "total_loss": 0.060027655214071274, "vf_loss_unclipped": 0.0016378817381337285, "num_module_steps_trained_lifetime": 1125376, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": 0.05695191025733948, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.9186016917228699, "entropy": 3.810637950897217, "num_module_steps_trained": 40192, "curr_entropy_coeff": 0.0, "weights_seq_no": 28.0, "num_trainable_parameters": 208699, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime_throughput": 9246.315698245395}, "agent_2": {"curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "vf_loss": 0.009596269577741623, "mean_kl_loss": 0.008219001814723015, "total_loss": -0.00159102538600564, "vf_loss_unclipped": 0.009596269577741623, "num_module_steps_trained_lifetime": 1125376, "default_optimizer_learning_rate": 5e-05, "module_train_batch_size_mean": 256.0, "policy_loss": -0.012831093743443489, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.3350382447242737, "entropy": 3.782477378845215, "num_module_steps_trained": 40192, "weights_seq_no": 28.0, "num_trainable_parameters": 208699, "num_module_steps_trained_lifetime_throughput": 9246.31229970258}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "num_module_steps_sampled_lifetime": {"agent_1": 5000, "agent_2": 5000, "agent_0": 5000}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.192683436256663e-05, "add_time_dim_to_batch_and_zero_pad": 8.576404824444705e-06, "numpy_to_tensor": 3.5909622116088447e-05, "add_states_from_episodes_to_batch": 4.9172866531385315e-06, "add_observations_from_episodes_to_batch": 2.10062597716786e-05, "agent_to_module_mapping": 4.176461825394511e-06}}, "connector_pipeline_timer": 0.00013895353547876144}, "module_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "num_agent_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "num_module_steps_sampled": {"agent_2": 0, "agent_0": 0, "agent_1": 0}, "episode_return_min": -10.990000000000054, "agent_steps": {"agent_2": 500.0, "agent_0": 500.0, "agent_1": 500.0}, "env_to_module_sum_episodes_length_in": 404.2474942228695, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.856622227933258e-05, "numpy_to_tensor": 7.76499102357775e-05, "add_states_from_episodes_to_batch": 1.0750112123787402e-05, "add_observations_from_episodes_to_batch": 4.718294192571193e-05, "agent_to_module_mapping": 8.046613656915724e-06, "batch_individual_items": 5.4977964027784764e-05}}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 9.498780508010061e-05, "remove_single_ts_time_rank_from_batch": 1.1597280347239427e-06, "normalize_and_clip_actions": 3.0012026371648267e-05, "module_to_agent_unmapping": 3.356680177575688e-06, "un_batch_to_individual_items": 2.299795057347504e-05, "listify_data_for_vector_env": 8.447076206904692e-06, "tensor_to_numpy": 5.245771292316555e-05}}, "connector_pipeline_timer": 0.00026571240913557463}, "num_episodes_lifetime": 10, "rlmodule_inference_timer": 0.00013354389908662442, "agent_episode_returns_mean": {"agent_1": -0.9660000000000029, "agent_2": -1.3650000000000024, "agent_0": -0.983000000000003}, "env_reset_timer": 0.001320616334560327, "episode_duration_sec_mean": 0.5497617469052785, "episode_len_min": 500, "num_env_steps_sampled": 0, "num_episodes": 0, "weights_seq_no": 20.0, "episode_len_mean": 500.0, "episode_len_max": 500, "episode_return_max": -1.5000000000000009, "num_env_steps_sampled_lifetime": 5000, "connector_pipeline_timer": 0.00038193490181583913, "env_to_module_sum_episodes_length_out": 404.2474942228695, "sample": 2.800987857359578, "episode_return_mean": -3.3140000000000085, "env_step_timer": 0.0004139794357858142, "time_between_sampling": 42.713733303011395, "num_env_steps_sampled_lifetime_throughput": NaN}}, "num_env_steps_sampled_lifetime": 112000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 28, "trial_id": "db5f9_00000", "date": "2025-10-20_16-50-46", "timestamp": 1760971846, "time_this_iter_s": 4.304978132247925, "time_total_s": 123.72726678848267, "pid": 2521914, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x76f7055d7130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 123.72726678848267, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 7.783333333333334, "ram_util_percent": 21.383333333333336}}
