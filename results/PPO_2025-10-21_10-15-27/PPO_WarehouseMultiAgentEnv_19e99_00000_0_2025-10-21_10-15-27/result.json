{"timers": {"training_iteration": 3.4236022760160267, "restore_env_runners": 1.3814016710966825e-05, "training_step": 3.4234508349909447, "env_runner_sampling_timer": 1.302360420988407, "learner_update_timer": 2.117917268013116, "synch_weights": 0.0027930549695156515}, "env_runners": {"num_agent_steps_sampled": {"agent_0": 4000.0, "agent_1": 4000.0, "agent_2": 4000.0}, "weights_seq_no": 0.0, "num_module_steps_sampled_lifetime": {"agent_2": 4000.0, "agent_0": 4000.0, "agent_1": 4000.0}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8338250811211765e-05, "agent_to_module_mapping": 6.668735295534131e-06, "numpy_to_tensor": 6.384401058312501e-05, "add_observations_from_episodes_to_batch": 4.012801218777893e-05, "batch_individual_items": 4.2264480725862086e-05, "add_states_from_episodes_to_batch": 7.255017408169806e-06}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.40734259533143e-06, "add_states_from_episodes_to_batch": 4.825449642549619e-06, "agent_to_module_mapping": 4.134886711287446e-06, "numpy_to_tensor": 3.594652765291715e-05, "add_observations_from_episodes_to_batch": 2.0395745021787224e-05, "batch_individual_items": 2.210837443281749e-05}}, "connector_pipeline_timer": 0.0001367929187324344}, "module_episode_returns_mean": {"agent_1": -1.4525000000000055, "agent_2": -4.075000000000014, "agent_0": -1.2962500000000026}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.4824754006236113e-06, "listify_data_for_vector_env": 8.668634069244782e-06, "normalize_and_clip_actions": 3.114533786112284e-05, "get_actions": 0.00020049494439384422, "un_batch_to_individual_items": 2.443470718314673e-05, "remove_single_ts_time_rank_from_batch": 1.0184126753481348e-06, "tensor_to_numpy": 5.455397807316334e-05}}, "connector_pipeline_timer": 0.0003788520510796721}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "episode_len_max": 500, "episode_duration_sec_mean": 0.6288714745023753, "episode_len_min": 500, "num_episodes_lifetime": 8.0, "episode_return_max": -4.370000000000007, "num_env_steps_sampled": 4000.0, "episode_return_min": -11.360000000000033, "rlmodule_inference_timer": 0.00013672549422519197, "env_step_timer": 0.00032895015918974846, "episode_len_mean": 500.0, "num_agent_steps_sampled_lifetime": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "num_env_steps_sampled_lifetime": 4000.0, "num_episodes": 8.0, "connector_pipeline_timer": 0.00039966448093764484, "env_to_module_sum_episodes_length_out": 399.2306012071058, "env_to_module_sum_episodes_length_in": 399.2306012071058, "agent_episode_returns_mean": {"agent_1": -1.4525000000000055, "agent_2": -4.075000000000014, "agent_0": -1.2962500000000026}, "sample": 1.2748073295078939, "env_reset_timer": 0.0007886717503424734, "episode_return_mean": -6.823750000000023, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"agent_0": {"entropy": 4.028608322143555, "num_module_steps_trained": 40192, "vf_loss_unclipped": 0.0019304698798805475, "weights_seq_no": 1.0, "total_loss": 0.041222214698791504, "module_train_batch_size_mean": 256.0, "vf_loss": 0.0019304698798805475, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 40192, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.008776083588600159, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": 0.037536539137363434, "vf_explained_var": 0.731103777885437, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_1": {"num_module_steps_trained": 40192, "vf_loss": 0.001694075996056199, "vf_loss_unclipped": 0.001694075996056199, "weights_seq_no": 1.0, "total_loss": -0.03423450142145157, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 40192, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.008295387960970402, "entropy": 4.035117149353027, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": -0.03758765384554863, "vf_explained_var": 0.7236520051956177, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 120576, "learner_connector_sum_episodes_length_in": 4000, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.001618554990272969, "add_observations_from_episodes_to_batch": 0.0001343170297332108, "add_columns_from_episodes_to_train_batch": 0.0930513350176625, "agent_to_module_mapping": 0.0054735050071030855, "add_one_ts_to_episodes_and_truncate": 0.006455008988268673, "add_time_dim_to_batch_and_zero_pad": 2.474198117852211e-05, "batch_individual_items": 0.18189554999116808, "add_states_from_episodes_to_batch": 6.491958629339933e-06, "general_advantage_estimation": 0.055100818048231304}}, "connector_pipeline_timer": 0.3441893139970489}, "num_trainable_parameters": 626097, "num_env_steps_trained": 628000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000, "num_env_steps_trained_lifetime": 628000, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_2": {"policy_loss": -0.03988554701209068, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.4706823229789734, "entropy": 4.0325846672058105, "curr_kl_coeff": 0.20000000298023224, "total_loss": -0.03381038084626198, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "module_train_batch_size_mean": 256.0, "num_module_steps_trained": 40192, "vf_loss": 0.004156599752604961, "vf_loss_unclipped": 0.004156599752604961, "weights_seq_no": 1.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 40192, "mean_kl_loss": 0.009592882357537746, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 4000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "19e99_00000", "date": "2025-10-21_10-15-37", "timestamp": 1761034537, "time_this_iter_s": 3.4272682666778564, "time_total_s": 3.4272682666778564, "pid": 3078166, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x7d3790106b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.4272682666778564, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 6.9, "ram_util_percent": 22.540000000000003}}
{"timers": {"training_iteration": 3.4194007057760607, "restore_env_runners": 1.377637672703713e-05, "training_step": 3.419248494480853, "env_runner_sampling_timer": 1.3022309998288983, "learner_update_timer": 2.113850145153119, "synch_weights": 0.0027872426796238872, "synch_env_connectors": 0.001431244018021971}, "env_runners": {"num_agent_steps_sampled": {"agent_0": 4000.0, "agent_1": 4000.0, "agent_2": 4000.0}, "weights_seq_no": 1.0, "num_module_steps_sampled_lifetime": {"agent_2": 8000.0, "agent_0": 8000.0, "agent_1": 8000.0}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8338250811211765e-05, "agent_to_module_mapping": 6.668735295534131e-06, "numpy_to_tensor": 6.384401058312501e-05, "add_observations_from_episodes_to_batch": 4.012801218777893e-05, "batch_individual_items": 4.2264480725862086e-05, "add_states_from_episodes_to_batch": 7.255017408169806e-06}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.47806644233555e-06, "add_states_from_episodes_to_batch": 4.814245979092169e-06, "agent_to_module_mapping": 4.047654122622074e-06, "numpy_to_tensor": 3.6205852912702524e-05, "add_observations_from_episodes_to_batch": 1.9979344579122657e-05, "batch_individual_items": 2.1913511162240883e-05}}, "connector_pipeline_timer": 0.00013681030688135292}, "module_episode_returns_mean": {"agent_1": -1.7131250000000053, "agent_2": -3.8887500000000124, "agent_0": -0.9856250000000011}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.389924619192685e-06, "listify_data_for_vector_env": 8.532197218837389e-06, "normalize_and_clip_actions": 3.0511293042481014e-05, "get_actions": 0.00020441703560049969, "un_batch_to_individual_items": 2.3834285524406214e-05, "remove_single_ts_time_rank_from_batch": 1.0198794840368776e-06, "tensor_to_numpy": 5.465263721259118e-05}}, "connector_pipeline_timer": 0.0003821732683181571}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "episode_len_max": 500, "episode_duration_sec_mean": 0.6262456591903174, "episode_len_min": 500, "num_episodes_lifetime": 16.0, "episode_return_max": -3.7, "num_env_steps_sampled": 4000.0, "episode_return_min": -11.360000000000033, "rlmodule_inference_timer": 0.00013955711363714267, "env_step_timer": 0.00033446191548507716, "episode_len_mean": 500.0, "num_agent_steps_sampled_lifetime": {"agent_1": 8000.0, "agent_2": 8000.0, "agent_0": 8000.0}, "num_env_steps_sampled_lifetime": 8000.0, "num_episodes": 8.0, "connector_pipeline_timer": 0.00039966448093764484, "env_to_module_sum_episodes_length_out": 399.24749350803154, "env_to_module_sum_episodes_length_in": 399.24749350803154, "agent_episode_returns_mean": {"agent_1": -1.7131250000000053, "agent_2": -3.8887500000000124, "agent_0": -0.9856250000000011}, "sample": 1.274702633312845, "env_reset_timer": 0.0007886717503424734, "episode_return_mean": -6.587500000000018, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "time_between_sampling": 2.168927840248216, "num_env_steps_sampled_lifetime_throughput": 1166.5737460911605}, "learners": {"agent_0": {"entropy": 4.019718170166016, "num_module_steps_trained": 40192, "vf_loss_unclipped": 0.0009435543324798346, "weights_seq_no": 2.0, "total_loss": 0.07539069652557373, "module_train_batch_size_mean": 256.0, "vf_loss": 0.0009435543324798346, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 80384, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.009099394083023071, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": 0.07262726128101349, "vf_explained_var": 0.6068196892738342, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_1": {"num_module_steps_trained": 40192, "vf_loss": 0.0060724434442818165, "vf_loss_unclipped": 0.0060724434442818165, "weights_seq_no": 2.0, "total_loss": 0.04596325010061264, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 80384, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.007003479637205601, "entropy": 4.032160758972168, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": 0.038490112870931625, "vf_explained_var": 0.5136963725090027, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 241152, "learner_connector_sum_episodes_length_in": 4000.0, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0016159181599505247, "add_observations_from_episodes_to_batch": 0.000134343359968625, "add_columns_from_episodes_to_train_batch": 0.09305006318783852, "agent_to_module_mapping": 0.005469983777147718, "add_one_ts_to_episodes_and_truncate": 0.006445703108329326, "add_time_dim_to_batch_and_zero_pad": 2.468403137754649e-05, "batch_individual_items": 0.18072021178144496, "add_states_from_episodes_to_batch": 6.4848491456359625e-06, "general_advantage_estimation": 0.054635385497822424}}, "connector_pipeline_timer": 0.34252903402666557}, "num_trainable_parameters": 626097, "num_env_steps_trained": 628000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 1256000, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_2": {"policy_loss": 0.05903507024049759, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.5650604963302612, "entropy": 4.025859832763672, "curr_kl_coeff": 0.20000000298023224, "total_loss": 0.06390469521284103, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "module_train_batch_size_mean": 256.0, "num_module_steps_trained": 40192, "vf_loss": 0.003282050136476755, "vf_loss_unclipped": 0.003282050136476755, "weights_seq_no": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 80384, "mean_kl_loss": 0.007937987335026264, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "19e99_00000", "date": "2025-10-21_10-15-40", "timestamp": 1761034540, "time_this_iter_s": 3.007140874862671, "time_total_s": 6.434409141540527, "pid": 3078166, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x7d379016d5a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.434409141540527, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 23.160000000000004}}
{"timers": {"training_iteration": 3.4178007871687237, "restore_env_runners": 1.3731472805375232e-05, "training_step": 3.4176473544661596, "env_runner_sampling_timer": 1.3032483394505632, "learner_update_timer": 2.1112325136216183, "synch_weights": 0.0027848609527456577, "synch_env_connectors": 0.0014320576278259976}, "env_runners": {"num_agent_steps_sampled": {"agent_0": 4000.0, "agent_1": 4000.0, "agent_2": 4000.0}, "weights_seq_no": 2.0, "num_module_steps_sampled_lifetime": {"agent_2": 12000.0, "agent_0": 12000.0, "agent_1": 12000.0}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8338250811211765e-05, "agent_to_module_mapping": 6.668735295534131e-06, "numpy_to_tensor": 6.384401058312501e-05, "add_observations_from_episodes_to_batch": 4.012801218777893e-05, "batch_individual_items": 4.2264480725862086e-05, "add_states_from_episodes_to_batch": 7.255017408169806e-06}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.555438162749288e-06, "add_states_from_episodes_to_batch": 4.854141319250113e-06, "agent_to_module_mapping": 4.048291980229117e-06, "numpy_to_tensor": 3.617809975299196e-05, "add_observations_from_episodes_to_batch": 2.0056619036238762e-05, "batch_individual_items": 2.1922641140306408e-05}}, "connector_pipeline_timer": 0.00013716125621174286}, "module_episode_returns_mean": {"agent_1": -1.6112500000000047, "agent_2": -3.98541666666668, "agent_0": -1.0487500000000012}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.3971449177344413e-06, "listify_data_for_vector_env": 8.474614621104053e-06, "normalize_and_clip_actions": 3.063279626426068e-05, "get_actions": 0.00020225193434380764, "un_batch_to_individual_items": 2.381384795298157e-05, "remove_single_ts_time_rank_from_batch": 1.0261653430121259e-06, "tensor_to_numpy": 5.4723268490632163e-05}}, "connector_pipeline_timer": 0.000380205137190154}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "episode_len_max": 500, "episode_duration_sec_mean": 0.6333071780851848, "episode_len_min": 500, "num_episodes_lifetime": 24.0, "episode_return_max": -3.7, "num_env_steps_sampled": 4000.0, "episode_return_min": -11.360000000000033, "rlmodule_inference_timer": 0.00013963118021164674, "env_step_timer": 0.0003530358134034171, "episode_len_mean": 500.0, "num_agent_steps_sampled_lifetime": {"agent_1": 12000.0, "agent_2": 12000.0, "agent_0": 12000.0}, "num_env_steps_sampled_lifetime": 12000.0, "num_episodes": 8.0, "connector_pipeline_timer": 0.00039966448093764484, "env_to_module_sum_episodes_length_out": 399.2474942227809, "env_to_module_sum_episodes_length_in": 399.2474942227809, "agent_episode_returns_mean": {"agent_1": -1.6112500000000047, "agent_2": -3.98541666666668, "agent_0": -1.0487500000000012}, "sample": 1.275312103609575, "env_reset_timer": 0.0007886717503424734, "episode_return_mean": -6.645416666666686, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "time_between_sampling": 2.164789574700699, "num_env_steps_sampled_lifetime_throughput": 1172.068433204173}, "learners": {"agent_0": {"entropy": 4.013150215148926, "num_module_steps_trained": 40192, "vf_loss_unclipped": 0.0007589336019009352, "weights_seq_no": 3.0, "total_loss": -0.11343912035226822, "module_train_batch_size_mean": 256.0, "vf_loss": 0.0007589336019009352, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 120576, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.009265054017305374, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": -0.11605104804039001, "vf_explained_var": 0.7983300685882568, "num_module_steps_trained_lifetime_throughput": 12272.990243474385}, "agent_1": {"num_module_steps_trained": 40192, "vf_loss": 0.0036927037872374058, "vf_loss_unclipped": 0.0036927037872374058, "weights_seq_no": 3.0, "total_loss": -0.042426396161317825, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 120576, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.008238911628723145, "entropy": 4.025576114654541, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": -0.04776689037680626, "vf_explained_var": 0.582499623298645, "num_module_steps_trained_lifetime_throughput": 12272.96352646701}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 361728, "learner_connector_sum_episodes_length_in": 4000.0, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0016125395582057536, "add_observations_from_episodes_to_batch": 0.00013437477676779962, "add_columns_from_episodes_to_train_batch": 0.09304954000566504, "agent_to_module_mapping": 0.00546686836941517, "add_one_ts_to_episodes_and_truncate": 0.00643665602710098, "add_time_dim_to_batch_and_zero_pad": 2.4645331181818618e-05, "batch_individual_items": 0.18071013699384056, "add_states_from_episodes_to_batch": 6.477300857659429e-06, "general_advantage_estimation": 0.05417140305294305}}, "connector_pipeline_timer": 0.34203629233624083}, "num_trainable_parameters": 626097, "num_env_steps_trained": 628000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 1884000, "num_env_steps_trained_lifetime_throughput": 191763.13415787078, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 36819.0037745383}, "agent_2": {"policy_loss": 0.024965472519397736, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.42565733194351196, "entropy": 4.020910739898682, "curr_kl_coeff": 0.20000000298023224, "total_loss": 0.03165341913700104, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "module_train_batch_size_mean": 256.0, "num_module_steps_trained": 40192, "vf_loss": 0.00479078758507967, "vf_loss_unclipped": 0.00479078758507967, "weights_seq_no": 3.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 120576, "mean_kl_loss": 0.00948580913245678, "num_module_steps_trained_lifetime_throughput": 12272.906798667485}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 12000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "19e99_00000", "date": "2025-10-21_10-15-44", "timestamp": 1761034544, "time_this_iter_s": 3.263277292251587, "time_total_s": 9.697686433792114, "pid": 3078166, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x7d37901bbf40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.697686433792114, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 9.325, "ram_util_percent": 23.2}}
{"timers": {"training_iteration": 3.415322302136663, "restore_env_runners": 1.3687567985325584e-05, "training_step": 3.415167943251702, "env_runner_sampling_timer": 1.304348099145901, "learner_update_timer": 2.107657469615028, "synch_weights": 0.002780534812782542, "synch_env_connectors": 0.001433541141619207}, "env_runners": {"num_agent_steps_sampled": {"agent_0": 4000.0, "agent_1": 4000.0, "agent_2": 4000.0}, "weights_seq_no": 3.0, "num_module_steps_sampled_lifetime": {"agent_2": 16000.0, "agent_0": 16000.0, "agent_1": 16000.0}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8338250811211765e-05, "agent_to_module_mapping": 6.668735295534131e-06, "numpy_to_tensor": 6.384401058312501e-05, "add_observations_from_episodes_to_batch": 4.012801218777893e-05, "batch_individual_items": 4.2264480725862086e-05, "add_states_from_episodes_to_batch": 7.255017408169806e-06}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.69795928973933e-06, "add_states_from_episodes_to_batch": 4.919661954263335e-06, "agent_to_module_mapping": 4.1363149064361925e-06, "numpy_to_tensor": 3.7281444809324435e-05, "add_observations_from_episodes_to_batch": 2.0465540490988244e-05, "batch_individual_items": 2.2520616858077894e-05}}, "connector_pipeline_timer": 0.0001403775453812698}, "module_episode_returns_mean": {"agent_1": -1.4103000000000034, "agent_2": -3.8061000000000114, "agent_0": -0.9141000000000007}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.4907712535235073e-06, "listify_data_for_vector_env": 8.56389471685847e-06, "normalize_and_clip_actions": 3.1212965400907794e-05, "get_actions": 0.000208510871317274, "un_batch_to_individual_items": 2.4262055459563576e-05, "remove_single_ts_time_rank_from_batch": 1.0596839791634704e-06, "tensor_to_numpy": 5.573995196788477e-05}}, "connector_pipeline_timer": 0.0003898618383762791}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "episode_len_max": 500, "episode_duration_sec_mean": 0.6411671156692319, "episode_len_min": 500, "num_episodes_lifetime": 32.0, "episode_return_max": -3.7, "num_env_steps_sampled": 4000.0, "episode_return_min": -9.38000000000001, "rlmodule_inference_timer": 0.000145210927882088, "env_step_timer": 0.00032702385033953724, "episode_len_mean": 500.0, "num_agent_steps_sampled_lifetime": {"agent_1": 16000.0, "agent_2": 16000.0, "agent_0": 16000.0}, "num_env_steps_sampled_lifetime": 16000.0, "num_episodes": 8.0, "connector_pipeline_timer": 0.00039966448093764484, "env_to_module_sum_episodes_length_out": 399.2474942228111, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_episode_returns_mean": {"agent_1": -1.4103000000000034, "agent_2": -3.8061000000000114, "agent_0": -0.9141000000000007}, "sample": 1.2760872775232714, "env_reset_timer": 0.0007886717503424734, "episode_return_mean": -6.1305000000000165, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "time_between_sampling": 2.162547482706435, "num_env_steps_sampled_lifetime_throughput": 1174.3414920067403}, "learners": {"agent_0": {"entropy": 4.007077693939209, "num_module_steps_trained": 40192, "vf_loss_unclipped": 0.0005076836096122861, "weights_seq_no": 4.0, "total_loss": 0.022538434714078903, "module_train_batch_size_mean": 256.0, "vf_loss": 0.0005076836096122861, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 160768, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.009544086642563343, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": 0.020121924579143524, "vf_explained_var": 0.8928670883178711, "num_module_steps_trained_lifetime_throughput": 12289.879921491722}, "agent_1": {"num_module_steps_trained": 40192, "vf_loss": 0.000978478929027915, "vf_loss_unclipped": 0.000978478929027915, "weights_seq_no": 4.0, "total_loss": 0.038265880197286606, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 160768, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.008967502973973751, "entropy": 4.016837120056152, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": 0.035493895411491394, "vf_explained_var": 0.8261390924453735, "num_module_steps_trained_lifetime_throughput": 12289.85474469444}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 482304, "learner_connector_sum_episodes_length_in": 4000.0, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0016095261029759422, "add_observations_from_episodes_to_batch": 0.00013436712881288257, "add_columns_from_episodes_to_train_batch": 0.09303628125515609, "agent_to_module_mapping": 0.005463254215915979, "add_one_ts_to_episodes_and_truncate": 0.0064278321464499456, "add_time_dim_to_batch_and_zero_pad": 2.4584828063554592e-05, "batch_individual_items": 0.17952342027385781, "add_states_from_episodes_to_batch": 6.47231817629654e-06, "general_advantage_estimation": 0.05371270098220946}}, "connector_pipeline_timer": 0.3403593865625927}, "num_trainable_parameters": 626097, "num_env_steps_trained": 628000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 2512000, "num_env_steps_trained_lifetime_throughput": 192027.07048112215, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 36869.6731393064}, "agent_2": {"policy_loss": -0.021399814635515213, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.23865258693695068, "entropy": 4.004222869873047, "curr_kl_coeff": 0.20000000298023224, "total_loss": -0.013270382769405842, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "module_train_batch_size_mean": 256.0, "num_module_steps_trained": 40192, "vf_loss": 0.006324120797216892, "vf_loss_unclipped": 0.006324120797216892, "weights_seq_no": 4.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 160768, "mean_kl_loss": 0.009026523679494858, "num_module_steps_trained_lifetime_throughput": 12289.796864655165}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 16000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "19e99_00000", "date": "2025-10-21_10-15-47", "timestamp": 1761034547, "time_this_iter_s": 3.173656940460205, "time_total_s": 12.87134337425232, "pid": 3078166, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x7d37901bb910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.87134337425232, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 8.52, "ram_util_percent": 23.259999999999998}}
{"timers": {"training_iteration": 3.415003480165413, "restore_env_runners": 1.3640832689162925e-05, "training_step": 3.4148482495290247, "env_runner_sampling_timer": 1.305073975394386, "learner_update_timer": 2.1066153625689896, "synch_weights": 0.002776566374331619, "synch_env_connectors": 0.001432879590433498}, "env_runners": {"num_agent_steps_sampled": {"agent_0": 4000.0, "agent_1": 4000.0, "agent_2": 4000.0}, "weights_seq_no": 4.0, "num_module_steps_sampled_lifetime": {"agent_2": 20000.0, "agent_0": 20000.0, "agent_1": 20000.0}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8338250811211765e-05, "agent_to_module_mapping": 6.668735295534131e-06, "numpy_to_tensor": 6.384401058312501e-05, "add_observations_from_episodes_to_batch": 4.012801218777893e-05, "batch_individual_items": 4.2264480725862086e-05, "add_states_from_episodes_to_batch": 7.255017408169806e-06}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.592156835070403e-06, "add_states_from_episodes_to_batch": 5.33330292848554e-06, "agent_to_module_mapping": 4.477760140009173e-06, "numpy_to_tensor": 4.006115879895607e-05, "add_observations_from_episodes_to_batch": 2.2105575010289288e-05, "batch_individual_items": 2.4503050708412417e-05}}, "connector_pipeline_timer": 0.00015138551524385293}, "module_episode_returns_mean": {"agent_1": -1.1660000000000026, "agent_2": -3.809400000000012, "agent_0": -1.6656000000000037}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.749462313289595e-06, "listify_data_for_vector_env": 9.122626875608652e-06, "normalize_and_clip_actions": 3.3531297267222056e-05, "get_actions": 0.00022752432667130047, "un_batch_to_individual_items": 2.6090067894465196e-05, "remove_single_ts_time_rank_from_batch": 1.121917104548768e-06, "tensor_to_numpy": 6.035202207724239e-05}}, "connector_pipeline_timer": 0.0004222414667755537}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "episode_len_max": 500, "episode_duration_sec_mean": 0.6531576175417285, "episode_len_min": 500, "num_episodes_lifetime": 40.0, "episode_return_max": -3.7, "num_env_steps_sampled": 4000.0, "episode_return_min": -9.38000000000001, "rlmodule_inference_timer": 0.00016777367648169504, "env_step_timer": 0.0003720909484227648, "episode_len_mean": 500.0, "num_agent_steps_sampled_lifetime": {"agent_1": 20000.0, "agent_2": 20000.0, "agent_0": 20000.0}, "num_env_steps_sampled_lifetime": 20000.0, "num_episodes": 8.0, "connector_pipeline_timer": 0.00039966448093764484, "env_to_module_sum_episodes_length_out": 399.2474942228111, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_episode_returns_mean": {"agent_1": -1.1660000000000026, "agent_2": -3.809400000000012, "agent_0": -1.6656000000000037}, "sample": 1.2767175598931118, "env_reset_timer": 0.0007886717503424734, "episode_return_mean": -6.641000000000019, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "time_between_sampling": 2.1592554572494818, "num_env_steps_sampled_lifetime_throughput": 1179.1231139122565}, "learners": {"agent_0": {"entropy": 3.9973459243774414, "num_module_steps_trained": 40192, "vf_loss_unclipped": 0.004960663616657257, "weights_seq_no": 5.0, "total_loss": -0.06538059562444687, "module_train_batch_size_mean": 256.0, "vf_loss": 0.004960663616657257, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 200960, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.009321074932813644, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": -0.07220546901226044, "vf_explained_var": 0.5741564035415649, "num_module_steps_trained_lifetime_throughput": 12266.491218164794}, "agent_1": {"num_module_steps_trained": 40192, "vf_loss": 0.004962880164384842, "vf_loss_unclipped": 0.004962880164384842, "weights_seq_no": 5.0, "total_loss": 0.03358966112136841, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 200960, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.00821386557072401, "entropy": 4.00730562210083, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": 0.02698400989174843, "vf_explained_var": 0.6940518021583557, "num_module_steps_trained_lifetime_throughput": 12266.467234313073}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 602880, "learner_connector_sum_episodes_length_in": 4000.0, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0016062309417400043, "add_observations_from_episodes_to_batch": 0.0001344344676867273, "add_columns_from_episodes_to_train_batch": 0.09305959338299691, "agent_to_module_mapping": 0.005462959883786347, "add_one_ts_to_episodes_and_truncate": 0.00642262181491782, "add_time_dim_to_batch_and_zero_pad": 2.4569349406669493e-05, "batch_individual_items": 0.17974753364114088, "add_states_from_episodes_to_batch": 6.4715349458938e-06, "general_advantage_estimation": 0.05325894596228203}}, "connector_pipeline_timer": 0.3401422278970079}, "num_trainable_parameters": 626097, "num_env_steps_trained": 628000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 3140000, "num_env_steps_trained_lifetime_throughput": 191661.8132541898, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 36799.5085689981}, "agent_2": {"policy_loss": 0.07186039537191391, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.4106394052505493, "entropy": 3.9830782413482666, "curr_kl_coeff": 0.20000000298023224, "total_loss": 0.07817142456769943, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "module_train_batch_size_mean": 256.0, "num_module_steps_trained": 40192, "vf_loss": 0.004355753306299448, "vf_loss_unclipped": 0.004355753306299448, "weights_seq_no": 5.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 200960, "mean_kl_loss": 0.009776338003575802, "num_module_steps_trained_lifetime_throughput": 12266.414185347705}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 20000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "19e99_00000", "date": "2025-10-21_10-15-50", "timestamp": 1761034550, "time_this_iter_s": 3.387141466140747, "time_total_s": 16.258484840393066, "pid": 3078166, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x7d379016dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.258484840393066, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 11.219999999999999, "ram_util_percent": 23.560000000000002}}
{"timers": {"training_iteration": 3.412261873543907, "restore_env_runners": 1.3622564377091096e-05, "training_step": 3.412104465123198, "env_runner_sampling_timer": 1.3051697972801748, "learner_update_timer": 2.1037587392237374, "synch_weights": 0.0027847996110092663, "synch_env_connectors": 0.0014329478348879077}, "env_runners": {"num_agent_steps_sampled": {"agent_0": 4000.0, "agent_1": 4000.0, "agent_2": 4000.0}, "weights_seq_no": 5.0, "num_module_steps_sampled_lifetime": {"agent_2": 24000.0, "agent_0": 24000.0, "agent_1": 24000.0}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8338250811211765e-05, "agent_to_module_mapping": 6.668735295534131e-06, "numpy_to_tensor": 6.384401058312501e-05, "add_observations_from_episodes_to_batch": 4.012801218777893e-05, "batch_individual_items": 4.2264480725862086e-05, "add_states_from_episodes_to_batch": 7.255017408169806e-06}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.680238160681e-06, "add_states_from_episodes_to_batch": 4.910276059095287e-06, "agent_to_module_mapping": 4.063966315875358e-06, "numpy_to_tensor": 3.667839767393819e-05, "add_observations_from_episodes_to_batch": 2.0326422605876395e-05, "batch_individual_items": 2.226628842716674e-05}}, "connector_pipeline_timer": 0.00013899307409650765}, "module_episode_returns_mean": {"agent_1": -1.021400000000002, "agent_2": -3.7130000000000103, "agent_0": -1.790000000000005}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.4983809519725063e-06, "listify_data_for_vector_env": 8.608975191765047e-06, "normalize_and_clip_actions": 3.1155845402963416e-05, "get_actions": 0.00020462666012897288, "un_batch_to_individual_items": 2.4303988225648063e-05, "remove_single_ts_time_rank_from_batch": 1.036495174417307e-06, "tensor_to_numpy": 5.518363000366558e-05}}, "connector_pipeline_timer": 0.00038476441642570377}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "episode_len_max": 500, "episode_duration_sec_mean": 0.6497181208134861, "episode_len_min": 500, "num_episodes_lifetime": 48.0, "episode_return_max": -3.7700000000000005, "num_env_steps_sampled": 4000.0, "episode_return_min": -9.38000000000001, "rlmodule_inference_timer": 0.00014386439888546397, "env_step_timer": 0.00032218797675420143, "episode_len_mean": 500.0, "num_agent_steps_sampled_lifetime": {"agent_1": 24000.0, "agent_2": 24000.0, "agent_0": 24000.0}, "num_env_steps_sampled_lifetime": 24000.0, "num_episodes": 8.0, "connector_pipeline_timer": 0.00039966448093764484, "env_to_module_sum_episodes_length_out": 399.2474942228111, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_episode_returns_mean": {"agent_1": -1.021400000000002, "agent_2": -3.7130000000000103, "agent_0": -1.790000000000005}, "sample": 1.2767693732616638, "env_reset_timer": 0.0007886717503424734, "episode_return_mean": -6.524400000000018, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "time_between_sampling": 2.1582738151021688, "num_env_steps_sampled_lifetime_throughput": 1180.081493444871}, "learners": {"agent_0": {"entropy": 3.9871559143066406, "num_module_steps_trained": 40192, "vf_loss_unclipped": 0.0009066617931239307, "weights_seq_no": 6.0, "total_loss": 0.031209871172904968, "module_train_batch_size_mean": 256.0, "vf_loss": 0.0009066617931239307, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 241152, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.010973991826176643, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": 0.028108419850468636, "vf_explained_var": 0.8500229120254517, "num_module_steps_trained_lifetime_throughput": 12290.067332655177}, "agent_1": {"num_module_steps_trained": 40192, "vf_loss": 0.0011071418412029743, "vf_loss_unclipped": 0.0011071418412029743, "weights_seq_no": 6.0, "total_loss": 0.06548815220594406, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 241152, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.008472602814435959, "entropy": 3.996295928955078, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": 0.062686488032341, "vf_explained_var": 0.8187689781188965, "num_module_steps_trained_lifetime_throughput": 12290.046960546786}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 723456, "learner_connector_sum_episodes_length_in": 4000.0, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0016030972226175092, "add_observations_from_episodes_to_batch": 0.0001344588429778735, "add_columns_from_episodes_to_train_batch": 0.09305877786885003, "agent_to_module_mapping": 0.005459994944934756, "add_one_ts_to_episodes_and_truncate": 0.006414363156806612, "add_time_dim_to_batch_and_zero_pad": 2.4527946175957575e-05, "batch_individual_items": 0.17857327162465225, "add_states_from_episodes_to_batch": 6.462779859560461e-06, "general_advantage_estimation": 0.052808714722902106}}, "connector_pipeline_timer": 0.33849998031816575}, "num_trainable_parameters": 626097, "num_env_steps_trained": 628000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 3768000, "num_env_steps_trained_lifetime_throughput": 192030.09073696946, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 36870.27093763684}, "agent_2": {"policy_loss": 0.011865641921758652, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.3828384280204773, "entropy": 3.9738621711730957, "curr_kl_coeff": 0.20000000298023224, "total_loss": 0.020234068855643272, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "module_train_batch_size_mean": 256.0, "num_module_steps_trained": 40192, "vf_loss": 0.006413456052541733, "vf_loss_unclipped": 0.006413456052541733, "weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 241152, "mean_kl_loss": 0.009774848818778992, "num_module_steps_trained_lifetime_throughput": 12289.983510197422}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 24000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "19e99_00000", "date": "2025-10-21_10-15-53", "timestamp": 1761034553, "time_this_iter_s": 3.148292303085327, "time_total_s": 19.406777143478394, "pid": 3078166, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x7d37901bbd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.406777143478394, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 10.124999999999998, "ram_util_percent": 23.6}}
{"timers": {"training_iteration": 3.4104998861389886, "restore_env_runners": 1.3629428879913935e-05, "training_step": 3.4103403747418923, "env_runner_sampling_timer": 1.3054254862275785, "learner_update_timer": 2.1017451764017445, "synch_weights": 0.0027784059552118036, "synch_env_connectors": 0.0014434979068675068}, "env_runners": {"num_agent_steps_sampled": {"agent_0": 4000.0, "agent_1": 4000.0, "agent_2": 4000.0}, "weights_seq_no": 6.0, "num_module_steps_sampled_lifetime": {"agent_2": 28000.0, "agent_0": 28000.0, "agent_1": 28000.0}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8338250811211765e-05, "agent_to_module_mapping": 6.668735295534131e-06, "numpy_to_tensor": 6.384401058312501e-05, "add_observations_from_episodes_to_batch": 4.012801218777893e-05, "batch_individual_items": 4.2264480725862086e-05, "add_states_from_episodes_to_batch": 7.255017408169806e-06}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.584395953633433e-06, "add_states_from_episodes_to_batch": 4.910304961934963e-06, "agent_to_module_mapping": 4.021171809351144e-06, "numpy_to_tensor": 3.635569229551988e-05, "add_observations_from_episodes_to_batch": 2.0174112235954322e-05, "batch_individual_items": 2.210830339018314e-05}}, "connector_pipeline_timer": 0.0001377884098845573}, "module_episode_returns_mean": {"agent_1": -0.9676000000000018, "agent_2": -3.8676000000000124, "agent_0": -1.697200000000004}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.4257580097459285e-06, "listify_data_for_vector_env": 8.459585432936629e-06, "normalize_and_clip_actions": 3.0644336713994536e-05, "get_actions": 0.00020539321413817047, "un_batch_to_individual_items": 2.3891929718021678e-05, "remove_single_ts_time_rank_from_batch": 1.025187557414798e-06, "tensor_to_numpy": 5.493382626226646e-05}}, "connector_pipeline_timer": 0.0003836133844880802}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "episode_len_max": 500, "episode_duration_sec_mean": 0.64378552067501, "episode_len_min": 500, "num_episodes_lifetime": 56.0, "episode_return_max": -3.399999999999997, "num_env_steps_sampled": 4000.0, "episode_return_min": -9.340000000000021, "rlmodule_inference_timer": 0.00014323307522996748, "env_step_timer": 0.0003266148747594576, "episode_len_mean": 500.0, "num_agent_steps_sampled_lifetime": {"agent_1": 28000.0, "agent_2": 28000.0, "agent_0": 28000.0}, "num_env_steps_sampled_lifetime": 28000.0, "num_episodes": 8.0, "connector_pipeline_timer": 0.00039966448093764484, "env_to_module_sum_episodes_length_out": 399.2474942228111, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_episode_returns_mean": {"agent_1": -0.9676000000000018, "agent_2": -3.8676000000000124, "agent_0": -1.697200000000004}, "sample": 1.276963646964305, "env_reset_timer": 0.0007886717503424734, "episode_return_mean": -6.532400000000019, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "time_between_sampling": 2.1554879363786767, "num_env_steps_sampled_lifetime_throughput": 1184.0170390786811}, "learners": {"agent_0": {"entropy": 3.9816951751708984, "num_module_steps_trained": 40192, "vf_loss_unclipped": 0.0024634022265672684, "weights_seq_no": 7.0, "total_loss": -0.03969287872314453, "module_train_batch_size_mean": 256.0, "vf_loss": 0.0024634022265672684, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 281344, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.008136080577969551, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": -0.04378349334001541, "vf_explained_var": 0.4340273141860962, "num_module_steps_trained_lifetime_throughput": 12292.180380891084}, "agent_1": {"num_module_steps_trained": 40192, "vf_loss": 0.0010948632843792439, "vf_loss_unclipped": 0.0010948632843792439, "weights_seq_no": 7.0, "total_loss": -0.055532943457365036, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 281344, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.008824270218610764, "entropy": 3.9985461235046387, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": -0.058392658829689026, "vf_explained_var": 0.8387646675109863, "num_module_steps_trained_lifetime_throughput": 12292.159122144692}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 844032, "learner_connector_sum_episodes_length_in": 4000.0, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0015991707005342764, "add_observations_from_episodes_to_batch": 0.00013440756474516498, "add_columns_from_episodes_to_train_batch": 0.09303648241025281, "agent_to_module_mapping": 0.00545678321564847, "add_one_ts_to_episodes_and_truncate": 0.006404122844878631, "add_time_dim_to_batch_and_zero_pad": 2.4494796967401212e-05, "batch_individual_items": 0.17865859223807468, "add_states_from_episodes_to_batch": 6.456871949294362e-06, "general_advantage_estimation": 0.052365550685644066}}, "connector_pipeline_timer": 0.3381000439447895}, "num_trainable_parameters": 626097, "num_env_steps_trained": 628000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 4396000, "num_env_steps_trained_lifetime_throughput": 192063.41121987655, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 36876.568770470665}, "agent_2": {"policy_loss": -0.05426459386944771, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.20057988166809082, "entropy": 3.9526593685150146, "curr_kl_coeff": 0.20000000298023224, "total_loss": -0.04608593136072159, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "module_train_batch_size_mean": 256.0, "num_module_steps_trained": 40192, "vf_loss": 0.00628597941249609, "vf_loss_unclipped": 0.00628597941249609, "weights_seq_no": 7.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 281344, "mean_kl_loss": 0.009463454596698284, "num_module_steps_trained_lifetime_throughput": 12292.109775278594}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 28000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "19e99_00000", "date": "2025-10-21_10-15-57", "timestamp": 1761034557, "time_this_iter_s": 3.2401888370513916, "time_total_s": 22.646965980529785, "pid": 3078166, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x7d37901bb910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.646965980529785, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 9.000000000000002, "ram_util_percent": 23.5}}
{"timers": {"training_iteration": 3.407995739867653, "restore_env_runners": 1.3590824508425868e-05, "training_step": 3.4078353300847493, "env_runner_sampling_timer": 1.3058362928755172, "learner_update_timer": 2.098832738297533, "synch_weights": 0.002774503235244163, "synch_env_connectors": 0.001447373818099031}, "env_runners": {"num_agent_steps_sampled": {"agent_0": 4000.0, "agent_1": 4000.0, "agent_2": 4000.0}, "weights_seq_no": 7.0, "num_module_steps_sampled_lifetime": {"agent_2": 32000.0, "agent_0": 32000.0, "agent_1": 32000.0}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8338250811211765e-05, "agent_to_module_mapping": 6.668735295534131e-06, "numpy_to_tensor": 6.384401058312501e-05, "add_observations_from_episodes_to_batch": 4.012801218777893e-05, "batch_individual_items": 4.2264480725862086e-05, "add_states_from_episodes_to_batch": 7.255017408169806e-06}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.850360428364399e-06, "add_states_from_episodes_to_batch": 5.027488620371119e-06, "agent_to_module_mapping": 4.17250378559962e-06, "numpy_to_tensor": 3.760737125283241e-05, "add_observations_from_episodes_to_batch": 2.0678640335863754e-05, "batch_individual_items": 2.28013297423378e-05}}, "connector_pipeline_timer": 0.00014207271844677338}, "module_episode_returns_mean": {"agent_1": -0.9552000000000018, "agent_2": -3.8809000000000125, "agent_0": -1.184300000000002}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.539159355164647e-06, "listify_data_for_vector_env": 8.750101038754509e-06, "normalize_and_clip_actions": 3.16468051291689e-05, "get_actions": 0.00021027291625899772, "un_batch_to_individual_items": 2.4822367292490585e-05, "remove_single_ts_time_rank_from_batch": 1.055067984923136e-06, "tensor_to_numpy": 5.65695482721618e-05}}, "connector_pipeline_timer": 0.0003941075414601757}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "episode_len_max": 500, "episode_duration_sec_mean": 0.6408497840922791, "episode_len_min": 500, "num_episodes_lifetime": 64.0, "episode_return_max": -3.399999999999997, "num_env_steps_sampled": 4000.0, "episode_return_min": -9.340000000000021, "rlmodule_inference_timer": 0.00014880387657934116, "env_step_timer": 0.0003419160639719916, "episode_len_mean": 500.0, "num_agent_steps_sampled_lifetime": {"agent_1": 32000.0, "agent_2": 32000.0, "agent_0": 32000.0}, "num_env_steps_sampled_lifetime": 32000.0, "num_episodes": 8.0, "connector_pipeline_timer": 0.00039966448093764484, "env_to_module_sum_episodes_length_out": 399.2474942228111, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_episode_returns_mean": {"agent_1": -0.9552000000000018, "agent_2": -3.8809000000000125, "agent_0": -1.184300000000002}, "sample": 1.277246966124781, "env_reset_timer": 0.0007886717503424734, "episode_return_mean": -6.020400000000016, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "time_between_sampling": 2.153503516954895, "num_env_steps_sampled_lifetime_throughput": 1185.9926351492877}, "learners": {"agent_0": {"entropy": 3.980377674102783, "num_module_steps_trained": 40192, "vf_loss_unclipped": 0.0010222607525065541, "weights_seq_no": 8.0, "total_loss": -0.06410148739814758, "module_train_batch_size_mean": 256.0, "vf_loss": 0.0010222607525065541, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 321536, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.009958896785974503, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": -0.06711553037166595, "vf_explained_var": 0.8056262731552124, "num_module_steps_trained_lifetime_throughput": 12310.029673534147}, "agent_1": {"num_module_steps_trained": 40192, "vf_loss": 0.0009307171567343175, "vf_loss_unclipped": 0.0009307171567343175, "weights_seq_no": 8.0, "total_loss": 0.06919021159410477, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 321536, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.008381279185414314, "entropy": 3.9862453937530518, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": 0.06658324599266052, "vf_explained_var": 0.8471000790596008, "num_module_steps_trained_lifetime_throughput": 12310.011341017733}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 964608, "learner_connector_sum_episodes_length_in": 4000.0, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0015962954734966544, "add_observations_from_episodes_to_batch": 0.00013444884947182875, "add_columns_from_episodes_to_train_batch": 0.09302650297620471, "agent_to_module_mapping": 0.005454382963489317, "add_one_ts_to_episodes_and_truncate": 0.0063952951660698745, "add_time_dim_to_batch_and_zero_pad": 2.4457668973639772e-05, "batch_individual_items": 0.17750425473584583, "add_states_from_episodes_to_batch": 6.452053393729093e-06, "general_advantage_estimation": 0.051935552018823314}}, "connector_pipeline_timer": 0.33648931926555076}, "num_trainable_parameters": 626097, "num_env_steps_trained": 628000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 5024000, "num_env_steps_trained_lifetime_throughput": 192342.37033916492, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 36930.12833429017}, "agent_2": {"policy_loss": -0.13392062485218048, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.24848031997680664, "entropy": 3.935002326965332, "curr_kl_coeff": 0.20000000298023224, "total_loss": -0.12224721908569336, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "module_train_batch_size_mean": 256.0, "num_module_steps_trained": 40192, "vf_loss": 0.00964501965790987, "vf_loss_unclipped": 0.00964501965790987, "weights_seq_no": 8.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 321536, "mean_kl_loss": 0.010141866281628609, "num_module_steps_trained_lifetime_throughput": 12309.961670244413}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 32000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "19e99_00000", "date": "2025-10-21_10-16-00", "timestamp": 1761034560, "time_this_iter_s": 3.164264678955078, "time_total_s": 25.811230659484863, "pid": 3078166, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x7d37901d9360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.811230659484863, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 10.350000000000001, "ram_util_percent": 23.55}}
{"timers": {"training_iteration": 3.4068582539091596, "restore_env_runners": 1.355028660536528e-05, "training_step": 3.4066969008234302, "env_runner_sampling_timer": 1.3059211491867717, "learner_update_timer": 2.0976090933043534, "synch_weights": 0.002773751913090161, "synch_env_connectors": 0.0014524128600451563}, "env_runners": {"num_agent_steps_sampled": {"agent_0": 4000.0, "agent_1": 4000.0, "agent_2": 4000.0}, "weights_seq_no": 8.0, "num_module_steps_sampled_lifetime": {"agent_2": 36000.0, "agent_0": 36000.0, "agent_1": 36000.0}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8338250811211765e-05, "agent_to_module_mapping": 6.668735295534131e-06, "numpy_to_tensor": 6.384401058312501e-05, "add_observations_from_episodes_to_batch": 4.012801218777893e-05, "batch_individual_items": 4.2264480725862086e-05, "add_states_from_episodes_to_batch": 7.255017408169806e-06}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.728323756981016e-06, "add_states_from_episodes_to_batch": 4.953401415969454e-06, "agent_to_module_mapping": 4.075686262471528e-06, "numpy_to_tensor": 3.6892149598342135e-05, "add_observations_from_episodes_to_batch": 2.0580194043766894e-05, "batch_individual_items": 2.2383180338285563e-05}}, "connector_pipeline_timer": 0.00014042058403945077}, "module_episode_returns_mean": {"agent_1": -0.8818000000000012, "agent_2": -3.8593000000000126, "agent_0": -0.9488000000000006}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.493409590424388e-06, "listify_data_for_vector_env": 8.562531675788904e-06, "normalize_and_clip_actions": 3.105424673210533e-05, "get_actions": 0.00020593244874002862, "un_batch_to_individual_items": 2.4338250677937084e-05, "remove_single_ts_time_rank_from_batch": 1.034067402106449e-06, "tensor_to_numpy": 5.5463905731657075e-05}}, "connector_pipeline_timer": 0.0003864828264487759}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "episode_len_max": 500, "episode_duration_sec_mean": 0.638797190572368, "episode_len_min": 500, "num_episodes_lifetime": 72.0, "episode_return_max": -3.399999999999997, "num_env_steps_sampled": 4000.0, "episode_return_min": -9.340000000000021, "rlmodule_inference_timer": 0.00014554860879604663, "env_step_timer": 0.00032818126587540316, "episode_len_mean": 500.0, "num_agent_steps_sampled_lifetime": {"agent_1": 36000.0, "agent_2": 36000.0, "agent_0": 36000.0}, "num_env_steps_sampled_lifetime": 36000.0, "num_episodes": 8.0, "connector_pipeline_timer": 0.00039966448093764484, "env_to_module_sum_episodes_length_out": 399.2474942228111, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_episode_returns_mean": {"agent_1": -0.8818000000000012, "agent_2": -3.8593000000000126, "agent_0": -0.9488000000000006}, "sample": 1.2773153271211934, "env_reset_timer": 0.0007886717503424734, "episode_return_mean": -5.689900000000014, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "time_between_sampling": 2.1506633804855424, "num_env_steps_sampled_lifetime_throughput": 1190.3368156951228}, "learners": {"agent_0": {"entropy": 3.9736149311065674, "num_module_steps_trained": 40192, "vf_loss_unclipped": 0.0026497477665543556, "weights_seq_no": 9.0, "total_loss": -0.15019318461418152, "module_train_batch_size_mean": 256.0, "vf_loss": 0.0026497477665543556, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 361728, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.007782570086419582, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": -0.15439942479133606, "vf_explained_var": 0.44470709562301636, "num_module_steps_trained_lifetime_throughput": 12301.926903436903}, "agent_1": {"num_module_steps_trained": 40192, "vf_loss": 0.002012064913287759, "vf_loss_unclipped": 0.002012064913287759, "weights_seq_no": 9.0, "total_loss": -0.04599199816584587, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 361728, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.008661920204758644, "entropy": 3.9728810787200928, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": -0.049736447632312775, "vf_explained_var": 0.6582910418510437, "num_module_steps_trained_lifetime_throughput": 12301.907533090658}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 1085184, "learner_connector_sum_episodes_length_in": 4000.0, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0015929465787221573, "add_observations_from_episodes_to_batch": 0.0001345991412763642, "add_columns_from_episodes_to_train_batch": 0.09324833999611563, "agent_to_module_mapping": 0.005451485484038879, "add_one_ts_to_episodes_and_truncate": 0.006390782264217648, "add_time_dim_to_batch_and_zero_pad": 2.440617175176622e-05, "batch_individual_items": 0.17759802475837008, "add_states_from_episodes_to_batch": 6.4485932781666384e-06, "general_advantage_estimation": 0.05149903068874203}}, "connector_pipeline_timer": 0.3363554490129125}, "num_trainable_parameters": 626097, "num_env_steps_trained": 628000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 5652000, "num_env_steps_trained_lifetime_throughput": 192215.85336862967, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 36905.806485912166}, "agent_2": {"policy_loss": 0.0868726372718811, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.41454458236694336, "entropy": 3.9120357036590576, "curr_kl_coeff": 0.20000000298023224, "total_loss": 0.09624698758125305, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "module_train_batch_size_mean": 256.0, "num_module_steps_trained": 40192, "vf_loss": 0.007527838461101055, "vf_loss_unclipped": 0.007527838461101055, "weights_seq_no": 9.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 361728, "mean_kl_loss": 0.009232531301677227, "num_module_steps_trained_lifetime_throughput": 12301.86269208483}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 36000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "19e99_00000", "date": "2025-10-21_10-16-03", "timestamp": 1761034563, "time_this_iter_s": 3.2984962463378906, "time_total_s": 29.109726905822754, "pid": 3078166, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x7d37901d9f30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.109726905822754, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 9.360000000000001, "ram_util_percent": 23.559999999999995}}
{"timers": {"training_iteration": 3.4040536340596224, "restore_env_runners": 1.3511143611570828e-05, "training_step": 3.403891411155224, "env_runner_sampling_timer": 1.3066345093347602, "learner_update_timer": 2.094095228561565, "synch_weights": 0.0027683633540059155, "synch_env_connectors": 0.0014580491614392805}, "env_runners": {"num_agent_steps_sampled": {"agent_0": 4000.0, "agent_1": 4000.0, "agent_2": 4000.0}, "weights_seq_no": 9.0, "num_module_steps_sampled_lifetime": {"agent_2": 40000.0, "agent_0": 40000.0, "agent_1": 40000.0}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8338250811211765e-05, "agent_to_module_mapping": 6.668735295534131e-06, "numpy_to_tensor": 6.384401058312501e-05, "add_observations_from_episodes_to_batch": 4.012801218777893e-05, "batch_individual_items": 4.2264480725862086e-05, "add_states_from_episodes_to_batch": 7.255017408169806e-06}}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.700788751488939e-06, "add_states_from_episodes_to_batch": 4.947563419024003e-06, "agent_to_module_mapping": 4.11464845754781e-06, "numpy_to_tensor": 3.716418013372566e-05, "add_observations_from_episodes_to_batch": 2.068620976988157e-05, "batch_individual_items": 2.2502611381326664e-05}}, "connector_pipeline_timer": 0.00014056129880992901}, "module_episode_returns_mean": {"agent_1": -0.955800000000001, "agent_2": -3.7275000000000102, "agent_0": -1.1457000000000013}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.5197414557736537e-06, "listify_data_for_vector_env": 8.590878828081133e-06, "normalize_and_clip_actions": 3.1174275578471016e-05, "get_actions": 0.00020724642201270485, "un_batch_to_individual_items": 2.4289573942142704e-05, "remove_single_ts_time_rank_from_batch": 1.0418866973686362e-06, "tensor_to_numpy": 5.564408762365933e-05}}, "connector_pipeline_timer": 0.00038806971190686956}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "episode_len_max": 500, "episode_duration_sec_mean": 0.6427914204302942, "episode_len_min": 500, "num_episodes_lifetime": 80.0, "episode_return_max": -3.7300000000000004, "num_env_steps_sampled": 4000.0, "episode_return_min": -10.700000000000031, "rlmodule_inference_timer": 0.0001438487895380505, "env_step_timer": 0.00034739164028653273, "episode_len_mean": 500.0, "num_agent_steps_sampled_lifetime": {"agent_1": 40000.0, "agent_2": 40000.0, "agent_0": 40000.0}, "num_env_steps_sampled_lifetime": 40000.0, "num_episodes": 8.0, "connector_pipeline_timer": 0.00039966448093764484, "env_to_module_sum_episodes_length_out": 399.2474942228111, "env_to_module_sum_episodes_length_in": 399.2474942228111, "agent_episode_returns_mean": {"agent_1": -0.955800000000001, "agent_2": -3.7275000000000102, "agent_0": -1.1457000000000013}, "sample": 1.2777391182001838, "env_reset_timer": 0.0007886717503424734, "episode_return_mean": -5.829000000000012, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "time_between_sampling": 2.149389338588093, "num_env_steps_sampled_lifetime_throughput": 1190.1583784482941}, "learners": {"agent_0": {"entropy": 3.9525623321533203, "num_module_steps_trained": 40192, "vf_loss_unclipped": 0.00268066325224936, "weights_seq_no": 10.0, "total_loss": 0.032255616039037704, "module_train_batch_size_mean": 256.0, "vf_loss": 0.00268066325224936, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 401920, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.008781630545854568, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": 0.027818620204925537, "vf_explained_var": 0.7309157848358154, "num_module_steps_trained_lifetime_throughput": 12326.80332212741}, "agent_1": {"num_module_steps_trained": 40192, "vf_loss": 0.0021701939404010773, "vf_loss_unclipped": 0.0021701939404010773, "weights_seq_no": 10.0, "total_loss": -0.02291470766067505, "module_train_batch_size_mean": 256.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 401920, "default_optimizer_learning_rate": 5e-05, "mean_kl_loss": 0.00950971432030201, "entropy": 3.974806785583496, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "policy_loss": -0.02698684297502041, "vf_explained_var": 0.7055976390838623, "num_module_steps_trained_lifetime_throughput": 12326.784725662756}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 1205760, "learner_connector_sum_episodes_length_in": 4000.0, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.001590191152712304, "add_observations_from_episodes_to_batch": 0.0001345751593478842, "add_columns_from_episodes_to_train_batch": 0.09328389702660715, "agent_to_module_mapping": 0.005449047539122416, "add_one_ts_to_episodes_and_truncate": 0.006381686341474976, "add_time_dim_to_batch_and_zero_pad": 2.439124041689816e-05, "batch_individual_items": 0.17645518438068306, "add_states_from_episodes_to_batch": 6.4442771865478324e-06, "general_advantage_estimation": 0.05106802747189275}}, "connector_pipeline_timer": 0.3348006924226498}, "num_trainable_parameters": 626097, "num_env_steps_trained": 628000, "num_module_steps_trained": 120576, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime": 6280000, "num_env_steps_trained_lifetime_throughput": 192604.73187012336, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 36980.43224477155}, "agent_2": {"policy_loss": -0.17641155421733856, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.23444855213165283, "entropy": 3.8919339179992676, "curr_kl_coeff": 0.20000000298023224, "total_loss": -0.16427920758724213, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 208699, "module_train_batch_size_mean": 256.0, "num_module_steps_trained": 40192, "vf_loss": 0.010209761559963226, "vf_loss_unclipped": 0.010209761559963226, "weights_seq_no": 10.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 401920, "mean_kl_loss": 0.009612956084311008, "num_module_steps_trained_lifetime_throughput": 12326.747372458378}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 40000.0, "evaluation": {"env_runners": {"timers": {"connectors": {"batch_individual_items": 3.020599251613021e-05, "add_states_from_episodes_to_batch": 5.797017365694046e-06, "numpy_to_tensor": 4.289404023438692e-05, "add_observations_from_episodes_to_batch": 2.9608025215566158e-05, "add_time_dim_to_batch_and_zero_pad": 1.3293989468365908e-05, "agent_to_module_mapping": 4.942005034536123e-06}}, "num_module_steps_sampled": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 3.933301583431037e-06, "batch_individual_items": 2.1104490105953942e-05, "add_states_from_episodes_to_batch": 4.733246339619247e-06, "numpy_to_tensor": 3.4361492004675064e-05, "add_observations_from_episodes_to_batch": 1.996566105545313e-05, "add_time_dim_to_batch_and_zero_pad": 8.45352428199113e-06}}, "connector_pipeline_timer": 0.0001328141032550575}, "agent_episode_returns_mean": {"agent_1": -0.5000000000000003, "agent_2": -0.8099999999999987, "agent_0": -0.5000000000000003}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0471740608352084e-06, "module_to_agent_unmapping": 3.483599043879883e-06, "get_actions": 9.405057016324399e-05, "un_batch_to_individual_items": 2.250690775949199e-05, "normalize_and_clip_actions": 2.9280455764324973e-05, "listify_data_for_vector_env": 8.414866994367327e-06, "tensor_to_numpy": 5.2231563258691365e-05}}, "connector_pipeline_timer": 0.0002619574010904324}, "num_episodes_lifetime": 5, "episode_return_min": -3.0499999999999927, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "num_agent_steps_sampled": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "num_module_steps_sampled_lifetime": {"agent_2": 2500, "agent_0": 2500, "agent_1": 2500}, "num_env_steps_sampled_lifetime": 2500, "module_episode_returns_mean": {"agent_2": -0.8099999999999987, "agent_0": -0.5000000000000003, "agent_1": -0.5000000000000003}, "episode_return_mean": -1.8099999999999994, "weights_seq_no": 10.0, "num_agent_steps_sampled_lifetime": {"agent_1": 2500, "agent_2": 2500, "agent_0": 2500}, "episode_len_min": 500, "num_env_steps_sampled": 2500, "env_to_module_sum_episodes_length_in": 404.24749421816176, "env_reset_timer": 0.0007432889542542398, "episode_duration_sec_mean": 0.5556219383841381, "episode_return_max": -1.5000000000000009, "rlmodule_inference_timer": 0.0001298468584842249, "env_step_timer": 0.0003475934234804777, "connector_pipeline_timer": 0.00021880998974666, "env_to_module_sum_episodes_length_out": 404.24749421816176, "sample": 2.8165169379790314, "episode_len_max": 500, "episode_len_mean": 500.0, "num_episodes": 5}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 10, "trial_id": "19e99_00000", "date": "2025-10-21_10-16-09", "timestamp": 1761034569, "time_this_iter_s": 5.955559492111206, "time_total_s": 35.06528639793396, "pid": 3078166, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-tiny-2agvs-1pickers-globalobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x7d37901d96c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.06528639793396, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 6.775, "ram_util_percent": 23.575000000000003}}
