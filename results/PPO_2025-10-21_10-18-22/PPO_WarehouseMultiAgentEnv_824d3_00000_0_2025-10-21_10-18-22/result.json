{"timers": {"training_iteration": 5.836541757977102, "restore_env_runners": 1.1966039892286062e-05, "training_step": 5.8363053080393, "env_runner_sampling_timer": 3.3904168090084568, "learner_update_timer": 2.4140863600187004, "synch_weights": 0.031187782995402813}, "env_runners": {"timers": {"connectors": {"agent_to_module_mapping": 6.088521331548691e-06, "add_states_from_episodes_to_batch": 2.5373505195602775e-05, "add_observations_from_episodes_to_batch": 3.293647023383528e-05, "numpy_to_tensor": 7.462802750524133e-05, "add_time_dim_to_batch_and_zero_pad": 4.3970998376607895e-05, "batch_individual_items": 3.675400512292981e-05}}, "weights_seq_no": 0.0, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.794092019942196e-06, "normalize_and_clip_actions": 3.2451032181062426e-05, "un_batch_to_individual_items": 2.5603419482232362e-05, "get_actions": 0.000249889834759614, "remove_single_ts_time_rank_from_batch": 1.1941054707835329e-06, "listify_data_for_vector_env": 9.057534632876578e-06, "tensor_to_numpy": 5.839745606153252e-05}}, "connector_pipeline_timer": 0.00043625283738554034}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "num_module_steps_sampled_lifetime": {"agent_2": 4000.0, "agent_0": 4000.0, "agent_1": 4000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.4031967032230304e-05, "numpy_to_tensor": 4.2560910503236404e-05, "add_time_dim_to_batch_and_zero_pad": 3.2418999944941824e-05, "batch_individual_items": 2.5919474527028786e-05, "agent_to_module_mapping": 4.873615430521636e-06, "add_states_from_episodes_to_batch": 2.1905068948559127e-05}}, "connector_pipeline_timer": 0.00019428921513639104}, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "num_env_steps_sampled_lifetime": 4000.0, "num_agent_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "connector_pipeline_timer": 0.00041634375520516187, "num_agent_steps_sampled_lifetime": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "env_step_timer": 0.0019995307381768584, "episode_return_max": -1.5000000000000009, "env_reset_timer": 0.003566243511158973, "episode_len_min": 500, "agent_episode_returns_mean": {"agent_1": -2.2775000000000096, "agent_2": -2.830000000000013, "agent_0": -0.5000000000000003}, "module_episode_returns_mean": {"agent_1": -2.2775000000000096, "agent_2": -2.830000000000013, "agent_0": -0.5000000000000003}, "episode_return_min": -10.59000000000005, "episode_len_mean": 500.0, "env_to_module_sum_episodes_length_out": 399.2306012071058, "num_episodes_lifetime": 8.0, "env_to_module_sum_episodes_length_in": 399.2306012071058, "episode_return_mean": -5.607500000000023, "rlmodule_inference_timer": 0.0002959713601660759, "sample": 3.3505830235226313, "num_env_steps_sampled": 4000.0, "episode_duration_sec_mean": 1.5979718253729516, "episode_len_max": 500, "num_episodes": 8.0, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"agent_5": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_1": {"curr_entropy_coeff": 0.0, "vf_loss": 0.0014886385761201382, "curr_kl_coeff": 0.20000000298023224, "vf_loss_unclipped": 0.0014886385761201382, "weights_seq_no": 1.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.8766971826553345, "num_module_steps_trained_lifetime": 40192, "num_trainable_parameters": 781541, "entropy": 6.1443328857421875, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "total_loss": -0.12348906695842743, "mean_kl_loss": 0.011645925231277943, "policy_loss": -0.12730692327022552, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_13": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.020718597050290555, "numpy_to_tensor": 0.006439946999307722, "add_time_dim_to_batch_and_zero_pad": 5.9601967222988605e-05, "add_columns_from_episodes_to_train_batch": 0.0942457570345141, "batch_individual_items": 0.2014723779866472, "agent_to_module_mapping": 0.005602352030109614, "add_states_from_episodes_to_batch": 2.729997504502535e-05, "general_advantage_estimation": 0.053815021994523704, "add_observations_from_episodes_to_batch": 0.0002174580004066229}}, "connector_pipeline_timer": 0.38306129700504243}, "num_trainable_parameters": 16412361, "num_module_steps_trained": 120576, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 120576, "learner_connector_sum_episodes_length_in": 4000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 628000, "learner_connector_sum_episodes_length_out": 4000, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_0": {"mean_kl_loss": 0.01164977252483368, "policy_loss": -0.05965495482087135, "curr_entropy_coeff": 0.0, "vf_loss": 0.0004272010119166225, "vf_loss_unclipped": 0.0004272010119166225, "weights_seq_no": 1.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.9735720753669739, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "entropy": 6.146358489990234, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 40192, "total_loss": -0.05689779669046402, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_10": {"num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05}, "agent_12": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_7": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_3": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_11": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_18": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_19": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_16": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_2": {"mean_kl_loss": 0.01215020939707756, "policy_loss": -0.07563888281583786, "curr_entropy_coeff": 0.0, "vf_loss": 0.0006021366571076214, "vf_loss_unclipped": 0.0006021366571076214, "weights_seq_no": 1.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.957529604434967, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 40192, "total_loss": -0.07260670512914658, "entropy": 6.143467426300049, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_4": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_8": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_17": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_9": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_20": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_14": {"default_optimizer_learning_rate": 5e-05, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541}, "agent_15": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_6": {"curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541, "default_optimizer_learning_rate": 5e-05}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 4000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "824d3_00000", "date": "2025-10-21_10-18-35", "timestamp": 1761034715, "time_this_iter_s": 5.845230340957642, "time_total_s": 5.845230340957642, "pid": 3083715, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-extralarge-14agvs-7pickers-partialobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x77b765efa8c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}], "agent_3": [null, null, null, {}], "agent_4": [null, null, null, {}], "agent_5": [null, null, null, {}], "agent_6": [null, null, null, {}], "agent_7": [null, null, null, {}], "agent_8": [null, null, null, {}], "agent_9": [null, null, null, {}], "agent_10": [null, null, null, {}], "agent_11": [null, null, null, {}], "agent_12": [null, null, null, {}], "agent_13": [null, null, null, {}], "agent_14": [null, null, null, {}], "agent_15": [null, null, null, {}], "agent_16": [null, null, null, {}], "agent_17": [null, null, null, {}], "agent_18": [null, null, null, {}], "agent_19": [null, null, null, {}], "agent_20": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.845230340957642, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 9.9125, "ram_util_percent": 23.3125, "gpu_util_percent0": 0.22749999999999998, "vram_util_percent0": 0.0722276502198339}}
{"timers": {"training_iteration": 5.830953170697321, "restore_env_runners": 1.1984319426119328e-05, "training_step": 5.830716005369322, "env_runner_sampling_timer": 3.38880799499806, "learner_update_timer": 2.4101030410284876, "synch_weights": 0.03119012518553063, "synch_env_connectors": 0.005145248956978321}, "env_runners": {"timers": {"connectors": {"agent_to_module_mapping": 6.088521331548691e-06, "add_states_from_episodes_to_batch": 2.5373505195602775e-05, "add_observations_from_episodes_to_batch": 3.293647023383528e-05, "numpy_to_tensor": 7.462802750524133e-05, "add_time_dim_to_batch_and_zero_pad": 4.3970998376607895e-05, "batch_individual_items": 3.675400512292981e-05}}, "weights_seq_no": 1.0, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.727554034458343e-06, "normalize_and_clip_actions": 3.1713891642276126e-05, "un_batch_to_individual_items": 2.4546640705030743e-05, "get_actions": 0.0002486380187097619, "remove_single_ts_time_rank_from_batch": 1.1728961140473243e-06, "listify_data_for_vector_env": 8.691220775703317e-06, "tensor_to_numpy": 5.7296732236429105e-05}}, "connector_pipeline_timer": 0.0004318491240072106}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "num_module_steps_sampled_lifetime": {"agent_2": 8000.0, "agent_0": 8000.0, "agent_1": 8000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.403474329745537e-05, "numpy_to_tensor": 4.263122756514078e-05, "add_time_dim_to_batch_and_zero_pad": 3.3372892629841657e-05, "batch_individual_items": 2.5864272211760618e-05, "agent_to_module_mapping": 4.789673431674308e-06, "add_states_from_episodes_to_batch": 2.2009264949555058e-05}}, "connector_pipeline_timer": 0.00019584538079098064}, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "num_env_steps_sampled_lifetime": 8000.0, "num_agent_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "connector_pipeline_timer": 0.00041634375520516187, "num_agent_steps_sampled_lifetime": {"agent_1": 8000.0, "agent_2": 8000.0, "agent_0": 8000.0}, "env_step_timer": 0.0019612274207565653, "episode_return_max": -1.5000000000000009, "env_reset_timer": 0.003566243511158973, "episode_len_min": 500, "agent_episode_returns_mean": {"agent_1": -1.6837500000000067, "agent_2": -2.25812500000001, "agent_0": -1.0806250000000035}, "module_episode_returns_mean": {"agent_1": -1.6837500000000067, "agent_2": -2.25812500000001, "agent_0": -1.0806250000000035}, "episode_return_min": -10.810000000000052, "episode_len_mean": 500.0, "env_to_module_sum_episodes_length_out": 399.24749350803154, "num_episodes_lifetime": 16.0, "env_to_module_sum_episodes_length_in": 399.24749350803154, "episode_return_mean": -5.02250000000002, "rlmodule_inference_timer": 0.0002939704904991777, "sample": 3.349026250797468, "num_env_steps_sampled": 4000.0, "episode_duration_sec_mean": 1.5912919883121504, "episode_len_max": 500, "num_episodes": 8.0, "time_between_sampling": 2.515296252007829, "num_env_steps_sampled_lifetime_throughput": 700.9889659124683}, "learners": {"agent_5": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_1": {"curr_entropy_coeff": 0.0, "vf_loss": 0.002260944340378046, "curr_kl_coeff": 0.20000000298023224, "vf_loss_unclipped": 0.002260944340378046, "weights_seq_no": 2.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.7740487456321716, "num_module_steps_trained_lifetime": 80384, "num_trainable_parameters": 781541, "entropy": 6.14055871963501, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "total_loss": -0.04504147171974182, "mean_kl_loss": 0.011706775985658169, "policy_loss": -0.04964376613497734, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_13": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.020619125769590026, "numpy_to_tensor": 0.0064371419593226165, "add_time_dim_to_batch_and_zero_pad": 5.952764768153429e-05, "add_columns_from_episodes_to_train_batch": 0.09424679183459375, "batch_individual_items": 0.20021159963682295, "agent_to_module_mapping": 0.0055982699495507405, "add_states_from_episodes_to_batch": 2.725527563598007e-05, "general_advantage_estimation": 0.05336781144433189, "add_observations_from_episodes_to_batch": 0.00021676303062122314}}, "connector_pipeline_timer": 0.38124467390473}, "num_trainable_parameters": 16412361, "num_module_steps_trained": 120576, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 241152, "learner_connector_sum_episodes_length_in": 4000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 1256000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_0": {"mean_kl_loss": 0.013241272419691086, "policy_loss": -0.08836643397808075, "curr_entropy_coeff": 0.0, "vf_loss": 0.00010635148646542802, "vf_loss_unclipped": 0.00010635148646542802, "weights_seq_no": 2.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.9924165606498718, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "entropy": 6.138799667358398, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 80384, "total_loss": -0.08561182022094727, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_10": {"num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05}, "agent_12": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_7": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_3": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_11": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_18": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_19": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_16": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_2": {"mean_kl_loss": 0.013041825965046883, "policy_loss": -0.00890277698636055, "curr_entropy_coeff": 0.0, "vf_loss": 0.0004704889142885804, "vf_loss_unclipped": 0.0004704889142885804, "weights_seq_no": 2.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.981469452381134, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 80384, "total_loss": -0.00582392793148756, "entropy": 6.137388229370117, "num_module_steps_trained_lifetime_throughput": NaN}, "agent_4": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_8": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_17": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_9": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_20": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_14": {"default_optimizer_learning_rate": 5e-05, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541}, "agent_15": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_6": {"curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541, "default_optimizer_learning_rate": 5e-05}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "824d3_00000", "date": "2025-10-21_10-18-41", "timestamp": 1761034721, "time_this_iter_s": 5.284330368041992, "time_total_s": 11.129560708999634, "pid": 3083715, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-extralarge-14agvs-7pickers-partialobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x77b765d6d1b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}], "agent_3": [null, null, null, {}], "agent_4": [null, null, null, {}], "agent_5": [null, null, null, {}], "agent_6": [null, null, null, {}], "agent_7": [null, null, null, {}], "agent_8": [null, null, null, {}], "agent_9": [null, null, null, {}], "agent_10": [null, null, null, {}], "agent_11": [null, null, null, {}], "agent_12": [null, null, null, {}], "agent_13": [null, null, null, {}], "agent_14": [null, null, null, {}], "agent_15": [null, null, null, {}], "agent_16": [null, null, null, {}], "agent_17": [null, null, null, {}], "agent_18": [null, null, null, {}], "agent_19": [null, null, null, {}], "agent_20": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.129560708999634, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 10.337499999999999, "ram_util_percent": 24.35, "gpu_util_percent0": 0.16000000000000003, "vram_util_percent0": 0.08030654616511969}}
{"timers": {"training_iteration": 5.826478396630491, "restore_env_runners": 1.1983056296594441e-05, "training_step": 5.826240720465837, "env_runner_sampling_timer": 3.387999377517984, "learner_update_timer": 2.4064431453479744, "synch_weights": 0.03118328850395046, "synch_env_connectors": 0.005126277067465707}, "env_runners": {"timers": {"connectors": {"agent_to_module_mapping": 6.088521331548691e-06, "add_states_from_episodes_to_batch": 2.5373505195602775e-05, "add_observations_from_episodes_to_batch": 3.293647023383528e-05, "numpy_to_tensor": 7.462802750524133e-05, "add_time_dim_to_batch_and_zero_pad": 4.3970998376607895e-05, "batch_individual_items": 3.675400512292981e-05}}, "weights_seq_no": 2.0, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.961643684443576e-06, "normalize_and_clip_actions": 3.3626839486427435e-05, "un_batch_to_individual_items": 2.6108244591227912e-05, "get_actions": 0.00026448007956502134, "remove_single_ts_time_rank_from_batch": 1.2928528140757521e-06, "listify_data_for_vector_env": 9.191931107720438e-06, "tensor_to_numpy": 6.045104011439155e-05}}, "connector_pipeline_timer": 0.0004579504584758931}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "num_module_steps_sampled_lifetime": {"agent_2": 12000.0, "agent_0": 12000.0, "agent_1": 12000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.560916201039837e-05, "numpy_to_tensor": 4.5595549045566525e-05, "add_time_dim_to_batch_and_zero_pad": 3.563469012425443e-05, "batch_individual_items": 2.7254173695022317e-05, "agent_to_module_mapping": 5.154583383466974e-06, "add_states_from_episodes_to_batch": 2.286601627169849e-05}}, "connector_pipeline_timer": 0.00020735851171047615}, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "num_env_steps_sampled_lifetime": 12000.0, "num_agent_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "connector_pipeline_timer": 0.00041634375520516187, "num_agent_steps_sampled_lifetime": {"agent_1": 12000.0, "agent_2": 12000.0, "agent_0": 12000.0}, "env_step_timer": 0.00205478976969362, "episode_return_max": -1.5000000000000009, "env_reset_timer": 0.003566243511158973, "episode_len_min": 500, "agent_episode_returns_mean": {"agent_1": -2.068750000000009, "agent_2": -2.0704166666666755, "agent_0": -1.467083333333339}, "module_episode_returns_mean": {"agent_1": -2.068750000000009, "agent_2": -2.0704166666666755, "agent_0": -1.467083333333339}, "episode_return_min": -15.67000000000008, "episode_len_mean": 500.0, "env_to_module_sum_episodes_length_out": 399.2474942227809, "num_episodes_lifetime": 24.0, "env_to_module_sum_episodes_length_in": 399.2474942227809, "episode_return_mean": -5.606250000000024, "rlmodule_inference_timer": 0.0003227736388997511, "sample": 3.348328702591981, "num_env_steps_sampled": 4000.0, "episode_duration_sec_mean": 1.603177377912895, "episode_len_max": 500, "num_episodes": 8.0, "time_between_sampling": 2.5112024155729156, "num_env_steps_sampled_lifetime_throughput": 703.1201223603749}, "learners": {"agent_5": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_1": {"curr_entropy_coeff": 0.0, "vf_loss": 0.0014678655425086617, "curr_kl_coeff": 0.20000000298023224, "vf_loss_unclipped": 0.0014678655425086617, "weights_seq_no": 3.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.9064005613327026, "num_module_steps_trained_lifetime": 120576, "num_trainable_parameters": 781541, "entropy": 6.131349563598633, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "total_loss": -0.10012710094451904, "mean_kl_loss": 0.012479985132813454, "policy_loss": -0.10409095883369446, "num_module_steps_trained_lifetime_throughput": 7432.407441391833}, "agent_13": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.020523479102173586, "numpy_to_tensor": 0.006429628109454643, "add_time_dim_to_batch_and_zero_pad": 5.948202149011195e-05, "add_columns_from_episodes_to_train_batch": 0.09424132439614623, "batch_individual_items": 0.20019582282060291, "agent_to_module_mapping": 0.0055958821598964285, "add_states_from_episodes_to_batch": 2.721308260806836e-05, "general_advantage_estimation": 0.05292119311969145, "add_observations_from_episodes_to_batch": 0.00021609982038498857}}, "connector_pipeline_timer": 0.3806679745660047}, "num_trainable_parameters": 16412361, "num_module_steps_trained": 120576, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 361728, "learner_connector_sum_episodes_length_in": 4000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 1884000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime_throughput": 116131.38083206979, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 22297.230331474664}, "agent_0": {"mean_kl_loss": 0.013657387346029282, "policy_loss": -0.06383849680423737, "curr_entropy_coeff": 0.0, "vf_loss": 0.0003804268199019134, "vf_loss_unclipped": 0.0003804268199019134, "weights_seq_no": 3.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.9609910249710083, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "entropy": 6.131834030151367, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 120576, "total_loss": -0.0607265941798687, "num_module_steps_trained_lifetime_throughput": 7432.403991637483}, "agent_10": {"num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05}, "agent_12": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_7": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_3": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_11": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_18": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_19": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_16": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_2": {"mean_kl_loss": 0.012534845620393753, "policy_loss": -0.1386227011680603, "curr_entropy_coeff": 0.0, "vf_loss": 0.00021173193817958236, "vf_loss_unclipped": 0.00021173193817958236, "weights_seq_no": 3.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.8970070481300354, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 120576, "total_loss": -0.13590401411056519, "entropy": 6.134437084197998, "num_module_steps_trained_lifetime_throughput": 7432.397996395892}, "agent_4": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_8": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_17": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_9": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_20": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_14": {"default_optimizer_learning_rate": 5e-05, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541}, "agent_15": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_6": {"curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541, "default_optimizer_learning_rate": 5e-05}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 12000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "824d3_00000", "date": "2025-10-21_10-18-46", "timestamp": 1761034726, "time_this_iter_s": 5.388740539550781, "time_total_s": 16.518301248550415, "pid": 3083715, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-extralarge-14agvs-7pickers-partialobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x77b765d6da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}], "agent_3": [null, null, null, {}], "agent_4": [null, null, null, {}], "agent_5": [null, null, null, {}], "agent_6": [null, null, null, {}], "agent_7": [null, null, null, {}], "agent_8": [null, null, null, {}], "agent_9": [null, null, null, {}], "agent_10": [null, null, null, {}], "agent_11": [null, null, null, {}], "agent_12": [null, null, null, {}], "agent_13": [null, null, null, {}], "agent_14": [null, null, null, {}], "agent_15": [null, null, null, {}], "agent_16": [null, null, null, {}], "agent_17": [null, null, null, {}], "agent_18": [null, null, null, {}], "agent_19": [null, null, null, {}], "agent_20": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.518301248550415, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 11.614285714285716, "ram_util_percent": 24.414285714285715, "gpu_util_percent0": 0.1442857142857143, "vram_util_percent0": 0.08107334775629842}}
{"timers": {"training_iteration": 5.8189923718541845, "restore_env_runners": 1.1999175546457992e-05, "training_step": 5.818753788851086, "env_runner_sampling_timer": 3.3862404251226734, "learner_update_timer": 2.400732221274729, "synch_weights": 0.0311646254990804, "synch_env_connectors": 0.005092800027097109}, "env_runners": {"timers": {"connectors": {"agent_to_module_mapping": 6.088521331548691e-06, "add_states_from_episodes_to_batch": 2.5373505195602775e-05, "add_observations_from_episodes_to_batch": 3.293647023383528e-05, "numpy_to_tensor": 7.462802750524133e-05, "add_time_dim_to_batch_and_zero_pad": 4.3970998376607895e-05, "batch_individual_items": 3.675400512292981e-05}}, "weights_seq_no": 3.0, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.6904138961996167e-06, "normalize_and_clip_actions": 3.133674142122326e-05, "un_batch_to_individual_items": 2.441809079990396e-05, "get_actions": 0.0002454889358155339, "remove_single_ts_time_rank_from_batch": 1.1539716651376292e-06, "listify_data_for_vector_env": 8.690743253749152e-06, "tensor_to_numpy": 5.6911361531908805e-05}}, "connector_pipeline_timer": 0.00042728745960529495}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "num_module_steps_sampled_lifetime": {"agent_2": 16000.0, "agent_0": 16000.0, "agent_1": 16000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.3544993572398194e-05, "numpy_to_tensor": 4.192533183540449e-05, "add_time_dim_to_batch_and_zero_pad": 3.239408722075171e-05, "batch_individual_items": 2.5417947159611427e-05, "agent_to_module_mapping": 4.7661433054082596e-06, "add_states_from_episodes_to_batch": 2.1840124578665337e-05}}, "connector_pipeline_timer": 0.00019253500182527843}, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "num_env_steps_sampled_lifetime": 16000.0, "num_agent_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "connector_pipeline_timer": 0.00041634375520516187, "num_agent_steps_sampled_lifetime": {"agent_1": 16000.0, "agent_2": 16000.0, "agent_0": 16000.0}, "env_step_timer": 0.00195399440707564, "episode_return_max": -1.5000000000000009, "env_reset_timer": 0.003566243511158973, "episode_len_min": 500, "agent_episode_returns_mean": {"agent_1": -2.049900000000009, "agent_2": -1.6898000000000066, "agent_0": -2.160000000000009}, "module_episode_returns_mean": {"agent_1": -2.049900000000009, "agent_2": -1.6898000000000066, "agent_0": -2.160000000000009}, "episode_return_min": -15.810000000000082, "episode_len_mean": 500.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 32.0, "env_to_module_sum_episodes_length_in": 399.2474942228111, "episode_return_mean": -5.899700000000025, "rlmodule_inference_timer": 0.00028339174877643113, "sample": 3.346590331666204, "num_env_steps_sampled": 4000.0, "episode_duration_sec_mean": 1.5954001472750678, "episode_len_max": 500, "num_episodes": 8.0, "time_between_sampling": 2.5073558844693835, "num_env_steps_sampled_lifetime_throughput": 705.6286084973583}, "learners": {"agent_5": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_1": {"curr_entropy_coeff": 0.0, "vf_loss": 0.002139247953891754, "curr_kl_coeff": 0.20000000298023224, "vf_loss_unclipped": 0.002139247953891754, "weights_seq_no": 4.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.9150385856628418, "num_module_steps_trained_lifetime": 160768, "num_trainable_parameters": 781541, "entropy": 6.1285223960876465, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "total_loss": -0.12013634294271469, "mean_kl_loss": 0.011446719989180565, "policy_loss": -0.12456493079662323, "num_module_steps_trained_lifetime_throughput": 7454.723620275576}, "agent_13": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.02042606460129266, "numpy_to_tensor": 0.006427559798116446, "add_time_dim_to_batch_and_zero_pad": 5.941083157202229e-05, "add_columns_from_episodes_to_train_batch": 0.0942077603624303, "batch_individual_items": 0.1989063938025378, "agent_to_module_mapping": 0.005591425317766786, "add_states_from_episodes_to_batch": 2.717194189940346e-05, "general_advantage_estimation": 0.05247914272819908, "add_observations_from_episodes_to_batch": 0.0002152996817866224}}, "connector_pipeline_timer": 0.3787954049403999}, "num_trainable_parameters": 16412361, "num_module_steps_trained": 120576, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 482304, "learner_connector_sum_episodes_length_in": 4000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 2512000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime_throughput": 116480.08235895426, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 22364.178287995164}, "agent_0": {"mean_kl_loss": 0.013085661455988884, "policy_loss": -0.10660073161125183, "curr_entropy_coeff": 0.0, "vf_loss": 0.0007447092793881893, "vf_loss_unclipped": 0.0007447092793881893, "weights_seq_no": 4.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.9231003522872925, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "entropy": 6.119667053222656, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 160768, "total_loss": -0.10323888808488846, "num_module_steps_trained_lifetime_throughput": 7454.720920635463}, "agent_10": {"num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05}, "agent_12": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_7": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_3": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_11": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_18": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_19": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_16": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_2": {"mean_kl_loss": 0.012705416418612003, "policy_loss": -0.13216380774974823, "curr_entropy_coeff": 0.0, "vf_loss": 0.00040979887126013637, "vf_loss_unclipped": 0.00040979887126013637, "weights_seq_no": 4.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.9299643039703369, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 160768, "total_loss": -0.12921293079853058, "entropy": 6.1236042976379395, "num_module_steps_trained_lifetime_throughput": 7454.71508569135}, "agent_4": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_8": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_17": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_9": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_20": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_14": {"default_optimizer_learning_rate": 5e-05, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541}, "agent_15": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_6": {"curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541, "default_optimizer_learning_rate": 5e-05}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 16000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "824d3_00000", "date": "2025-10-21_10-18-51", "timestamp": 1761034731, "time_this_iter_s": 5.082787990570068, "time_total_s": 21.601089239120483, "pid": 3083715, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-extralarge-14agvs-7pickers-partialobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x77b765db76d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}], "agent_3": [null, null, null, {}], "agent_4": [null, null, null, {}], "agent_5": [null, null, null, {}], "agent_6": [null, null, null, {}], "agent_7": [null, null, null, {}], "agent_8": [null, null, null, {}], "agent_9": [null, null, null, {}], "agent_10": [null, null, null, {}], "agent_11": [null, null, null, {}], "agent_12": [null, null, null, {}], "agent_13": [null, null, null, {}], "agent_14": [null, null, null, {}], "agent_15": [null, null, null, {}], "agent_16": [null, null, null, {}], "agent_17": [null, null, null, {}], "agent_18": [null, null, null, {}], "agent_19": [null, null, null, {}], "agent_20": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.601089239120483, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 10.128571428571428, "ram_util_percent": 24.385714285714283, "gpu_util_percent0": 0.17714285714285713, "vram_util_percent0": 0.08085002442598925}}
{"timers": {"training_iteration": 5.8141643617661485, "restore_env_runners": 1.1988683460627218e-05, "training_step": 5.813924947252517, "env_runner_sampling_timer": 3.3848578761418047, "learner_update_timer": 2.397298754451939, "synch_weights": 0.0311491158342761, "synch_env_connectors": 0.005058370486562023}, "env_runners": {"timers": {"connectors": {"agent_to_module_mapping": 6.088521331548691e-06, "add_states_from_episodes_to_batch": 2.5373505195602775e-05, "add_observations_from_episodes_to_batch": 3.293647023383528e-05, "numpy_to_tensor": 7.462802750524133e-05, "add_time_dim_to_batch_and_zero_pad": 4.3970998376607895e-05, "batch_individual_items": 3.675400512292981e-05}}, "weights_seq_no": 4.0, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.769113773192671e-06, "normalize_and_clip_actions": 3.1839871122609754e-05, "un_batch_to_individual_items": 2.4958045538909836e-05, "get_actions": 0.00024767766631911145, "remove_single_ts_time_rank_from_batch": 1.1962435899637623e-06, "listify_data_for_vector_env": 8.834920833657501e-06, "tensor_to_numpy": 5.764344317227811e-05}}, "connector_pipeline_timer": 0.0004318652123604645}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "num_module_steps_sampled_lifetime": {"agent_2": 20000.0, "agent_0": 20000.0, "agent_1": 20000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.4020209448578334e-05, "numpy_to_tensor": 4.236584972778417e-05, "add_time_dim_to_batch_and_zero_pad": 3.339548257627258e-05, "batch_individual_items": 2.5768743291196382e-05, "agent_to_module_mapping": 4.754126952964839e-06, "add_states_from_episodes_to_batch": 2.188171810122676e-05}}, "connector_pipeline_timer": 0.00019521072847819045}, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "num_env_steps_sampled_lifetime": 20000.0, "num_agent_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "connector_pipeline_timer": 0.00041634375520516187, "num_agent_steps_sampled_lifetime": {"agent_1": 20000.0, "agent_2": 20000.0, "agent_0": 20000.0}, "env_step_timer": 0.001973090239691822, "episode_return_max": -1.5000000000000009, "env_reset_timer": 0.003566243511158973, "episode_len_min": 500, "agent_episode_returns_mean": {"agent_1": -2.4184000000000108, "agent_2": -2.2233000000000103, "agent_0": -1.788400000000007}, "module_episode_returns_mean": {"agent_1": -2.4184000000000108, "agent_2": -2.2233000000000103, "agent_0": -1.788400000000007}, "episode_return_min": -15.810000000000082, "episode_len_mean": 500.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 40.0, "env_to_module_sum_episodes_length_in": 399.2474942228111, "episode_return_mean": -6.430100000000027, "rlmodule_inference_timer": 0.0002910948058372773, "sample": 3.3449547004897555, "num_env_steps_sampled": 4000.0, "episode_duration_sec_mean": 1.5933426372963004, "episode_len_max": 500, "num_episodes": 8.0, "time_between_sampling": 2.501532083527123, "num_env_steps_sampled_lifetime_throughput": 709.2927927518346}, "learners": {"agent_5": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_1": {"curr_entropy_coeff": 0.0, "vf_loss": 0.0015692224260419607, "curr_kl_coeff": 0.20000000298023224, "vf_loss_unclipped": 0.0015692224260419607, "weights_seq_no": 5.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.8979460597038269, "num_module_steps_trained_lifetime": 200960, "num_trainable_parameters": 781541, "entropy": 6.121391296386719, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "total_loss": -0.05841144174337387, "mean_kl_loss": 0.011825885623693466, "policy_loss": -0.062345825135707855, "num_module_steps_trained_lifetime_throughput": 7457.092716387982}, "agent_13": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.020336724535224466, "numpy_to_tensor": 0.006426460250451824, "add_time_dim_to_batch_and_zero_pad": 5.9352483447571286e-05, "add_columns_from_episodes_to_train_batch": 0.09417487348911417, "batch_individual_items": 0.1988560563549923, "agent_to_module_mapping": 0.005587341764838529, "add_states_from_episodes_to_batch": 2.7133162554465815e-05, "general_advantage_estimation": 0.05204262093054921, "add_observations_from_episodes_to_batch": 0.0002145558348138869}}, "connector_pipeline_timer": 0.3781778956613628}, "num_trainable_parameters": 16412361, "num_module_steps_trained": 120576, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 602880, "learner_connector_sum_episodes_length_in": 4000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 3140000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime_throughput": 116517.0851424904, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 22371.28461431753}, "agent_0": {"mean_kl_loss": 0.010577711276710033, "policy_loss": -0.023188136518001556, "curr_entropy_coeff": 0.0, "vf_loss": 0.0002733569126576185, "vf_loss_unclipped": 0.0002733569126576185, "weights_seq_no": 5.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.9449946284294128, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "entropy": 6.113911151885986, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 200960, "total_loss": -0.020799240097403526, "num_module_steps_trained_lifetime_throughput": 7457.089250484321}, "agent_10": {"num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05}, "agent_12": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_7": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_3": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_11": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_18": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_19": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_16": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_2": {"mean_kl_loss": 0.012590179219841957, "policy_loss": -0.026345258578658104, "curr_entropy_coeff": 0.0, "vf_loss": 0.0008766748942434788, "vf_loss_unclipped": 0.0008766748942434788, "weights_seq_no": 5.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.9384697079658508, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 200960, "total_loss": -0.022950556129217148, "entropy": 6.116990089416504, "num_module_steps_trained_lifetime_throughput": 7457.083441719533}, "agent_4": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_8": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_17": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_9": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_20": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_14": {"default_optimizer_learning_rate": 5e-05, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541}, "agent_15": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_6": {"curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541, "default_optimizer_learning_rate": 5e-05}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 20000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "824d3_00000", "date": "2025-10-21_10-18-56", "timestamp": 1761034736, "time_this_iter_s": 5.341220378875732, "time_total_s": 26.942309617996216, "pid": 3083715, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-extralarge-14agvs-7pickers-partialobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x77b765ddde10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}], "agent_3": [null, null, null, {}], "agent_4": [null, null, null, {}], "agent_5": [null, null, null, {}], "agent_6": [null, null, null, {}], "agent_7": [null, null, null, {}], "agent_8": [null, null, null, {}], "agent_9": [null, null, null, {}], "agent_10": [null, null, null, {}], "agent_11": [null, null, null, {}], "agent_12": [null, null, null, {}], "agent_13": [null, null, null, {}], "agent_14": [null, null, null, {}], "agent_15": [null, null, null, {}], "agent_16": [null, null, null, {}], "agent_17": [null, null, null, {}], "agent_18": [null, null, null, {}], "agent_19": [null, null, null, {}], "agent_20": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.942309617996216, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 9.762500000000001, "ram_util_percent": 24.275000000000002, "gpu_util_percent0": 0.1425, "vram_util_percent0": 0.08080117244748412}}
{"timers": {"training_iteration": 5.807864676228091, "restore_env_runners": 1.1998536845584191e-05, "training_step": 5.807624277140039, "env_runner_sampling_timer": 3.38406855813011, "learner_update_timer": 2.3917918455575093, "synch_weights": 0.031141655605625432, "synch_env_connectors": 0.005024535401660748}, "env_runners": {"timers": {"connectors": {"agent_to_module_mapping": 6.088521331548691e-06, "add_states_from_episodes_to_batch": 2.5373505195602775e-05, "add_observations_from_episodes_to_batch": 3.293647023383528e-05, "numpy_to_tensor": 7.462802750524133e-05, "add_time_dim_to_batch_and_zero_pad": 4.3970998376607895e-05, "batch_individual_items": 3.675400512292981e-05}}, "weights_seq_no": 5.0, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.724791634848984e-06, "normalize_and_clip_actions": 3.2064652592598894e-05, "un_batch_to_individual_items": 2.5276969509495858e-05, "get_actions": 0.0002513074508090335, "remove_single_ts_time_rank_from_batch": 1.1893140764540622e-06, "listify_data_for_vector_env": 8.814417324695057e-06, "tensor_to_numpy": 5.799439879546677e-05}}, "connector_pipeline_timer": 0.00043682071118777976}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "num_module_steps_sampled_lifetime": {"agent_2": 24000.0, "agent_0": 24000.0, "agent_1": 24000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.385905432416088e-05, "numpy_to_tensor": 4.2616402469622096e-05, "add_time_dim_to_batch_and_zero_pad": 3.339447803387006e-05, "batch_individual_items": 2.586254255761215e-05, "agent_to_module_mapping": 4.760250814180541e-06, "add_states_from_episodes_to_batch": 2.1976507306506862e-05}}, "connector_pipeline_timer": 0.00019587375247363543}, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "num_env_steps_sampled_lifetime": 24000.0, "num_agent_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "connector_pipeline_timer": 0.00041634375520516187, "num_agent_steps_sampled_lifetime": {"agent_1": 24000.0, "agent_2": 24000.0, "agent_0": 24000.0}, "env_step_timer": 0.001973962484139366, "episode_return_max": -1.5000000000000009, "env_reset_timer": 0.003566243511158973, "episode_len_min": 500, "agent_episode_returns_mean": {"agent_1": -2.27780000000001, "agent_2": -2.1947000000000094, "agent_0": -1.6374000000000064}, "module_episode_returns_mean": {"agent_1": -2.27780000000001, "agent_2": -2.1947000000000094, "agent_0": -1.6374000000000064}, "episode_return_min": -15.810000000000082, "episode_len_mean": 500.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 48.0, "env_to_module_sum_episodes_length_in": 399.2474942228111, "episode_return_mean": -6.109900000000025, "rlmodule_inference_timer": 0.0002926249915870105, "sample": 3.343968339572265, "num_env_steps_sampled": 4000.0, "episode_duration_sec_mean": 1.590706729668891, "episode_len_max": 500, "num_episodes": 8.0, "time_between_sampling": 2.4982680793768206, "num_env_steps_sampled_lifetime_throughput": 710.7583656951429}, "learners": {"agent_5": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_1": {"curr_entropy_coeff": 0.0, "vf_loss": 0.0030380007810890675, "curr_kl_coeff": 0.20000000298023224, "vf_loss_unclipped": 0.0030380007810890675, "weights_seq_no": 6.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.6774717569351196, "num_module_steps_trained_lifetime": 241152, "num_trainable_parameters": 781541, "entropy": 6.110817909240723, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "total_loss": -0.16662415862083435, "mean_kl_loss": 0.012729237787425518, "policy_loss": -0.1722080260515213, "num_module_steps_trained_lifetime_throughput": 7470.34175460396}, "agent_13": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.020240619750387125, "numpy_to_tensor": 0.00642013276780192, "add_time_dim_to_batch_and_zero_pad": 5.927873847313761e-05, "add_columns_from_episodes_to_train_batch": 0.09414485168428532, "batch_individual_items": 0.1976155831815355, "agent_to_module_mapping": 0.005583089337460893, "add_states_from_episodes_to_batch": 2.7082230744510344e-05, "general_advantage_estimation": 0.05161078690106179, "add_observations_from_episodes_to_batch": 0.00021375553641810692}}, "connector_pipeline_timer": 0.37636531492492575}, "num_trainable_parameters": 16412361, "num_module_steps_trained": 120576, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 723456, "learner_connector_sum_episodes_length_in": 4000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 3768000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime_throughput": 116724.13452552551, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 22411.030981092925}, "agent_0": {"mean_kl_loss": 0.012399010360240936, "policy_loss": -0.04955815151333809, "curr_entropy_coeff": 0.0, "vf_loss": 0.00046194702736102045, "vf_loss_unclipped": 0.00046194702736102045, "weights_seq_no": 6.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.9713656902313232, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "entropy": 6.105389595031738, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 241152, "total_loss": -0.04661640152335167, "num_module_steps_trained_lifetime_throughput": 7470.34086350742}, "agent_10": {"num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05}, "agent_12": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_7": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_3": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_11": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_18": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_19": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_16": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_2": {"mean_kl_loss": 0.012200891971588135, "policy_loss": -0.06459849327802658, "curr_entropy_coeff": 0.0, "vf_loss": 0.0008155612740665674, "vf_loss_unclipped": 0.0008155612740665674, "weights_seq_no": 6.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.8737778663635254, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 241152, "total_loss": -0.0613427609205246, "entropy": 6.108329772949219, "num_module_steps_trained_lifetime_throughput": 7470.335927370606}, "agent_4": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_8": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_17": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_9": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_20": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_14": {"default_optimizer_learning_rate": 5e-05, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541}, "agent_15": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_6": {"curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541, "default_optimizer_learning_rate": 5e-05}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 24000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "824d3_00000", "date": "2025-10-21_10-19-02", "timestamp": 1761034742, "time_this_iter_s": 5.189159154891968, "time_total_s": 32.131468772888184, "pid": 3083715, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-extralarge-14agvs-7pickers-partialobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x77b765db7be0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}], "agent_3": [null, null, null, {}], "agent_4": [null, null, null, {}], "agent_5": [null, null, null, {}], "agent_6": [null, null, null, {}], "agent_7": [null, null, null, {}], "agent_8": [null, null, null, {}], "agent_9": [null, null, null, {}], "agent_10": [null, null, null, {}], "agent_11": [null, null, null, {}], "agent_12": [null, null, null, {}], "agent_13": [null, null, null, {}], "agent_14": [null, null, null, {}], "agent_15": [null, null, null, {}], "agent_16": [null, null, null, {}], "agent_17": [null, null, null, {}], "agent_18": [null, null, null, {}], "agent_19": [null, null, null, {}], "agent_20": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.131468772888184, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 10.985714285714286, "ram_util_percent": 24.199999999999996, "gpu_util_percent0": 0.07857142857142858, "vram_util_percent0": 0.08074534161490683}}
{"timers": {"training_iteration": 5.803996956895768, "restore_env_runners": 1.198397137180873e-05, "training_step": 5.803755248368692, "env_runner_sampling_timer": 3.3845082925189733, "learner_update_timer": 2.3874916261315566, "synch_weights": 0.03112893071974668, "synch_env_connectors": 0.004990862108056868}, "env_runners": {"timers": {"connectors": {"agent_to_module_mapping": 6.088521331548691e-06, "add_states_from_episodes_to_batch": 2.5373505195602775e-05, "add_observations_from_episodes_to_batch": 3.293647023383528e-05, "numpy_to_tensor": 7.462802750524133e-05, "add_time_dim_to_batch_and_zero_pad": 4.3970998376607895e-05, "batch_individual_items": 3.675400512292981e-05}}, "weights_seq_no": 6.0, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 4.036803123359558e-06, "normalize_and_clip_actions": 3.474427033141683e-05, "un_batch_to_individual_items": 2.699608863353196e-05, "get_actions": 0.00026865380910858405, "remove_single_ts_time_rank_from_batch": 1.2795161475068535e-06, "listify_data_for_vector_env": 9.578688496698139e-06, "tensor_to_numpy": 6.253851901393557e-05}}, "connector_pipeline_timer": 0.00046898672822543775}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "num_module_steps_sampled_lifetime": {"agent_2": 28000.0, "agent_0": 28000.0, "agent_1": 28000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.5711639228463593e-05, "numpy_to_tensor": 4.5586648720578355e-05, "add_time_dim_to_batch_and_zero_pad": 3.5649360545048166e-05, "batch_individual_items": 2.7835645151171073e-05, "agent_to_module_mapping": 5.163995526546643e-06, "add_states_from_episodes_to_batch": 2.4023080762517256e-05}}, "connector_pipeline_timer": 0.0002109866181775234}, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "num_env_steps_sampled_lifetime": 28000.0, "num_agent_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "connector_pipeline_timer": 0.00041634375520516187, "num_agent_steps_sampled_lifetime": {"agent_1": 28000.0, "agent_2": 28000.0, "agent_0": 28000.0}, "env_step_timer": 0.002152305918228052, "episode_return_max": -1.5000000000000009, "env_reset_timer": 0.003566243511158973, "episode_len_min": 500, "agent_episode_returns_mean": {"agent_1": -2.23980000000001, "agent_2": -2.005100000000008, "agent_0": -1.8418000000000074}, "module_episode_returns_mean": {"agent_1": -2.23980000000001, "agent_2": -2.005100000000008, "agent_0": -1.8418000000000074}, "episode_return_min": -11.160000000000055, "episode_len_mean": 500.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 56.0, "env_to_module_sum_episodes_length_in": 399.2474942228111, "episode_return_mean": -6.086700000000025, "rlmodule_inference_timer": 0.0003031823445989295, "sample": 3.343937555071683, "num_env_steps_sampled": 4000.0, "episode_duration_sec_mean": 1.6141611138213192, "episode_len_max": 500, "num_episodes": 8.0, "time_between_sampling": 2.492814913613206, "num_env_steps_sampled_lifetime_throughput": 712.8003138853435}, "learners": {"agent_5": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_1": {"curr_entropy_coeff": 0.0, "vf_loss": 0.004648557398468256, "curr_kl_coeff": 0.20000000298023224, "vf_loss_unclipped": 0.004648557398468256, "weights_seq_no": 7.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.6030288934707642, "num_module_steps_trained_lifetime": 281344, "num_trainable_parameters": 781541, "entropy": 6.106066703796387, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "total_loss": -0.1402573138475418, "mean_kl_loss": 0.01309514231979847, "policy_loss": -0.147524893283844, "num_module_steps_trained_lifetime_throughput": 7466.427965174857}, "agent_13": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.020145961972860976, "numpy_to_tensor": 0.0064211256897427, "add_time_dim_to_batch_and_zero_pad": 5.921268094316134e-05, "add_columns_from_episodes_to_train_batch": 0.09411573011720745, "batch_individual_items": 0.19756909427994768, "agent_to_module_mapping": 0.0055785683941539455, "add_states_from_episodes_to_batch": 2.704444804622179e-05, "general_advantage_estimation": 0.05118147208175546, "add_observations_from_episodes_to_batch": 0.00021297144130155425}}, "connector_pipeline_timer": 0.3757586340860659}, "num_trainable_parameters": 16412361, "num_module_steps_trained": 120576, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 844032, "learner_connector_sum_episodes_length_in": 4000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 4396000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime_throughput": 116662.94202341668, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 22399.289734391412}, "agent_0": {"mean_kl_loss": 0.013283614069223404, "policy_loss": -0.08716731518507004, "curr_entropy_coeff": 0.0, "vf_loss": 0.0008164674509316683, "vf_loss_unclipped": 0.0008164674509316683, "weights_seq_no": 7.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.815972626209259, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "entropy": 6.101690769195557, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 281344, "total_loss": -0.08369413018226624, "num_module_steps_trained_lifetime_throughput": 7466.424752365613}, "agent_10": {"num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05}, "agent_12": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_7": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_3": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_11": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_18": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_19": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_16": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_2": {"mean_kl_loss": 0.011067604646086693, "policy_loss": -0.126776784658432, "curr_entropy_coeff": 0.0, "vf_loss": 0.0009103131014853716, "vf_loss_unclipped": 0.0009103131014853716, "weights_seq_no": 7.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.7439626455307007, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 281344, "total_loss": -0.12365293502807617, "entropy": 6.105579376220703, "num_module_steps_trained_lifetime_throughput": 7466.419993155808}, "agent_4": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_8": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_17": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_9": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_20": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_14": {"default_optimizer_learning_rate": 5e-05, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541}, "agent_15": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_6": {"curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541, "default_optimizer_learning_rate": 5e-05}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 28000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "824d3_00000", "date": "2025-10-21_10-19-07", "timestamp": 1761034747, "time_this_iter_s": 5.425882816314697, "time_total_s": 37.55735158920288, "pid": 3083715, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-extralarge-14agvs-7pickers-partialobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x77b765dddfc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}], "agent_3": [null, null, null, {}], "agent_4": [null, null, null, {}], "agent_5": [null, null, null, {}], "agent_6": [null, null, null, {}], "agent_7": [null, null, null, {}], "agent_8": [null, null, null, {}], "agent_9": [null, null, null, {}], "agent_10": [null, null, null, {}], "agent_11": [null, null, null, {}], "agent_12": [null, null, null, {}], "agent_13": [null, null, null, {}], "agent_14": [null, null, null, {}], "agent_15": [null, null, null, {}], "agent_16": [null, null, null, {}], "agent_17": [null, null, null, {}], "agent_18": [null, null, null, {}], "agent_19": [null, null, null, {}], "agent_20": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37.55735158920288, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 11.299999999999999, "ram_util_percent": 24.24285714285714, "gpu_util_percent0": 0.13142857142857142, "vram_util_percent0": 0.08082210900970062}}
{"timers": {"training_iteration": 5.800817729136636, "restore_env_runners": 1.1973641805103412e-05, "training_step": 5.800575128164973, "env_runner_sampling_timer": 3.3858833327134357, "learner_update_timer": 2.3829419406501824, "synch_weights": 0.03112109921214965, "synch_env_connectors": 0.004955529187019069}, "env_runners": {"timers": {"connectors": {"agent_to_module_mapping": 6.088521331548691e-06, "add_states_from_episodes_to_batch": 2.5373505195602775e-05, "add_observations_from_episodes_to_batch": 3.293647023383528e-05, "numpy_to_tensor": 7.462802750524133e-05, "add_time_dim_to_batch_and_zero_pad": 4.3970998376607895e-05, "batch_individual_items": 3.675400512292981e-05}}, "weights_seq_no": 7.0, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 3.9980022509042305e-06, "normalize_and_clip_actions": 3.445952447126647e-05, "un_batch_to_individual_items": 2.69717562245133e-05, "get_actions": 0.0002669232622977041, "remove_single_ts_time_rank_from_batch": 1.2961982861839602e-06, "listify_data_for_vector_env": 9.541420317895586e-06, "tensor_to_numpy": 6.233367368152398e-05}}, "connector_pipeline_timer": 0.00046633307922384784}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "num_module_steps_sampled_lifetime": {"agent_2": 32000.0, "agent_0": 32000.0, "agent_1": 32000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.5491134848274362e-05, "numpy_to_tensor": 4.5024828212634793e-05, "add_time_dim_to_batch_and_zero_pad": 3.505570306009927e-05, "batch_individual_items": 2.7546811958196157e-05, "agent_to_module_mapping": 5.1644535003628526e-06, "add_states_from_episodes_to_batch": 2.3967480360653133e-05}}, "connector_pipeline_timer": 0.00020890563713638597}, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "num_env_steps_sampled_lifetime": 32000.0, "num_agent_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "connector_pipeline_timer": 0.00041634375520516187, "num_agent_steps_sampled_lifetime": {"agent_1": 32000.0, "agent_2": 32000.0, "agent_0": 32000.0}, "env_step_timer": 0.002149538108787698, "episode_return_max": -1.5000000000000009, "env_reset_timer": 0.003566243511158973, "episode_len_min": 500, "agent_episode_returns_mean": {"agent_1": -2.2362000000000095, "agent_2": -1.7559000000000071, "agent_0": -2.5332000000000114}, "module_episode_returns_mean": {"agent_1": -2.2362000000000095, "agent_2": -1.7559000000000071, "agent_0": -2.5332000000000114}, "episode_return_min": -11.170000000000055, "episode_len_mean": 500.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 64.0, "env_to_module_sum_episodes_length_in": 399.2474942228111, "episode_return_mean": -6.525300000000028, "rlmodule_inference_timer": 0.0002992054259773637, "sample": 3.3449755058484354, "num_env_steps_sampled": 4000.0, "episode_duration_sec_mean": 1.6571306415233993, "episode_len_max": 500, "num_episodes": 8.0, "time_between_sampling": 2.488850463469492, "num_env_steps_sampled_lifetime_throughput": 713.321977238102}, "learners": {"agent_5": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_1": {"curr_entropy_coeff": 0.0, "vf_loss": 0.0015417770482599735, "curr_kl_coeff": 0.20000000298023224, "vf_loss_unclipped": 0.0015417770482599735, "weights_seq_no": 8.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.920311689376831, "num_module_steps_trained_lifetime": 321536, "num_trainable_parameters": 781541, "entropy": 6.093680381774902, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "total_loss": 0.02643774263560772, "mean_kl_loss": 0.013029848225414753, "policy_loss": 0.02228999324142933, "num_module_steps_trained_lifetime_throughput": 7458.35990995749}, "agent_13": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.020054623493156058, "numpy_to_tensor": 0.006426144322622763, "add_time_dim_to_batch_and_zero_pad": 5.918840420846054e-05, "add_columns_from_episodes_to_train_batch": 0.0941053469860094, "batch_individual_items": 0.19635236361736635, "agent_to_module_mapping": 0.005584882640577045, "add_states_from_episodes_to_batch": 2.9251323360466572e-05, "general_advantage_estimation": 0.05075701965129794, "add_observations_from_episodes_to_batch": 0.00021231282714717964}}, "connector_pipeline_timer": 0.3740263406457126}, "num_trainable_parameters": 16412361, "num_module_steps_trained": 120576, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 964608, "learner_connector_sum_episodes_length_in": 4000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 5024000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime_throughput": 116536.80241666973, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 22375.088872420987}, "agent_0": {"mean_kl_loss": 0.013189590536057949, "policy_loss": -0.108909010887146, "curr_entropy_coeff": 0.0, "vf_loss": 0.0008194337133318186, "vf_loss_unclipped": 0.0008194337133318186, "weights_seq_no": 8.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.8854121565818787, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "entropy": 6.103519916534424, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 321536, "total_loss": -0.10545166581869125, "num_module_steps_trained_lifetime_throughput": 7458.35140602171}, "agent_10": {"num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05}, "agent_12": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_7": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_3": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_11": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_18": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_19": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_16": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_2": {"mean_kl_loss": 0.01358528807759285, "policy_loss": 0.013668591156601906, "curr_entropy_coeff": 0.0, "vf_loss": 0.0006866545299999416, "vf_loss_unclipped": 0.0006866545299999416, "weights_seq_no": 8.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.9469223618507385, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 321536, "total_loss": 0.017072314396500587, "entropy": 6.100154399871826, "num_module_steps_trained_lifetime_throughput": 7458.345122741701}, "agent_4": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_8": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_17": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_9": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_20": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_14": {"default_optimizer_learning_rate": 5e-05, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541}, "agent_15": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_6": {"curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541, "default_optimizer_learning_rate": 5e-05}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 32000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "824d3_00000", "date": "2025-10-21_10-19-13", "timestamp": 1761034753, "time_this_iter_s": 5.4910759925842285, "time_total_s": 43.04842758178711, "pid": 3083715, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-extralarge-14agvs-7pickers-partialobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x77b765dddf30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}], "agent_3": [null, null, null, {}], "agent_4": [null, null, null, {}], "agent_5": [null, null, null, {}], "agent_6": [null, null, null, {}], "agent_7": [null, null, null, {}], "agent_8": [null, null, null, {}], "agent_9": [null, null, null, {}], "agent_10": [null, null, null, {}], "agent_11": [null, null, null, {}], "agent_12": [null, null, null, {}], "agent_13": [null, null, null, {}], "agent_14": [null, null, null, {}], "agent_15": [null, null, null, {}], "agent_16": [null, null, null, {}], "agent_17": [null, null, null, {}], "agent_18": [null, null, null, {}], "agent_19": [null, null, null, {}], "agent_20": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 43.04842758178711, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 10.875, "ram_util_percent": 24.2, "gpu_util_percent0": 0.13, "vram_util_percent0": 0.08132022471910112}}
{"timers": {"training_iteration": 5.801163098785758, "restore_env_runners": 1.2017935739659747e-05, "training_step": 5.800920222823036, "env_runner_sampling_timer": 3.3890587160060965, "learner_update_timer": 2.3801044968936393, "synch_weights": 0.03112913654033015, "synch_env_connectors": 0.004921263005164024}, "env_runners": {"timers": {"connectors": {"agent_to_module_mapping": 6.088521331548691e-06, "add_states_from_episodes_to_batch": 2.5373505195602775e-05, "add_observations_from_episodes_to_batch": 3.293647023383528e-05, "numpy_to_tensor": 7.462802750524133e-05, "add_time_dim_to_batch_and_zero_pad": 4.3970998376607895e-05, "batch_individual_items": 3.675400512292981e-05}}, "weights_seq_no": 8.0, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 4.046490801022347e-06, "normalize_and_clip_actions": 3.533413709022623e-05, "un_batch_to_individual_items": 2.7317512992554224e-05, "get_actions": 0.000278569005435659, "remove_single_ts_time_rank_from_batch": 1.313766106399802e-06, "listify_data_for_vector_env": 9.821816505087156e-06, "tensor_to_numpy": 6.474576941575813e-05}}, "connector_pipeline_timer": 0.00048386886981423847}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "num_module_steps_sampled_lifetime": {"agent_2": 36000.0, "agent_0": 36000.0, "agent_1": 36000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.6501437693877364e-05, "numpy_to_tensor": 4.7031111130470234e-05, "add_time_dim_to_batch_and_zero_pad": 3.727236828100956e-05, "batch_individual_items": 2.8631636586711232e-05, "agent_to_module_mapping": 5.314515152691615e-06, "add_states_from_episodes_to_batch": 2.45243055726027e-05}}, "connector_pipeline_timer": 0.00021740150451943807}, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "num_env_steps_sampled_lifetime": 36000.0, "num_agent_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "connector_pipeline_timer": 0.00041634375520516187, "num_agent_steps_sampled_lifetime": {"agent_1": 36000.0, "agent_2": 36000.0, "agent_0": 36000.0}, "env_step_timer": 0.002203494247466214, "episode_return_max": -1.5000000000000009, "env_reset_timer": 0.003566243511158973, "episode_len_min": 500, "agent_episode_returns_mean": {"agent_1": -2.1465000000000094, "agent_2": -1.6875000000000064, "agent_0": -2.7376000000000125}, "module_episode_returns_mean": {"agent_1": -2.1465000000000094, "agent_2": -1.6875000000000064, "agent_0": -2.7376000000000125}, "episode_return_min": -11.170000000000055, "episode_len_mean": 500.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 72.0, "env_to_module_sum_episodes_length_in": 399.2474942228111, "episode_return_mean": -6.5716000000000285, "rlmodule_inference_timer": 0.0003237502787124169, "sample": 3.347866103765191, "num_env_steps_sampled": 4000.0, "episode_duration_sec_mean": 1.6969670404610224, "episode_len_max": 500, "num_episodes": 8.0, "time_between_sampling": 2.48450634902746, "num_env_steps_sampled_lifetime_throughput": 712.857481418886}, "learners": {"agent_5": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_1": {"curr_entropy_coeff": 0.0, "vf_loss": 0.002179077360779047, "curr_kl_coeff": 0.20000000298023224, "vf_loss_unclipped": 0.002179077360779047, "weights_seq_no": 9.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.7541437149047852, "num_module_steps_trained_lifetime": 361728, "num_trainable_parameters": 781541, "entropy": 6.09596061706543, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "total_loss": -0.11433704197406769, "mean_kl_loss": 0.011990594677627087, "policy_loss": -0.11891423910856247, "num_module_steps_trained_lifetime_throughput": 7428.940855199358}, "agent_13": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.019988010617981566, "numpy_to_tensor": 0.0064264596295520735, "add_time_dim_to_batch_and_zero_pad": 5.915398017363369e-05, "add_columns_from_episodes_to_train_batch": 0.09409714787658448, "batch_individual_items": 0.19636018157100768, "agent_to_module_mapping": 0.0055816217041210646, "add_states_from_episodes_to_batch": 2.9198739776840783e-05, "general_advantage_estimation": 0.05033726622474064, "add_observations_from_episodes_to_batch": 0.00021167786853091167}}, "connector_pipeline_timer": 0.37353362177888216}, "num_trainable_parameters": 16412361, "num_module_steps_trained": 120576, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 1085184, "learner_connector_sum_episodes_length_in": 4000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 5652000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime_throughput": 116077.19140903183, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 22286.82985157506}, "agent_0": {"mean_kl_loss": 0.012138145975768566, "policy_loss": -0.1872483193874359, "curr_entropy_coeff": 0.0, "vf_loss": 0.0018358652014285326, "vf_loss_unclipped": 0.0018358652014285326, "weights_seq_no": 9.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.7526432275772095, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "entropy": 6.093134880065918, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 361728, "total_loss": -0.1829848289489746, "num_module_steps_trained_lifetime_throughput": 7428.93685472154}, "agent_10": {"num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05}, "agent_12": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_7": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_3": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_11": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_18": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_19": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_16": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_2": {"mean_kl_loss": 0.012250522151589394, "policy_loss": -0.08941268920898438, "curr_entropy_coeff": 0.0, "vf_loss": 0.0009232198935933411, "vf_loss_unclipped": 0.0009232198935933411, "weights_seq_no": 9.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.8842796683311462, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 361728, "total_loss": -0.08603936433792114, "entropy": 6.090671539306641, "num_module_steps_trained_lifetime_throughput": 7428.932087570877}, "agent_4": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_8": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_17": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_9": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_20": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_14": {"default_optimizer_learning_rate": 5e-05, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541}, "agent_15": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_6": {"curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541, "default_optimizer_learning_rate": 5e-05}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 36000.0, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "824d3_00000", "date": "2025-10-21_10-19-18", "timestamp": 1761034758, "time_this_iter_s": 5.840242862701416, "time_total_s": 48.888670444488525, "pid": 3083715, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-extralarge-14agvs-7pickers-partialobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x77b765efa8c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}], "agent_3": [null, null, null, {}], "agent_4": [null, null, null, {}], "agent_5": [null, null, null, {}], "agent_6": [null, null, null, {}], "agent_7": [null, null, null, {}], "agent_8": [null, null, null, {}], "agent_9": [null, null, null, {}], "agent_10": [null, null, null, {}], "agent_11": [null, null, null, {}], "agent_12": [null, null, null, {}], "agent_13": [null, null, null, {}], "agent_14": [null, null, null, {}], "agent_15": [null, null, null, {}], "agent_16": [null, null, null, {}], "agent_17": [null, null, null, {}], "agent_18": [null, null, null, {}], "agent_19": [null, null, null, {}], "agent_20": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.888670444488525, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 12.1625, "ram_util_percent": 24.65, "gpu_util_percent0": 0.10375000000000001, "vram_util_percent0": 0.08153395212506107}}
{"timers": {"training_iteration": 5.798114790888242, "restore_env_runners": 1.2002716436422315e-05, "training_step": 5.797871448874979, "env_runner_sampling_timer": 3.3900293403660733, "learner_update_timer": 2.3760930141942826, "synch_weights": 0.031119913314935334, "synch_env_connectors": 0.004889240005419641}, "env_runners": {"timers": {"connectors": {"agent_to_module_mapping": 6.088521331548691e-06, "add_states_from_episodes_to_batch": 2.5373505195602775e-05, "add_observations_from_episodes_to_batch": 3.293647023383528e-05, "numpy_to_tensor": 7.462802750524133e-05, "add_time_dim_to_batch_and_zero_pad": 4.3970998376607895e-05, "batch_individual_items": 3.675400512292981e-05}}, "weights_seq_no": 9.0, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 4.040808016916185e-06, "normalize_and_clip_actions": 3.5153100655830046e-05, "un_batch_to_individual_items": 2.7046302759422928e-05, "get_actions": 0.00027590089364780114, "remove_single_ts_time_rank_from_batch": 1.2942120982883714e-06, "listify_data_for_vector_env": 9.587067304843329e-06, "tensor_to_numpy": 6.36496784663902e-05}}, "connector_pipeline_timer": 0.0004784133132148238}, "num_module_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "num_module_steps_sampled_lifetime": {"agent_2": 40000.0, "agent_0": 40000.0, "agent_1": 40000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.5972864955981488e-05, "numpy_to_tensor": 4.651042697361975e-05, "add_time_dim_to_batch_and_zero_pad": 3.61851303076962e-05, "batch_individual_items": 2.8179577834195283e-05, "agent_to_module_mapping": 5.2497263829148e-06, "add_states_from_episodes_to_batch": 2.443788201277969e-05}}, "connector_pipeline_timer": 0.00021366471492243643}, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "num_env_steps_sampled_lifetime": 40000.0, "num_agent_steps_sampled": {"agent_1": 4000.0, "agent_2": 4000.0, "agent_0": 4000.0}, "connector_pipeline_timer": 0.00041634375520516187, "num_agent_steps_sampled_lifetime": {"agent_1": 40000.0, "agent_2": 40000.0, "agent_0": 40000.0}, "env_step_timer": 0.0021794013807210355, "episode_return_max": -1.5000000000000009, "env_reset_timer": 0.003566243511158973, "episode_len_min": 500, "agent_episode_returns_mean": {"agent_1": -1.8331000000000077, "agent_2": -1.4975000000000056, "agent_0": -2.3175000000000106}, "module_episode_returns_mean": {"agent_1": -1.8331000000000077, "agent_2": -1.4975000000000056, "agent_0": -2.3175000000000106}, "episode_return_min": -11.170000000000055, "episode_len_mean": 500.0, "env_to_module_sum_episodes_length_out": 399.2474942228111, "num_episodes_lifetime": 80.0, "env_to_module_sum_episodes_length_in": 399.2474942228111, "episode_return_mean": -5.648100000000023, "rlmodule_inference_timer": 0.0003140796267646867, "sample": 3.3487423098977254, "num_env_steps_sampled": 4000.0, "episode_duration_sec_mean": 1.7148959435685538, "episode_len_max": 500, "num_episodes": 8.0, "time_between_sampling": 2.4818338551097616, "num_env_steps_sampled_lifetime_throughput": 712.6981997809538}, "learners": {"agent_5": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_1": {"curr_entropy_coeff": 0.0, "vf_loss": 0.003166346810758114, "curr_kl_coeff": 0.20000000298023224, "vf_loss_unclipped": 0.003166346810758114, "weights_seq_no": 10.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.6889517903327942, "num_module_steps_trained_lifetime": 401920, "num_trainable_parameters": 781541, "entropy": 6.092718124389648, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "total_loss": -0.09737037867307663, "mean_kl_loss": 0.011432010680437088, "policy_loss": -0.10282313078641891, "num_module_steps_trained_lifetime_throughput": 7421.963712285158}, "agent_13": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.019901601122032913, "numpy_to_tensor": 0.006420958643106401, "add_time_dim_to_batch_and_zero_pad": 5.9161550288845136e-05, "add_columns_from_episodes_to_train_batch": 0.09407755209750918, "batch_individual_items": 0.19514300004538587, "agent_to_module_mapping": 0.0055789732970449426, "add_states_from_episodes_to_batch": 2.914477223569668e-05, "general_advantage_estimation": 0.04992138726246855, "add_observations_from_episodes_to_batch": 0.00021108857993990665}}, "connector_pipeline_timer": 0.3717834970807342}, "num_trainable_parameters": 16412361, "num_module_steps_trained": 120576, "num_env_steps_trained": 628000, "num_module_steps_trained_lifetime": 1205760, "learner_connector_sum_episodes_length_in": 4000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 6280000, "learner_connector_sum_episodes_length_out": 4000.0, "num_env_steps_trained_lifetime_throughput": 115968.17309103988, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 22265.897419403344}, "agent_0": {"mean_kl_loss": 0.012431325390934944, "policy_loss": -0.008124638348817825, "curr_entropy_coeff": 0.0, "vf_loss": 0.0017100214026868343, "vf_loss_unclipped": 0.0017100214026868343, "weights_seq_no": 10.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.8731986880302429, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "entropy": 6.094822883605957, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 401920, "total_loss": -0.003928349353373051, "num_module_steps_trained_lifetime_throughput": 7421.960006952486}, "agent_10": {"num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05}, "agent_12": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_7": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_3": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_11": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_18": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_19": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_16": {"default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541, "curr_entropy_coeff": 0.0}, "agent_2": {"mean_kl_loss": 0.009444629773497581, "policy_loss": -0.1597164124250412, "curr_entropy_coeff": 0.0, "vf_loss": 0.0010120247025042772, "vf_loss_unclipped": 0.0010120247025042772, "weights_seq_no": 10.0, "default_optimizer_learning_rate": 5e-05, "vf_explained_var": 0.5440817475318909, "curr_kl_coeff": 0.20000000298023224, "num_trainable_parameters": 781541, "num_module_steps_trained": 40192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 256.0, "num_module_steps_trained_lifetime": 401920, "total_loss": -0.15681545436382294, "entropy": 6.085855484008789, "num_module_steps_trained_lifetime_throughput": 7421.955166093181}, "agent_4": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_8": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_17": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_9": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_20": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_14": {"default_optimizer_learning_rate": 5e-05, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541}, "agent_15": {"curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 5e-05, "num_trainable_parameters": 781541}, "agent_6": {"curr_entropy_coeff": 0.0, "num_trainable_parameters": 781541, "default_optimizer_learning_rate": 5e-05}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 40000.0, "evaluation": {"env_runners": {"episode_len_min": 500, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 2.3313659427616297e-05, "tensor_to_numpy": 5.456493003659806e-05, "listify_data_for_vector_env": 8.688859908950761e-06, "module_to_agent_unmapping": 3.439959640851512e-06, "get_actions": 0.00010473816643091405, "remove_single_ts_time_rank_from_batch": 1.0844960802104275e-06, "normalize_and_clip_actions": 3.0507234452813274e-05}}, "connector_pipeline_timer": 0.00027804792374167594}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.3016295839094986e-05, "add_observations_from_episodes_to_batch": 2.169889779634066e-05, "numpy_to_tensor": 3.673570938121606e-05, "add_time_dim_to_batch_and_zero_pad": 2.656887297294577e-05, "agent_to_module_mapping": 4.369358091227902e-06, "add_states_from_episodes_to_batch": 2.1866642381366e-05}}, "connector_pipeline_timer": 0.00017551705068360492}, "env_to_module_sum_episodes_length_in": 404.24749421816176, "agent_steps": {"agent_1": 500.0, "agent_2": 500.0, "agent_0": 500.0}, "episode_len_max": 500, "num_agent_steps_sampled": {"agent_2": 2500, "agent_1": 2500, "agent_0": 2500}, "num_module_steps_sampled_lifetime": {"agent_0": 2500, "agent_1": 2500, "agent_2": 2500}, "module_episode_returns_mean": {"agent_1": -0.5000000000000003, "agent_2": -1.4060000000000048, "agent_0": -0.5000000000000003}, "timers": {"connectors": {"numpy_to_tensor": 5.877699004486203e-05, "add_time_dim_to_batch_and_zero_pad": 3.712897887453437e-05, "agent_to_module_mapping": 5.097012035548687e-06, "add_states_from_episodes_to_batch": 5.913199856877327e-05, "batch_individual_items": 3.0929979402571917e-05, "add_observations_from_episodes_to_batch": 3.0965020414441824e-05}}, "num_module_steps_sampled": {"agent_0": 2500, "agent_2": 2500, "agent_1": 2500}, "env_to_module_sum_episodes_length_out": 404.24749421816176, "agent_episode_returns_mean": {"agent_0": -0.5000000000000003, "agent_2": -1.4060000000000048, "agent_1": -0.5000000000000003}, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime": 2500, "env_step_timer": 0.001976514780549902, "episode_return_max": -1.5000000000000009, "num_agent_steps_sampled_lifetime": {"agent_0": 2500, "agent_1": 2500, "agent_2": 2500}, "episode_len_mean": 500.0, "num_episodes_lifetime": 5, "episode_duration_sec_mean": 1.460897715797182, "env_reset_timer": 0.003810719004832208, "episode_return_min": -6.030000000000025, "episode_return_mean": -2.406000000000005, "rlmodule_inference_timer": 0.0002179807258869332, "num_env_steps_sampled": 2500, "sample": 7.363240737002343, "num_episodes": 5, "connector_pipeline_timer": 0.0003076510038226843}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 10, "trial_id": "824d3_00000", "date": "2025-10-21_10-19-31", "timestamp": 1761034771, "time_this_iter_s": 12.899278402328491, "time_total_s": 61.78794884681702, "pid": 3083715, "hostname": "xuezhi-Precision-3660", "node_ip": "130.238.16.41", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'train_utils.WarehouseMultiAgentEnv'>", "env_config": {"env_id": "tarware-extralarge-14agvs-7pickers-partialobs-chg-v1"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 256, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function train.<locals>.<lambda> at 0x77b765c3ed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, {}], "agent_1": [null, null, null, {}], "agent_2": [null, null, null, {}], "agent_3": [null, null, null, {}], "agent_4": [null, null, null, {}], "agent_5": [null, null, null, {}], "agent_6": [null, null, null, {}], "agent_7": [null, null, null, {}], "agent_8": [null, null, null, {}], "agent_9": [null, null, null, {}], "agent_10": [null, null, null, {}], "agent_11": [null, null, null, {}], "agent_12": [null, null, null, {}], "agent_13": [null, null, null, {}], "agent_14": [null, null, null, {}], "agent_15": [null, null, null, {}], "agent_16": [null, null, null, {}], "agent_17": [null, null, null, {}], "agent_18": [null, null, null, {}], "agent_19": [null, null, null, {}], "agent_20": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 61.78794884681702, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 7.700000000000001, "ram_util_percent": 24.73333333333333, "gpu_util_percent0": 0.10222222222222223, "vram_util_percent0": 0.08168322205938229}}
